{"version":3,"sources":["webaudio-starter.js","node_modules/browser-pack/_prelude.js","node_modules/crnx-base/code-output-i18n.js","node_modules/crnx-base/code-output.js","node_modules/crnx-base/code-section.js","node_modules/crnx-base/fake-lodash/camelcase.js","node_modules/crnx-base/fake-lodash/capitalize.js","node_modules/crnx-base/fake-lodash/debounce.js","node_modules/crnx-base/fake-lodash/escape.js","node_modules/crnx-base/fake-lodash/repeat.js","node_modules/crnx-base/format-numbers.js","node_modules/crnx-base/i18n-expand-curly.js","node_modules/crnx-base/i18n.js","node_modules/crnx-base/interleave-lines.js","node_modules/crnx-base/js-lines.js","node_modules/crnx-base/lines.js","node_modules/crnx-base/nose-wrap-lines.js","node_modules/crnx-base/option-classes.js","node_modules/crnx-base/options-output-i18n.js","node_modules/crnx-base/options-output.js","node_modules/crnx-base/options.js","node_modules/crnx-base/ref-lines.js","node_modules/crnx-base/web-code.js","node_modules/crnx-base/wrap-lines.js","src/audio-context.js","src/canvas.js","src/code-output.js","src/code.js","src/collection-feature.js","src/destination.js","src/feature.js","src/filter-sequence.js","src/i18n.js","src/main.js","src/option-classes.js","src/options-output.js","src/options.js","src/source-set.js"],"names":["babelHelpers","typeof","obj","Symbol","constructor","createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","classCallCheck","instance","TypeError","possibleConstructorReturn","self","call","ReferenceError","inherits","subClass","superClass","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","undefined","create","taggedTemplateLiteralLoose","strings","raw","e","t","n","r","s","o","u","a","require","f","Error","code","l","exports",1,"module","lang","additionalStringsPrefix","additionalStrings","en","save","run","open.codepen","open.jsfiddle","section.html","section.css","section.js","embedded","mode.full","mode.body","mode.embed","mode.paste","mode.file","formatting","formatting.indent","formatting.indentNumber","formatting.jsSemicolons","warning.no-hljs","ru","id",2,"debounce","repeat","getHtmlDataUri","html","encodeURIComponent","CodeOutput","generateCode","i18n","_this","this","$sectionCode","$sectionModeInput","$indentCheckbox","$indentNumber","$jsSemicolonsCheckbox","getCode","getFormatting","indent","prop","checkValidity","Number","val","refs","jsSemicolons","getSectionModes","css","js","extractCode","sectionModes","sections","extractSections","sectionName","empty","append","$code","$","getHtml","join","window","hljs","highlightBlock","writeFormattingControls","change","on","writeSection","extractable","$summary","$saveButton","map","mode","click","section","blob","Blob","get","type","mimeType","navigator","msSaveOrOpenBlob","filename","$a","attr","URL","createObjectURL","appendTo","remove","$output","writeButtons","delay","update","w","open","document","write","close","getSection","JSON","stringify","title","submit","6","8",3,"CodeSection","lines",4,"capitalize","split","5","charAt","toUpperCase","slice","func","wait","timeoutId","clearTimeout","setTimeout",7,"entityMap","&","<",">","\"","'","String","replace","m","Array",9,"formatNumbersInternal","numbers","precision","keepDot","noPlus","maxPrecision","hasNegative","p","number","toFixed","match","ss","formatNumbers","glsl",10,"inStrings","expandIdAndString","string","expandRegexp","exec","idStart","idMids","idEnd","stringStart","stringMidsStr","stringMids","stringEnd","forEach","idMid","stringMid",11,"escape","langStrings","defaultLang","has","pluralSuffix","ns","indexOf","nn","Math","abs","teen","plural","numberWithUnits","unit","abbrFn","abbr","expansion","test",12,"Lines","InterleaveLines","_Lines","apply","arguments","doGet","out","first","fp","push","data","item","subOut","14",13,"JsLines","processStringInGet","TO","isArray","isDataEmpty","isEmpty","addTo","pop","shift","b","_this2","_arguments","makeLines","Function","bind","concat","ae","ba","_b","be","bae","_b2","count","_arguments2","reduce","v",15,"WrapLines","NoseWrapLines","_WrapLines","22",16,"Option","Base","_class","name","settings","fullName","optionByFullName","updateCallback","makeEntry","isInsideArray","_$","isVisible","fullNamesAffectingVisibility","visibilityData","testName","make","nScalars","nArrays","nObjects","scalarArg","arrayArg","objectArg","arg","optionClass","collectArgs","updateVisibility","toggle","shortenExport","dataKeys","shortenExportAssign","parentData","set","Input","_Option$Base","_class2","defaultValue","_value","Boolean","_Option$Input","_class3","fix","NonBoolean","_Option$Input2","_class4","valueOf","toString","Factor","_Option$NonBoolean","_class5","_this4","availableValues","_Option$NonBoolean2","_class6","_this5","availableMin","availableMax","fixed","Collection","_Option$Base2","_class7","_this6","entries","descriptions","x","subName","subData","entry","fixedEntries","Void","_Option$Base3","_class8","Checkbox","_Option$Boolean","_class9","Select","_Option$Factor","_class10","Text","_Option$Factor2","_class11","Int","_Option$Number","_class12","Float","_Option$Number2","_class13","_this12","Root","_Option$Collection","_class14","Group","_Option$Collection2","_class15","_Option$Base4","_class16","_this15","availableConstructors","Map","ctor","typePropertyName","_entries","subDatas","defaultType","availableTypes","subType","subCtor","addEntry","_this16","_this17","subFixed","types","_",17,"reset","drag","delete",18,"OptionsOutput","options","generateId","option","optionProto","getPrototypeOf","optionClassWriter","optionClassWriters","setOptionClassWriters","root","writeOption","valueId","valueInfoId","$select","availableValue","some","$tip","$tipContent","handler","show","hide","listId","text","setInputAttrs","$input","pow","setInputAttrsAndListeners","getOtherInput","$that","parseFloat","$sliderInput","$numberInput","fmt","min","max","$dragged","$entries","updateArrayEntries","children","writeDraggableOption","moveUp","$moved","prev","before","moveDown","next","after","ev","parent","originalEvent","dataTransfer","effectAllowed","setData","setDragImage","addClass","keydown","$handle","$sorted","keyCode","focus","preventDefault","dropEffect","$target","is","dh","height","y","pageY","offset","top","nextAll","th","prevAll","removeClass","$buttons",19,"Options","simpleUpdateCallback","optionClasses","optionsWithVisibilityAffectedByFullName","description","parentfullName","_Option$className","className","makeArgs","entriesDescription",20,"RefLines","ref","parse","re","substr","plainOut","href",21,"_templateObject","_templateObject2","_templateObject3","WebCode","getLines","stylePlaceLines","cachedStyleLines","styleExtractLines","getSectionPasteComment","basename","scriptPlaceLines","cachedScriptLines","scriptExtractLines","htmlExtractLines","getBodyHtmlSectionLines","getFullHtmlSectionLines","cachedHeadLines","cachedBodyLines","_styleLines","styleLines","_headLines","headLines","_bodyLines","bodyLines","_scriptLines","scriptLines","wrappers","pushWrapper",23,"Feature","AudioContext","_Feature","getJsInitLines","featureContext","prevNodeJsNames","audioContext","29",24,"Canvas","getHtmlLines","canvas","width","getJsLoopPreLines","writeStyle","canvasContextProperty","colorOption","cs","color","c","isBlack","every","background","line",25,"BaseCodeOutput","_BaseCodeOutput","context","source","gain","panner","biquad","convolver","peaking","destination","compressor","analyser",26,"SourceSet","FilterSequence","Destination","BaseWebCode","Code","_BaseWebCode","features","sources","filters","feature","requestFeatureContext","alignedInputs","_NoseWrapLines$b","_this3","getNodeJsNames","getJsLoopVisLines","28","30","36",27,"CollectionFeature","entryOptions","entryCounts","entryOption","entryClass","getEntryClass","entryCounts2","audioProcessing","waveform","nextNodeJsName","prevNodeJsName","_templateObject4","_templateObject5","_templateObject6","camelCase","Filter","getPropertyOptionName","property","getPropertyInputHtmlName","propertyName","nSuffix","getPropertyInputJsName","hasRangeInputs","nodeProperties","input","getHtmlPropertyLines","inputHtmlName","fmtAttrs","fmtLabels","minMax","_WrapLines$b","nodeJsName","ctxCreateMethodName","SinglePathFilter","_Filter","nodePropertyJsName","inputJsName","fn","eventProp","PassiveByDefaultSinglePathFilter","_SinglePathFilter","_this8","filterClasses","_PassiveByDefaultSing","_PassiveByDefaultSing2","_SinglePathFilter2","_Filter2","_this13","messageHtmlName","reverb","wetGainNodeJsName","dryGainNodeJsName","url","equalizer","_Filter3","getFrequencyOption","allGainsConstant","singleFreq","affectedFreqsAndOptions","fo","noGainsConstant","getJsData","freq","getJsDataItem","getJsLoopLines","inputHtmlNameExpr","constLines","varLines","outerNodeJsName","frequencies","filter","_CollectionFeature","skipNode","nodeJsNames",31,"options.sources","options.sources.{audio,video}","options.sources.{audio,video}.add","options.sources.{audio,video}.url","options.sources.video.{width,height}","options.filters","options.filters.gain","options.filters.gain.add","options.filters.gain.gain","options.filters.panner","options.filters.panner.add","options.filters.panner.pan","options.filters.biquad","options.filters.biquad.add","options.filters.biquad.type","options.filters.biquad.type.{lowpass,highpass,bandpass,lowshelf,highshelf,peaking,notch,allpass}","options.filters.biquad.frequency","options.filters.biquad.Q","options.filters.biquad.detune","options.filters.biquad.gain","options.filters.convolver","options.filters.convolver.add","options.filters.convolver.url","options.filters.convolver.reverb","options.filters.convolver.buffer.loading","options.filters.convolver.buffer.error","options.filters.equalizer","options.filters.equalizer.add","options.filters.equalizer.gain{60,170,350,1000,3500,10000}","options.destination","options.destination.compressor","options.destination.compressor.enable","options.destination.waveform","options.canvas","options.canvas.{width,height}","options.canvas.line","options.canvas.line.width","options.canvas.line.color","options.canvas.line.color.{r,g,b,a}","options.canvas.background","options.canvas.background.type","options.canvas.background.type.{clear,filled}","options.canvas.background.color","options.canvas.background.color.{r,g,b,a}","options-output.input","options-output.range","code-output.warning.jsfiddle-run","code.title","comment.context","comment.sources.audio","comment.sources.video","comment.filters.gain","comment.filters.panner","comment.filters.biquad","comment.filters.convolver","comment.filters.convolver.single","comment.filters.equalizer","comment.filters.equalizer.single","comment.destination","comment.destination.compressor","comment.destination.waveform","units.pixel.a","units.pixel.{1,2}","units.hertz.a","units.hertz.{1,2}","units.decibel.a","units.decibel.{1,2}","options.filters.biquad.type.lowpass","options.filters.biquad.type.highpass","options.filters.biquad.type.bandpass","options.filters.biquad.type.{lowshelf,highshelf,peaking}","options.filters.biquad.type.notch","options.filters.biquad.type.allpass","units.pixel.{1,2,5}","units.hertz.{1,2,5}","units.decibel.{1,2,5}",32,"idCounter","i18ns","each","$container","closest","codeOutput","optionsOutput","34","35",33,"LiveNumber","dataValue","dataMin","dataMax","dataInput","defaultMin","defaultMax","_min","_max","_input","_$range","updateInternalVisibility","exportHelper","src","$range","LiveInt","_Option$LiveNumber","LiveFloat","_Option$LiveNumber2","FixedLiveSelect","LiveSelect","_Option$Select","BaseOptionsOutput","_BaseOptionsOutput","writeMinMaxInput","minOrMax","inputCheckboxId","$inputCheckbox","$rangeMinInput","$rangeMaxInput","find","BaseOptions","_BaseOptions","canvas.background.type","destination.waveform","Source","getElementHtmlLines","elementHtmlName","sourceClasses","audio","_Source","video","_Source2"],"mappings":"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","file":"webaudio-starter.js","sourcesContent":["(function () {\n    var babelHelpers = {\n        typeof: function (obj) {\n            return obj && typeof Symbol !== 'undefined' && obj.constructor === Symbol ? 'symbol' : typeof obj;\n        },\n        createClass: function () {\n            function defineProperties(target, props) {\n                for (var i = 0; i < props.length; i++) {\n                    var descriptor = props[i];\n                    descriptor.enumerable = descriptor.enumerable || false;\n                    descriptor.configurable = true;\n                    if ('value' in descriptor)\n                        descriptor.writable = true;\n                    Object.defineProperty(target, descriptor.key, descriptor);\n                }\n            }\n            return function (Constructor, protoProps, staticProps) {\n                if (protoProps)\n                    defineProperties(Constructor.prototype, protoProps);\n                if (staticProps)\n                    defineProperties(Constructor, staticProps);\n                return Constructor;\n            };\n        }(),\n        classCallCheck: function (instance, Constructor) {\n            if (!(instance instanceof Constructor)) {\n                throw new TypeError('Cannot call a class as a function');\n            }\n        },\n        possibleConstructorReturn: function (self, call) {\n            if (!self) {\n                throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called');\n            }\n            return call && (typeof call === 'object' || typeof call === 'function') ? call : self;\n        },\n        inherits: function (subClass, superClass) {\n            function defaults(obj, defaults) {\n                var keys = Object.getOwnPropertyNames(defaults);\n                for (var i = 0; i < keys.length; i++) {\n                    var key = keys[i];\n                    var value = Object.getOwnPropertyDescriptor(defaults, key);\n                    if (value && value.configurable && obj[key] === undefined) {\n                        Object.defineProperty(obj, key, value);\n                    }\n                }\n                return obj;\n            }\n            ;\n            if (typeof superClass !== 'function' && superClass !== null) {\n                throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);\n            }\n            subClass.prototype = Object.create(superClass && superClass.prototype, {\n                constructor: {\n                    value: subClass,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true\n                }\n            });\n            if (superClass)\n                defaults(subClass, superClass);\n        },\n        taggedTemplateLiteralLoose: function (strings, raw) {\n            strings.raw = raw;\n            return strings;\n        }\n    };\n    (function e(t, n, r) {\n        function s(o, u) {\n            if (!n[o]) {\n                if (!t[o]) {\n                    var a = typeof require == 'function' && require;\n                    if (!u && a)\n                        return a(o, !0);\n                    if (i)\n                        return i(o, !0);\n                    var f = new Error('Cannot find module \\'' + o + '\\'');\n                    throw f.code = 'MODULE_NOT_FOUND', f;\n                }\n                var l = n[o] = { exports: {} };\n                t[o][0].call(l.exports, function (e) {\n                    var n = t[o][1][e];\n                    return s(n ? n : e);\n                }, l, l.exports, e, t, n, r);\n            }\n            return n[o].exports;\n        }\n        var i = typeof require == 'function' && require;\n        for (var o = 0; o < r.length; o++)\n            s(r[o]);\n        return s;\n    }({\n        1: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (lang) {\n                    return function (strings) {\n                        var additionalStringsPrefix = 'code-output';\n                        var additionalStrings = {\n                            en: {\n                                'save': 'Save source code',\n                                'run': 'Run in new window',\n                                'open.codepen': 'Open in CodePen',\n                                'open.jsfiddle': 'Open in JSFiddle',\n                                'section.html': 'HTML',\n                                'section.css': 'CSS',\n                                'section.js': 'JavaScript',\n                                'embedded': 'embedded in HTML source code',\n                                'mode.full': 'complete HTML',\n                                'mode.body': 'only HTML body',\n                                'mode.embed': 'embed in HTML',\n                                'mode.paste': 'extract to paste into HTML later',\n                                'mode.file': 'extract to load as external resource',\n                                'formatting': 'Formatting',\n                                'formatting.indent': 'indent with tabs',\n                                'formatting.indentNumber': 'spaces per indent',\n                                'formatting.jsSemicolons': 'JavaScript semicolons',\n                                'warning.no-hljs': '<a href=https://highlightjs.org/>highlight.js</a> (hosted on <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) is not loaded. Syntax highlighting is disabled.'\n                            },\n                            ru: {\n                                'save': 'Сохранить исходный код',\n                                'run': 'Запустить в новом окне',\n                                'open.codepen': 'Открыть в CodePen',\n                                'open.jsfiddle': 'Открыть в JSFiddle',\n                                'section.html': 'HTML',\n                                'section.css': 'CSS',\n                                'section.js': 'JavaScript',\n                                'embedded': 'встроен в код HTML',\n                                'mode.full': 'полностью',\n                                'mode.body': 'только <code>body</code>',\n                                'mode.embed': 'встроить в HTML',\n                                'mode.paste': 'извлечь для последующей вставки в HTML',\n                                'mode.file': 'извлечь для загрузки в качестве внешнего ресурса',\n                                'formatting': 'Форматирование',\n                                'formatting.indent': 'отступы с помощью tab',\n                                'formatting.indentNumber': 'пробелов в отступе',\n                                'formatting.jsSemicolons': '<code>;</code> в JavaScript',\n                                'warning.no-hljs': '<a href=https://highlightjs.org/>highlight.js</a> (с сервера <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) не загружен. Подсветка синтаксиса отключена.'\n                            }\n                        };\n                        for (var id in additionalStrings[lang]) {\n                            strings[additionalStringsPrefix + '.' + id] = additionalStrings[lang][id];\n                        }\n                        return strings;\n                    };\n                };\n            },\n            {}\n        ],\n        2: [\n            function (require, module, exports) {\n                'use strict';\n                var debounce = require(6);\n                var repeat = require(8);\n                var getHtmlDataUri = function (html) {\n                    return 'data:text/html;charset=utf-8,' + encodeURIComponent(html);\n                };\n                var CodeOutput = function () {\n                    function CodeOutput(generateCode, i18n) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, CodeOutput);\n                        var code = generateCode();\n                        var $sectionCode = {}, $sectionModeInput = {};\n                        var $indentCheckbox = undefined, $indentNumber = undefined, $jsSemicolonsCheckbox = undefined;\n                        var getCode = function () {\n                            return code;\n                        };\n                        var getFormatting = function () {\n                            var indent = '\\t';\n                            if (!$indentCheckbox.prop('checked')) {\n                                var n = 4;\n                                if ($indentNumber[0].checkValidity()) {\n                                    n = Number($indentNumber.val());\n                                }\n                                indent = repeat(' ', n);\n                            }\n                            return {\n                                refs: _this.refs,\n                                indent: indent,\n                                jsSemicolons: $jsSemicolonsCheckbox.prop('checked')\n                            };\n                        };\n                        var getSectionModes = function () {\n                            return {\n                                html: $sectionModeInput['html'].val(),\n                                css: $sectionModeInput['css'].val(),\n                                js: $sectionModeInput['js'].val()\n                            };\n                        };\n                        var extractCode = function () {\n                            var sectionModes = getSectionModes();\n                            var sections = code.extractSections(sectionModes);\n                            for (var sectionName in sections) {\n                                if (sectionModes[sectionName] == 'embed') {\n                                    $sectionCode[sectionName].empty().append('<p>' + i18n('code-output.embedded') + '</p>');\n                                } else {\n                                    var $code = undefined;\n                                    $sectionCode[sectionName].empty().append($('<pre>').append($code = $('<code class=\\'' + sectionName + '\\'>')));\n                                    $code.html(sections[sectionName].getHtml(getFormatting()).join('\\n'));\n                                    if (window.hljs) {\n                                        hljs.highlightBlock($code[0]);\n                                    }\n                                }\n                            }\n                        };\n                        var writeFormattingControls = function () {\n                            return $('<details>').append('<summary>' + i18n('code-output.formatting') + '</summary>', $('<div>').append($('<label>').append($indentCheckbox = $('<input type=\\'checkbox\\' checked>').change(extractCode), ' ' + i18n('code-output.formatting.indent'))), $('<div>').append($('<label>').append($indentNumber = $('<input type=\\'number\\' min=\\'0\\' max=\\'32\\' value=\\'4\\' required>').on('input change', extractCode), ' ' + i18n('code-output.formatting.indentNumber'))), $('<div>').append($('<label>').append($jsSemicolonsCheckbox = $('<input type=\\'checkbox\\'>').change(extractCode), ' ' + i18n('code-output.formatting.jsSemicolons'))));\n                        };\n                        var writeSection = function (sectionName) {\n                            var extractable = sectionName != 'html';\n                            var $summary = $('<summary>' + i18n('code-output.section.' + sectionName) + '</summary>');\n                            var $saveButton = undefined;\n                            $summary.append(' ', $sectionModeInput[sectionName] = $('<select>').append((sectionName == 'html' ? [\n                                'full',\n                                'body'\n                            ] : [\n                                'embed',\n                                'paste',\n                                'file'\n                            ]).map(function (mode) {\n                                return $('<option>').val(mode).html(i18n('code-output.mode.' + mode));\n                            })).change(function () {\n                                if (extractable) {\n                                    $saveButton.prop('disabled', this.value == 'embed');\n                                }\n                                extractCode();\n                            }), ' ', /*\r\n   // doesn't work in IE\r\n   $(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\r\n   \t// yes I want a button, but download attr is only available for links\r\n   \t$(this).attr('href',getHtmlDataUri(\r\n   \t\tsection.get(this.formatting).join(\"\\n\")\r\n   \t))\r\n   })\r\n   */\n                            $saveButton = $('<button type=\\'button\\'>' + i18n('code-output.save') + '</button>').click(function () {\n                                var section = code.extractSections(getSectionModes())[sectionName];\n                                // http://stackoverflow.com/a/24354303\n                                var blob = new Blob([section.get(getFormatting()).join('\\n')], { type: section.mimeType });\n                                if (navigator.msSaveOrOpenBlob) {\n                                    navigator.msSaveOrOpenBlob(blob, section.filename);\n                                } else {\n                                    var $a = $('<a>').attr('download', section.filename).attr('href', URL.createObjectURL(blob)).appendTo('body');\n                                    $a.get(0).click();\n                                    $a.remove();\n                                }\n                            }));\n                            if (extractable) {\n                                $saveButton.prop('disabled', $sectionModeInput[sectionName].val() == 'embed');\n                            }\n                            return $('<details open>').append($summary, $sectionCode[sectionName] = $('<div class=\\'code\\'>'));\n                        };\n                        var $output = $('<div class=\\'code-output\\'>').append(this.writeButtons(getCode, getFormatting, i18n)).append(writeFormattingControls(), writeSection('html'), writeSection('css'), writeSection('js'));\n                        if (!window.hljs) {\n                            $output.append('<p>' + i18n('code-output.warning.no-hljs') + '</p>');\n                        }\n                        $output.append(this.writeButtons(getCode, getFormatting, i18n));\n                        extractCode();\n                        var delay = 200;\n                        var update = debounce(function () {\n                            code = generateCode();\n                            extractCode();\n                        }, delay);\n                        // public props:\n                        this.$output = $output;\n                        this.update = update;\n                    }\n                    // private interface:\n                    CodeOutput.prototype.writeButtons = function writeButtons(getCode, getFormatting, i18n) {\n                        return $('<div>').append($('<button type=\\'button\\'>' + i18n('code-output.run') + '</button>').click(function () {\n                            var code = getCode();\n                            var html = code.get(getFormatting()).join('\\n');\n                            if (navigator.msSaveOrOpenBlob) {\n                                // has drawbacks:\n                                // * Firefox and Chrome have trouble showing the source\n                                // * weird bug in Firefox:\n                                //   in webgl-starter: add z-rotation, slider input, add speed, slider input, run, change rotation range, run again\n                                // * Firefox shows url of a generator page\n                                var w = window.open('', 'generatedCode');\n                                w.document.open();\n                                w.document.write(html);\n                                w.document.close();\n                            } else {\n                                // has drawbacks:\n                                // * doesn't work in IE b/c they decided it's security risk\n                                // * long url\n                                window.open(getHtmlDataUri(html), 'generatedCode');\n                            }\n                        }), ' ', $('<button type=\\'button\\'>' + i18n('code-output.open.codepen') + '</button>').click(function () {\n                            // http://blog.codepen.io/documentation/api/prefill/\n                            var code = getCode();\n                            var sections = code.extractSections({\n                                html: 'body',\n                                css: 'paste',\n                                js: 'paste'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(getFormatting()).join('\\n');\n                            };\n                            $('<form method=\\'post\\' action=\\'http://codepen.io/pen/define/\\' target=\\'codepenGeneratedCode\\'>').append($('<input type=\\'hidden\\' name=\\'data\\'>').val(JSON.stringify({\n                                html: getSection('html'),\n                                css: getSection('css'),\n                                js: getSection('js'),\n                                title: code.title\n                            }))).appendTo('body').submit().remove();\n                        }), ' ', $('<button type=\\'button\\'>' + i18n('code-output.open.jsfiddle') + '</button>').click(function () {\n                            // http://doc.jsfiddle.net/api/post.html\n                            var code = getCode();\n                            var sections = code.extractSections({\n                                html: 'body',\n                                css: 'paste',\n                                js: 'paste'\n                            });\n                            var getSection = function (sectionName) {\n                                return sections[sectionName].get(getFormatting()).join('\\n');\n                            };\n                            var writeSection = function (sectionName) {\n                                return $('<input type=\\'hidden\\'>').attr('name', sectionName).val(getSection(sectionName));\n                            };\n                            $('<form method=\\'post\\' action=\\'http://jsfiddle.net/api/post/library/pure/\\' target=\\'jsfiddleGeneratedCode\\'>').append(writeSection('html'), writeSection('css'), writeSection('js'), $('<input type=\\'hidden\\' name=\\'title\\'>').val(code.title), '<input type=\\'hidden\\' name=\\'wrap\\' value=\\'b\\'>').appendTo('body').submit().remove();\n                        }));\n                    };\n                    babelHelpers.createClass(CodeOutput, [{\n                            key: 'refs',\n                            get: function () {\n                                return {};\n                            }\n                        }]);\n                    return CodeOutput;\n                }();\n                module.exports = CodeOutput;\n            },\n            {\n                '6': 6,\n                '8': 8\n            }\n        ],\n        3: [\n            function (require, module, exports) {\n                'use strict';\n                var CodeSection = function () {\n                    function CodeSection(filename, mimeType, lines) {\n                        babelHelpers.classCallCheck(this, CodeSection);\n                        this.filename = filename;\n                        this.mimeType = mimeType;\n                        this.lines = lines;\n                    }\n                    CodeSection.prototype.get = function get(formatting) {\n                        return this.lines.get(formatting);\n                    };\n                    CodeSection.prototype.getHtml = function getHtml(formatting) {\n                        return this.lines.getHtml(formatting);\n                    };\n                    return CodeSection;\n                }();\n                module.exports = CodeSection;\n            },\n            {}\n        ],\n        4: [\n            function (require, module, exports) {\n                // assumes string is dot-separated, like this: \"some.html.id\"\n                var capitalize = require(5);\n                module.exports = function (s) {\n                    return s.split('.').map(function (w, i) {\n                        return i > 0 ? capitalize(w) : w;\n                    }).join('');\n                };\n            },\n            { '5': 5 }\n        ],\n        5: [\n            function (require, module, exports) {\n                // assumes string is lowercase\n                module.exports = function (s) {\n                    return s.charAt(0).toUpperCase() + s.slice(1);\n                };\n            },\n            {}\n        ],\n        6: [\n            function (require, module, exports) {\n                // no options\n                module.exports = function (func, wait) {\n                    var timeoutId = null;\n                    return function () {\n                        clearTimeout(timeoutId);\n                        timeoutId = setTimeout(func, wait);\n                    };\n                };\n            },\n            {}\n        ],\n        7: [\n            function (require, module, exports) {\n                module.exports = function (s) {\n                    var entityMap = {\n                        '&': '&amp;',\n                        '<': '&lt;',\n                        '>': '&gt;',\n                        '\"': '&quot;',\n                        '\\'': '&#39;'\n                    };\n                    // lodash also escapes `\n                    return String(s).replace(/[&<>\"']/g, function (m) {\n                        return entityMap[m];\n                    });\n                };\n            },\n            {}\n        ],\n        8: [\n            function (require, module, exports) {\n                module.exports = function (s, n) {\n                    return Array(n + 1).join(s);\n                };\n            },\n            {}\n        ],\n        9: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbersInternal = function (numbers, precision, keepDot, noPlus) {\n                    var maxPrecision = 0;\n                    if (keepDot) {\n                        maxPrecision = 1;\n                    }\n                    var hasNegative = false;\n                    for (var i in numbers) {\n                        var p = undefined;\n                        if (precision !== undefined) {\n                            p = precision;\n                        } else if (numbers[i].precision !== undefined) {\n                            p = numbers[i].precision;\n                        } else {\n                            throw new Error('formatNumbers received no precision');\n                        }\n                        var number = Number(numbers[i]);\n                        if (number < 0)\n                            hasNegative = true;\n                        var s = number.toFixed(p);\n                        if (p > 0) {\n                            p -= s.match(/0*$/)[0].length;\n                        }\n                        if (p > maxPrecision) {\n                            maxPrecision = p;\n                        }\n                    }\n                    var ss = {};\n                    for (var i in numbers) {\n                        var number = Number(numbers[i]);\n                        var s = number.toFixed(maxPrecision);\n                        if (!noPlus && hasNegative && number > 0) {\n                            s = '+' + s;\n                        }\n                        ss[i] = s;\n                    }\n                    return ss;\n                };\n                var formatNumbers = function (number, precision) {\n                    return formatNumbersInternal(number, precision);\n                };\n                formatNumbers.html = function (number, precision) {\n                    return formatNumbersInternal(number, precision, false, true);\n                };\n                formatNumbers.js = function (number, precision) {\n                    return formatNumbersInternal(number, precision);\n                };\n                formatNumbers.glsl = function (number, precision) {\n                    return formatNumbersInternal(number, precision, true);\n                };\n                module.exports = formatNumbers;\n            },\n            {}\n        ],\n        10: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (inStrings) {\n                    var strings = {};\n                    var expandRegexp = /^([^{]*)\\{([^}]*)\\}(.*)$/;\n                    function expandIdAndString(id, string) {\n                        var match = undefined;\n                        if (match = expandRegexp.exec(id)) {\n                            (function () {\n                                var idStart = match[1];\n                                var idMids = match[2].split(',');\n                                var idEnd = match[3];\n                                if (match = expandRegexp.exec(string)) {\n                                    (function () {\n                                        var stringStart = match[1];\n                                        var stringMidsStr = match[2];\n                                        var stringMids = stringMidsStr.split(',');\n                                        var stringEnd = match[3];\n                                        idMids.forEach(function (idMid, i) {\n                                            var stringMid = stringMids[i];\n                                            if (stringMidsStr != '') {\n                                                expandIdAndString(idStart + idMid + idEnd, stringStart + stringMid + stringEnd);\n                                            } else {\n                                                expandIdAndString(idStart + idMid + idEnd, stringStart + idMid + stringEnd);\n                                            }\n                                        });\n                                    }());\n                                } else {\n                                    idMids.forEach(function (idMid) {\n                                        expandIdAndString(idStart + idMid + idEnd, string);\n                                    });\n                                }\n                            }());\n                        } else {\n                            strings[id] = string;\n                        }\n                    }\n                    for (var id in inStrings) {\n                        expandIdAndString(id, inStrings[id]);\n                    }\n                    return strings;\n                };\n            },\n            {}\n        ],\n        11: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(7);\n                module.exports = function (langStrings) {\n                    return function (lang) {\n                        var defaultLang = 'en';\n                        lang = lang || defaultLang;\n                        lang = lang.split('-')[0];\n                        // get primary language subtag\n                        var strings = langStrings[lang];\n                        if (strings === undefined) {\n                            lang = defaultLang;\n                            strings = langStrings[lang];\n                        }\n                        var i18n = function (id) {\n                            if (strings[id] !== undefined) {\n                                return strings[id];\n                            } else {\n                                throw new Error('undefined string ' + id);\n                            }\n                        };\n                        i18n.lang = lang;\n                        i18n.has = function (id) {\n                            return strings[id] !== undefined;\n                        };\n                        if (lang == 'en') {\n                            i18n.number = function (n) {\n                                return String(n).replace('-', '\\u2212');\n                            };\n                            i18n.pluralSuffix = function (n) {\n                                var ns = String(n);\n                                if (ns.indexOf('.') < 0) {\n                                    var nn = Number(n);\n                                    if (Math.abs(nn) == 1) {\n                                        return '1';\n                                    } else {\n                                        return '2';\n                                    }\n                                } else {\n                                    return '2';\n                                }\n                            };\n                        } else if (lang == 'ru') {\n                            i18n.number = function (n) {\n                                return String(n).replace('-', '\\u2212').replace('.', ',');\n                            };\n                            i18n.pluralSuffix = function (n) {\n                                var ns = String(n);\n                                if (ns.indexOf('.') < 0) {\n                                    var teen = ns.slice(-2, -1) === '1';\n                                    if (ns.slice(-1) === '1' && !teen) {\n                                        return '1';\n                                    } else if ('234'.indexOf(ns.slice(-1)) >= 0 && !teen) {\n                                        return '2';\n                                    } else {\n                                        return '5';\n                                    }\n                                } else {\n                                    return '2';\n                                }\n                            };\n                        }\n                        i18n.plural = function (n, id) {\n                            return this(id + '.' + this.pluralSuffix(n));\n                        };\n                        i18n.numberWithUnits = function (n, unit, abbrFn) {\n                            if (abbrFn === undefined) {\n                                // codegen needs its own fn\n                                abbrFn = function (abbr, expansion) {\n                                    return '<abbr title=\\'' + escape(expansion) + '\\'>' + abbr + '</abbr>';\n                                };    // expansion is html for stuff like s^(-1)\n                            }\n                            var s = this.number(n);\n                            if (unit !== undefined) {\n                                if (unit.length == 1 && /^\\W/.test(unit)) {\n                                    s += unit;\n                                } else {\n                                    s += ' ';\n                                    // nbsp\n                                    var abbr = undefined;\n                                    if (unit == '1/second') {\n                                        abbr = i18n('units.second.a') + '<sup>\\u22121</sup>';\n                                    } else {\n                                        abbr = i18n('units.' + unit + '.a');\n                                    }\n                                    var expansion = this.plural(n, 'units.' + unit);\n                                    s += abbrFn(abbr, expansion);\n                                }\n                            }\n                            return s;\n                        };\n                        return i18n;\n                    };\n                };\n            },\n            { '7': 7 }\n        ],\n        12: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(7);\n                var Lines = require(14);\n                var InterleaveLines = function (_Lines) {\n                    babelHelpers.inherits(InterleaveLines, _Lines);\n                    function InterleaveLines() {\n                        babelHelpers.classCallCheck(this, InterleaveLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    InterleaveLines.prototype.doGet = function doGet(formatting, html) {\n                        var out = [];\n                        var first = true;\n                        var fp = function () {\n                            if (first) {\n                                first = false;\n                            } else {\n                                out.push('');\n                            }\n                        };\n                        this.data.forEach(function (item) {\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                if (subOut.length > 0) {\n                                    fp();\n                                    out.push.apply(out, subOut);\n                                }\n                            } else if (typeof item == 'string') {\n                                fp();\n                                var s = html ? escape(item) : item;\n                                out.push(s);\n                            }\n                        });\n                        return out;\n                    };\n                    return InterleaveLines;\n                }(Lines);\n                module.exports = InterleaveLines;\n            },\n            {\n                '14': 14,\n                '7': 7\n            }\n        ],\n        13: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(14);\n                var JsLines = function (_Lines) {\n                    babelHelpers.inherits(JsLines, _Lines);\n                    function JsLines() {\n                        babelHelpers.classCallCheck(this, JsLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    JsLines.prototype.processStringInGet = function processStringInGet(s, formatting) {\n                        if (formatting.jsSemicolons) {\n                            return s.replace(/^;/, '');\n                        } else {\n                            return s.replace(/;$/, '');\n                        }\n                    };\n                    return JsLines;\n                }(Lines);\n                module.exports = JsLines;\n            },\n            { '14': 14 }\n        ],\n        14: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\n                var escape = require(7);\n                var repeat = require(8);\n                var TO = {};\n                // TODO Symbol\n                var Lines = function () {\n                    // lines private interface:\n                    function Lines(data) {\n                        babelHelpers.classCallCheck(this, Lines);\n                        if (!Array.isArray(data)) {\n                            throw new TypeError('attempted to construct Lines with non-array data argument');\n                        }\n                        this.data = data;\n                    }\n                    Lines.prototype.isDataEmpty = function isDataEmpty() {\n                        for (var i = 0; i < this.data.length; i++) {\n                            var item = this.data[i];\n                            if (item instanceof Lines) {\n                                if (!item.isEmpty()) {\n                                    return false;\n                                }\n                            } else if (typeof item == 'string') {\n                                return false;\n                            }\n                        }\n                        return true;\n                    };\n                    Lines.prototype.processStringInGet = function processStringInGet(s, formatting) {\n                        return s;\n                    };\n                    Lines.prototype.doGet = function doGet(formatting, html) {\n                        var _this = this;\n                        var out = [];\n                        var addTo = false;\n                        this.data.forEach(function (item) {\n                            if (item === TO) {\n                                addTo = true;\n                            } else if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                if (addTo && subOut.length > 0) {\n                                    out.push(out.pop() + subOut.shift());\n                                }\n                                out.push.apply(out, subOut);\n                                addTo = false;\n                            } else if (typeof item == 'string') {\n                                var s = _this.processStringInGet(item, formatting);\n                                if (formatting.indent !== undefined && formatting.indent != '\\t') {\n                                    s = s.replace(/^(\\t)+/, function (match) {\n                                        return repeat(formatting.indent, match.length);\n                                    });\n                                }\n                                s = html ? escape(s) : s;\n                                if (addTo) {\n                                    out.push(out.pop() + s);\n                                } else {\n                                    out.push(s);\n                                }\n                                addTo = false;\n                            }\n                        });\n                        return out;\n                    };\n                    // lines public interface:\n                    Lines.b = function b() {\n                        var _this2 = this, _arguments = arguments;\n                        var data = [];\n                        var makeLines = function () {\n                            return new (Function.prototype.bind.apply(_this2, [null].concat([data], Array.prototype.slice.call(_arguments))))();\n                        };\n                        var a = function () {\n                            return a.a.apply(a, arguments);\n                        };\n                        a.a = function () {\n                            data.push.apply(data, arguments);\n                            return this;\n                        };\n                        a.t = function () {\n                            data.push.apply(data, [TO].concat(Array.prototype.slice.call(arguments)));\n                            return this;\n                        };\n                        a.e = makeLines;\n                        a.ae = function () {\n                            return this.a.apply(this, arguments).e();\n                        };\n                        return a;\n                    };\n                    Lines.ba = function ba() {\n                        var _b;\n                        return (_b = this.b()).a.apply(_b, arguments);\n                    };\n                    Lines.be = function be() {\n                        return this.b().e();\n                    };\n                    Lines.bae = function bae() {\n                        var _b2;\n                        return (_b2 = this.b()).a.apply(_b2, arguments).e();\n                    };\n                    Lines.prototype.isEmpty = function isEmpty() {\n                        return this.isDataEmpty();\n                    };\n                    Lines.prototype.get = function get(formatting) {\n                        if (formatting === undefined)\n                            formatting = {};\n                        return this.doGet(formatting, false);\n                    };\n                    Lines.prototype.getHtml = function getHtml(formatting) {\n                        if (formatting === undefined)\n                            formatting = {};\n                        return this.doGet(formatting, true);\n                    };\n                    Lines.prototype.count = function count() {\n                        return this.doGet({}, false).length;    // can be faster b/c don't need to output stuff\n                    };\n                    // TODO make HtmlLines\n                    Lines.html = function html(strings) {\n                        var _arguments2 = arguments;\n                        // html template tag\n                        // usage example for attributes: Lines.html`<input type=text value=${value}>`\n                        // usage example for elements: Lines.html`<option>${option}</option>`\n                        return strings.reduce(function (r, s, i) {\n                            var v = _arguments2[i];\n                            switch (r.slice(-1)) {\n                            case '=':\n                                if (v === false) {\n                                    return r.replace(/\\s+[a-zA-Z0-9-]+=$/, '') + s;    // TODO more permitting attr name regexp\n                                } else if (v === true) {\n                                    return r.replace(/=$/, '') + s;\n                                }\n                                v = String(v).replace(/&/g, '&amp;');\n                                if (v == '') {\n                                    return r.replace(/=$/, '') + s;\n                                } else if (!/[\\s\"'=<>`]/.test(v)) {\n                                    return r + v + s;\n                                } else if (!/'/.test(v)) {\n                                    return r + '\\'' + v + '\\'' + s;\n                                } else {\n                                    v = v.replace(/\"/g, '&quot;');\n                                    return r + '\"' + v + '\"' + s;\n                                }\n                            case '>':\n                                v = String(v).replace(/&/g, '&amp;').replace(/</g, '&lt;');\n                                return r + v + s;\n                            }\n                            throw new Error('invalid character before substitution');\n                        });\n                    };\n                    return Lines;\n                }();\n                module.exports = Lines;\n            },\n            {\n                '7': 7,\n                '8': 8\n            }\n        ],\n        15: [\n            function (require, module, exports) {\n                'use strict';\n                var WrapLines = require(22);\n                var NoseWrapLines = function (_WrapLines) {\n                    babelHelpers.inherits(NoseWrapLines, _WrapLines);\n                    function NoseWrapLines() {\n                        babelHelpers.classCallCheck(this, NoseWrapLines);\n                        return babelHelpers.possibleConstructorReturn(this, _WrapLines.apply(this, arguments));\n                    }\n                    NoseWrapLines.prototype.isEmpty = function isEmpty() {\n                        return this.isDataEmpty();\n                    };\n                    NoseWrapLines.prototype.doGet = function doGet(formatting, html) {\n                        if (this.isEmpty()) {\n                            return [];\n                        } else {\n                            return _WrapLines.prototype.doGet.call(this, formatting, html);\n                        }\n                    };\n                    return NoseWrapLines;\n                }(WrapLines);\n                module.exports = NoseWrapLines;\n            },\n            { '22': 22 }\n        ],\n        16: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\n                var Option = {};\n                // abstract classes\n                Option.Base = function () {\n                    _class.make = function make(name) {\n                        var nScalars = 0, nArrays = 0, nObjects = 0;\n                        var scalarArg = undefined, arrayArg = [], objectArg = {};\n                        for (var i = 1; i < arguments.length; i++) {\n                            var arg = arguments[i];\n                            if (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\n                                if (nScalars++ == 0)\n                                    scalarArg = arg;\n                            } else if (Array.isArray(arg)) {\n                                if (nArrays++ == 0)\n                                    arrayArg = arg;\n                            } else if (arg instanceof Object) {\n                                if (nObjects++ == 0)\n                                    objectArg = arg;\n                            }\n                        }\n                        var optionClass = this;\n                        var settings = this.collectArgs(scalarArg, arrayArg, objectArg);\n                        return function () {\n                            return new (Function.prototype.bind.apply(optionClass, [null].concat([\n                                name,\n                                settings\n                            ], Array.prototype.slice.call(arguments))))();\n                        };\n                    };\n                    _class.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        return settings;\n                    };\n                    function _class(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class);\n                        this.name = name;\n                        this.updateCallback = updateCallback;\n                        this.fullName = fullName;\n                        this._$ = null;\n                        this.isVisible = function () {\n                            return true;\n                        };\n                        this.fullNamesAffectingVisibility = [];\n                        if (settings.visibilityData !== undefined) {\n                            this.isVisible = function () {\n                                for (var testName in settings.visibilityData) {\n                                    var value = optionByFullName[testName].value;\n                                    if (settings.visibilityData[testName].indexOf(value) < 0) {\n                                        return false;\n                                    }\n                                }\n                                return true;\n                            };\n                            for (var testName in settings.visibilityData) {\n                                this.fullNamesAffectingVisibility.push(testName);\n                            }\n                        }\n                    }\n                    _class.prototype.updateVisibility = function updateVisibility() {\n                        if (this.$)\n                            this.$.toggle(this.isVisible());\n                    };\n                    _class.prototype.shortenExport = function shortenExport(data) {\n                        // used by parent\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            return data.value;\n                        } else {\n                            return data;\n                        }\n                    };\n                    _class.prototype.shortenExportAssign = function shortenExportAssign(data, parentData, name) {\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            parentData[name] = data.value;\n                        } else if (dataKeys.length > 0) {\n                            parentData[name] = data;\n                        }\n                    };\n                    babelHelpers.createClass(_class, [{\n                            key: '$',\n                            get: function () {\n                                return this._$;\n                            },\n                            set: function ($) {\n                                this._$ = $;\n                                this.updateVisibility();\n                            }\n                        }]);\n                    return _class;\n                }();\n                Option.Input = function (_Option$Base) {\n                    babelHelpers.inherits(_class2, _Option$Base);\n                    _class2.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.defaultValue === undefined)\n                            settings.defaultValue = scalarArg;\n                        return _Option$Base.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class2(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class2);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Base.apply(this, arguments));\n                        _this.defaultValue = settings.defaultValue;\n                        if (typeof data == 'object') {\n                            data = data.value;\n                        }\n                        if (data !== undefined) {\n                            _this._value = data;\n                        } else {\n                            _this._value = _this.defaultValue;\n                        }\n                        return _this;\n                    }\n                    _class2.prototype.export = function _export() {\n                        var data = {};\n                        if (this.value != this.defaultValue)\n                            data.value = this.value;\n                        return data;\n                    };\n                    babelHelpers.createClass(_class2, [{\n                            key: 'value',\n                            get: function () {\n                                return this._value;\n                            },\n                            set: function (value) {\n                                this._value = value;\n                                this.updateCallback();\n                            }\n                        }]);\n                    return _class2;\n                }(Option.Base);\n                Option.Boolean = function (_Option$Input) {\n                    babelHelpers.inherits(_class3, _Option$Input);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input.apply(this, arguments));\n                    }\n                    _class3.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        return _Option$Input.collectArgs.call(this, !!scalarArg, arrayArg, settings);\n                    };\n                    _class3.prototype.fix = function fix() {\n                        return this.value;\n                    };\n                    return _class3;\n                }(Option.Input);\n                Option.NonBoolean = function (_Option$Input2) {\n                    babelHelpers.inherits(_class4, _Option$Input2);\n                    function _class4() {\n                        babelHelpers.classCallCheck(this, _class4);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input2.apply(this, arguments));\n                    }\n                    _class4.prototype.fix = function fix() {\n                        var value = this.value;\n                        return {\n                            // can't use fixed value in boolean context\n                            name: this.name,\n                            value: value,\n                            valueOf: function () {\n                                return value;\n                            },\n                            toString: function () {\n                                return String(value);\n                            }\n                        };\n                    };\n                    return _class4;\n                }(Option.Input);\n                Option.Factor = function (_Option$NonBoolean) {\n                    babelHelpers.inherits(_class5, _Option$NonBoolean);\n                    _class5.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.availableValues === undefined)\n                            settings.availableValues = arrayArg;\n                        if (scalarArg === undefined)\n                            scalarArg = settings.availableValues[0];\n                        return _Option$NonBoolean.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class5(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class5);\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$NonBoolean.apply(this, arguments));\n                        _this4.availableValues = settings.availableValues;\n                        return _this4;\n                    }\n                    return _class5;\n                }(Option.NonBoolean);\n                Option.Number = function (_Option$NonBoolean2) {\n                    babelHelpers.inherits(_class6, _Option$NonBoolean2);\n                    // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\n                    _class6.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.availableMin === undefined)\n                            settings.availableMin = arrayArg[0];\n                        if (settings.availableMax === undefined)\n                            settings.availableMax = arrayArg[1];\n                        if (scalarArg === undefined)\n                            scalarArg = settings.availableMin;\n                        return _Option$NonBoolean2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class6(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class6);\n                        var _this5 = babelHelpers.possibleConstructorReturn(this, _Option$NonBoolean2.apply(this, arguments));\n                        _this5.availableMin = settings.availableMin;\n                        _this5.availableMax = settings.availableMax;\n                        _this5.unit = settings.unit;\n                        return _this5;\n                    }\n                    _class6.prototype.fix = function fix() {\n                        var fixed = _Option$NonBoolean2.prototype.fix.call(this);\n                        fixed.precision = this.precision;\n                        fixed.unit = this.unit;\n                        return fixed;\n                    };\n                    return _class6;\n                }(Option.NonBoolean);\n                Option.Collection = function (_Option$Base2) {\n                    babelHelpers.inherits(_class7, _Option$Base2);\n                    _class7.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.descriptions === undefined)\n                            settings.descriptions = arrayArg;\n                        return _Option$Base2.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class7(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class7);\n                        var _this6 = babelHelpers.possibleConstructorReturn(this, _Option$Base2.apply(this, arguments));\n                        _this6.entries = settings.descriptions.map(function (x) {\n                            var subName = x[1];\n                            var subData = undefined;\n                            if (typeof data == 'object')\n                                subData = data[subName];\n                            return makeEntry(x, fullName, subData, isInsideArray);    // nested option\n                        });\n                        return _this6;\n                    }\n                    _class7.prototype.export = function _export() {\n                        var data = {};\n                        this.entries.forEach(function (entry) {\n                            entry.shortenExportAssign(entry.export(), data, entry.name);\n                        });\n                        return data;\n                    };\n                    _class7.prototype.fix = function fix() {\n                        var fixedEntries = [];\n                        var fixed = {\n                            name: this.name,\n                            entries: fixedEntries\n                        };\n                        this.entries.forEach(function (entry) {\n                            fixedEntries.push(fixed[entry.name] = entry.fix());\n                        });\n                        return fixed;\n                    };\n                    return _class7;\n                }(Option.Base);\n                // concrete classes\n                Option.Void = function (_Option$Base3) {\n                    babelHelpers.inherits(_class8, _Option$Base3);\n                    function _class8() {\n                        babelHelpers.classCallCheck(this, _class8);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Base3.apply(this, arguments));\n                    }\n                    // useful as array entry w/o settings\n                    _class8.prototype.export = function _export() {\n                        return {};\n                    };\n                    _class8.prototype.fix = function fix() {\n                        return { name: this.name };\n                    };\n                    return _class8;\n                }(Option.Base);\n                Option.Checkbox = function (_Option$Boolean) {\n                    babelHelpers.inherits(_class9, _Option$Boolean);\n                    function _class9() {\n                        babelHelpers.classCallCheck(this, _class9);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Boolean.apply(this, arguments));\n                    }\n                    return _class9;\n                }(Option.Boolean);\n                Option.Select = function (_Option$Factor) {\n                    babelHelpers.inherits(_class10, _Option$Factor);\n                    function _class10() {\n                        babelHelpers.classCallCheck(this, _class10);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Factor.apply(this, arguments));\n                    }\n                    return _class10;\n                }(Option.Factor);\n                Option.Text = function (_Option$Factor2) {\n                    babelHelpers.inherits(_class11, _Option$Factor2);\n                    function _class11() {\n                        babelHelpers.classCallCheck(this, _class11);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Factor2.apply(this, arguments));\n                    }\n                    return _class11;\n                }(Option.Factor);\n                Option.Int = function (_Option$Number) {\n                    babelHelpers.inherits(_class12, _Option$Number);\n                    function _class12() {\n                        babelHelpers.classCallCheck(this, _class12);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Number.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class12, [{\n                            key: 'precision',\n                            get: function () {\n                                return 0;\n                            }\n                        }]);\n                    return _class12;\n                }(Option.Number);\n                Option.Float = function (_Option$Number2) {\n                    babelHelpers.inherits(_class13, _Option$Number2);\n                    function _class13(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class13);\n                        var _this12 = babelHelpers.possibleConstructorReturn(this, _Option$Number2.apply(this, arguments));\n                        if (settings.precision !== undefined) {\n                            _this12.precision = settings.precision;\n                        } else {\n                            if (_this12.availableMax >= 100) {\n                                _this12.precision = 1;\n                            } else if (_this12.availableMax >= 10) {\n                                _this12.precision = 2;\n                            } else {\n                                _this12.precision = 3;\n                            }\n                        }\n                        return _this12;\n                    }\n                    return _class13;\n                }(Option.Number);\n                Option.Root = function (_Option$Collection) {\n                    babelHelpers.inherits(_class14, _Option$Collection);\n                    function _class14() {\n                        babelHelpers.classCallCheck(this, _class14);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection.apply(this, arguments));\n                    }\n                    return _class14;\n                }(Option.Collection);\n                Option.Group = function (_Option$Collection2) {\n                    babelHelpers.inherits(_class15, _Option$Collection2);\n                    function _class15() {\n                        babelHelpers.classCallCheck(this, _class15);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection2.apply(this, arguments));\n                    }\n                    return _class15;\n                }(Option.Collection);\n                Option.Array = function (_Option$Base4) {\n                    babelHelpers.inherits(_class16, _Option$Base4);\n                    // TODO consider extending Collection\n                    _class16.collectArgs = function collectArgs(scalarArg, arrayArg, settings) {\n                        settings = Object.create(settings);\n                        if (settings.descriptions === undefined)\n                            settings.descriptions = arrayArg;\n                        if (settings.typePropertyName === undefined)\n                            settings.typePropertyName = scalarArg;\n                        return _Option$Base4.collectArgs.call(this, scalarArg, arrayArg, settings);\n                    };\n                    function _class16(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class16);\n                        var _this15 = babelHelpers.possibleConstructorReturn(this, _Option$Base4.apply(this, arguments));\n                        _this15.availableConstructors = new Map();\n                        settings.descriptions.forEach(function (x) {\n                            // TODO test array inside array\n                            var type = x[1];\n                            var ctor = function (subData) {\n                                return makeEntry(x, fullName, subData, true);\n                            };\n                            _this15.availableConstructors.set(type, ctor);\n                        });\n                        if (settings.typePropertyName !== undefined) {\n                            _this15.typePropertyName = settings.typePropertyName;\n                        } else {\n                            _this15.typePropertyName = 'type';\n                        }\n                        // populate array entries from data:\n                        _this15._entries = [];\n                        var subDatas = [];\n                        if (Array.isArray(data)) {\n                            subDatas = data;\n                        } else if (typeof data == 'object') {\n                            subDatas = data.value;\n                        }\n                        var defaultType = _this15.availableTypes[0];\n                        for (var i = 0; i < subDatas.length; i++) {\n                            var subData = subDatas[i];\n                            var subType = defaultType;\n                            if (typeof subData == 'object' && subData[_this15.typePropertyName] !== undefined) {\n                                subType = subData[_this15.typePropertyName];\n                            }\n                            var subCtor = _this15.availableConstructors.get(subType);\n                            if (subCtor) {\n                                _this15._entries.push(subCtor(subData));\n                            }\n                        }\n                        return _this15;\n                    }\n                    _class16.prototype.addEntry = function addEntry(type) {\n                        var entry = this.availableConstructors.get(type)();\n                        this._entries.push(entry);\n                        this.updateCallback();\n                        return entry;\n                    };\n                    _class16.prototype.export = function _export() {\n                        var _this16 = this;\n                        var defaultType = this.availableTypes[0];\n                        return {\n                            value: this._entries.map(function (entry) {\n                                var subData = entry.export();\n                                var subType = entry.name;\n                                if (subType != defaultType)\n                                    subData[_this16.typePropertyName] = subType;\n                                return entry.shortenExport(subData);\n                            })\n                        };\n                    };\n                    _class16.prototype.fix = function fix() {\n                        var _this17 = this;\n                        return {\n                            name: this.name,\n                            entries: this._entries.map(function (entry) {\n                                var subFixed = entry.fix();\n                                if (typeof subFixed == 'object')\n                                    subFixed[_this17.typePropertyName] = entry.name;\n                                return subFixed;\n                            })\n                        };\n                    };\n                    babelHelpers.createClass(_class16, [\n                        {\n                            key: 'availableTypes',\n                            get: function () {\n                                var types = [];\n                                this.availableConstructors.forEach(function (_, type) {\n                                    types.push(type);\n                                });\n                                return types;\n                            }\n                        },\n                        {\n                            key: 'entries',\n                            get: function () {\n                                return this._entries;\n                            },\n                            set: function (entries) {\n                                this._entries = entries;\n                                this.updateCallback();\n                            }\n                        }\n                    ]);\n                    return _class16;\n                }(Option.Base);\n                module.exports = Option;\n            },\n            {}\n        ],\n        17: [\n            function (require, module, exports) {\n                'use strict';\n                module.exports = function (lang) {\n                    return function (strings) {\n                        var additionalStringsPrefix = 'options-output';\n                        var additionalStrings = {\n                            en: {\n                                'reset': 'Reset',\n                                'drag': 'Drag or press \\u2191/\\u2193 while in focus to reorder',\n                                'delete': 'Delete'\n                            },\n                            ru: {\n                                'reset': 'Сбросить',\n                                'drag': 'Перетаскивайте или нажимайте \\u2191/\\u2193, пока элемент в фокусе, чтобы изменить порядок',\n                                'delete': 'Удалить'\n                            }\n                        };\n                        for (var id in additionalStrings[lang]) {\n                            strings[additionalStringsPrefix + '.' + id] = additionalStrings[lang][id];\n                        }\n                        return strings;\n                    };\n                };\n            },\n            {}\n        ],\n        18: [\n            function (require, module, exports) {\n                'use strict';\n                var formatNumbers = require(9);\n                var Option = require(16);\n                var OptionsOutput = function () {\n                    function OptionsOutput(options, generateId, i18n) {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        var optionClassWriters = new Map();\n                        this.setOptionClassWriters(optionClassWriters);\n                        function write(option) {\n                            var optionProto = option;\n                            while (optionProto = Object.getPrototypeOf(optionProto)) {\n                                var optionClassWriter = optionClassWriters.get(optionProto.constructor);\n                                if (optionClassWriter) {\n                                    return optionClassWriter(option, write, i18n, generateId);\n                                }\n                            }\n                        }\n                        // public prop:\n                        this.$output = write(options.root);\n                    }\n                    // override this fn for custom writers\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        optionClassWriters.set(Option.Root, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'options-output\\'>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Group, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Void, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'option no-lead\\'>').html(i18n('options.' + option.fullName));\n                        });\n                        optionClassWriters.set(Option.Checkbox, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div class=\\'option no-lead\\'>').append($('<input type=\\'checkbox\\' id=\\'' + id + '\\'>').prop('checked', option.value).change(function () {\n                                option.value = $(this).prop('checked');\n                            }), ' <label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + '</label>');\n                        });\n                        optionClassWriters.set(Option.Select, function (option, writeOption, i18n, generateId) {\n                            var valueId = function (value) {\n                                return 'options.' + option.fullName + '.' + value;\n                            };\n                            var valueInfoId = function (value) {\n                                return 'options-info.' + option.fullName + '.' + value;\n                            };\n                            var id = generateId();\n                            var $select = undefined;\n                            option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label> ', $select = $('<select id=\\'' + id + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').val(availableValue).html(i18n(valueId(availableValue)));\n                            })).val(option.value).change(function () {\n                                option.value = this.value;\n                            }));\n                            if (option.availableValues.some(function (availableValue) {\n                                    return i18n.has(valueInfoId(availableValue));\n                                })) {\n                                (function () {\n                                    var $tip = undefined, $tipContent = undefined;\n                                    option.$.append(' ', $tip = $('<span class=\\'tip-info\\'>').append($tipContent = $('<span class=\\'tip-content\\'>')));\n                                    var handler = function () {\n                                        if (i18n.has(valueInfoId(this.value))) {\n                                            $tipContent.html(i18n(valueInfoId(this.value)));\n                                            $tip.show();\n                                        } else {\n                                            $tip.hide();\n                                            $tipContent.empty();\n                                        }\n                                    };\n                                    handler.call($select[0]);\n                                    $select.change(handler);\n                                }());\n                            }\n                            return option.$;\n                        });\n                        optionClassWriters.set(Option.Text, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            var listId = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label> ', $('<input type=\\'text\\' id=\\'' + id + '\\' list=\\'' + listId + '\\' />').val(option.value).on('input change', function () {\n                                option.value = this.value;\n                            }), ' ', $('<datalist id=\\'' + listId + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').text(availableValue);\n                            })));\n                        });\n                        optionClassWriters.set(Option.Number, function (option, writeOption, i18n, generateId) {\n                            var p = option.precision;\n                            var setInputAttrs = function ($input) {\n                                return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', Math.pow(0.1, p).toFixed(p));\n                            };\n                            var setInputAttrsAndListeners = function ($input, getOtherInput) {\n                                return setInputAttrs($input).val(option.value).on('input change', function () {\n                                    if (this.checkValidity()) {\n                                        var $that = getOtherInput();\n                                        $that.val(this.value);\n                                        option.value = parseFloat(this.value);\n                                    }\n                                });\n                            };\n                            var id = generateId();\n                            var $sliderInput = undefined, $numberInput = undefined;\n                            var $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                            var fmt = formatNumbers({\n                                min: option.availableMin,\n                                max: option.availableMax\n                            }, option.precision);\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>', ' <span class=\\'min\\'>' + i18n.numberWithUnits(fmt.min, option.unit) + '</span> ', $sliderInput = setInputAttrsAndListeners($('<input type=\\'range\\' id=\\'' + id + '\\'>'), function () {\n                                return $numberInput;\n                            }), ' <span class=\\'max\\'>' + i18n.numberWithUnits(fmt.max, option.unit) + '</span> ', $numberInput = setInputAttrsAndListeners($('<input type=\\'number\\' required>'), function () {\n                                return $sliderInput;\n                            }), ' ', $('<button type=\\'button\\'>' + i18n('options-output.reset') + '</button>').click(function () {\n                                $sliderInput.val(option.defaultValue).change();\n                            }));\n                        });\n                        optionClassWriters.set(Option.Array, function (option, writeOption, i18n, generateId) {\n                            var $dragged = null;\n                            var $entries = undefined;\n                            var updateArrayEntries = function () {\n                                option.entries = $entries.children().map(function () {\n                                    return $(this).data('option');\n                                }).get();\n                            };\n                            var writeDraggableOption = function (option) {\n                                // have to make drag handler 'draggable', not the whole item\n                                // because inputs and labels don't like to be inside 'draggable'\n                                // http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\n                                var moveUp = function ($moved) {\n                                    $moved.prev().before($moved);\n                                    updateArrayEntries();\n                                };\n                                var moveDown = function ($moved) {\n                                    $moved.next().after($moved);\n                                    updateArrayEntries();\n                                };\n                                return $('<div class=\\'draggable-with-handle\\'>').data('option', option).append($('<div draggable=\\'true\\' tabindex=\\'0\\' title=\\'' + i18n('options-output.drag') + '\\'>').on('dragstart', function (ev) {\n                                    $dragged = $(this).parent();\n                                    ev.originalEvent.dataTransfer.effectAllowed = 'move';\n                                    ev.originalEvent.dataTransfer.setData('Text', name);\n                                    if (ev.originalEvent.dataTransfer.setDragImage) {\n                                        // doesn't work in IE\n                                        ev.originalEvent.dataTransfer.setDragImage($dragged[0], 0, 0);\n                                    }\n                                    setTimeout(function () {\n                                        $dragged.addClass('ghost');\n                                    }, 0);\n                                }).keydown(function (ev) {\n                                    var $handle = $(this);\n                                    var $sorted = $handle.parent();\n                                    if (ev.keyCode == 38) {\n                                        moveUp($sorted);\n                                        $handle.focus();\n                                        return false;\n                                    } else if (ev.keyCode == 40) {\n                                        moveDown($sorted);\n                                        $handle.focus();\n                                        return false;\n                                    }\n                                }), writeOption(option), $('<div tabindex=\\'0\\' class=\\'delete\\' title=\\'' + i18n('options-output.delete') + '\\'>').click(function () {\n                                    $(this).parent().remove();\n                                    updateArrayEntries();\n                                }).keydown(function (ev) {\n                                    if (ev.keyCode == 13 || ev.keyCode == 32) {\n                                        $(this).parent().remove();\n                                        updateArrayEntries();\n                                        return false;\n                                    }\n                                })).on('dragover', function (ev) {\n                                    ev.preventDefault();\n                                    ev.originalEvent.dataTransfer.dropEffect = 'move';\n                                    var $target = $(this);\n                                    if ($dragged) {\n                                        if ($target.next().is($dragged)) {\n                                            var dh = $dragged.height();\n                                            var y = ev.pageY - $target.offset().top;\n                                            if (y < dh) {\n                                                moveUp($dragged);\n                                            }\n                                        } else if ($target.nextAll().is($dragged)) {\n                                            moveUp($dragged);\n                                        } else if ($target.prev().is($dragged)) {\n                                            var th = $target.height();\n                                            var dh = $dragged.height();\n                                            var y = ev.pageY - $target.offset().top;\n                                            if (y > th - dh) {\n                                                moveDown($dragged);\n                                            }\n                                        } else if ($target.prevAll().is($dragged)) {\n                                            moveDown($dragged);\n                                        }\n                                    }\n                                }).on('drop', function (ev) {\n                                    ev.preventDefault();\n                                }).on('dragend', function (ev) {\n                                    ev.preventDefault();\n                                    if ($dragged) {\n                                        $dragged.removeClass('ghost');\n                                        $dragged = null;\n                                    }\n                                });\n                            };\n                            option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append($entries = $('<div>').append(option.entries.map(writeDraggableOption)));\n                            var $buttons = $('<div>');\n                            option.availableTypes.forEach(function (type, i) {\n                                if (i)\n                                    $buttons.append(' ');\n                                $buttons.append($('<button type=\\'button\\'>').html(i18n('options.' + option.fullName + '.' + type + '.add')).click(function () {\n                                    var entry = option.addEntry(type);\n                                    $entries.append(writeDraggableOption(entry));\n                                }));\n                            });\n                            option.$.append($buttons);\n                            return option.$;\n                        });\n                    };\n                    return OptionsOutput;\n                }();\n                module.exports = OptionsOutput;\n            },\n            {\n                '16': 16,\n                '9': 9\n            }\n        ],\n        19: [\n            function (require, module, exports) {\n                'use strict';\n                var Options = function () {\n                    function Options(data) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, Options);\n                        // data = imported values, import is done in ctor to avoid calling updateCallback later\n                        this.updateCallback = undefined;\n                        // general update callback for stuff like regenerating the code\n                        var simpleUpdateCallback = function () {\n                            if (_this.updateCallback)\n                                _this.updateCallback();\n                        };\n                        var Option = this.optionClasses;\n                        var optionByFullName = {};\n                        var optionsWithVisibilityAffectedByFullName = {};\n                        var makeEntry = function (description, parentfullName, data, isInsideArray) {\n                            var _Option$className;\n                            var className = description[0];\n                            if (Option[className] === undefined) {\n                                throw new Error('invalid option type \\'' + className + '\\'');\n                            }\n                            var name = description[1];\n                            var fullName = name;\n                            if (parentfullName !== null) {\n                                fullName = parentfullName + '.' + name;\n                            }\n                            var makeArgs = description.slice(1);\n                            var updateCallback = undefined;\n                            if (isInsideArray) {\n                                updateCallback = simpleUpdateCallback;\n                            } else {\n                                updateCallback = function () {\n                                    if (optionsWithVisibilityAffectedByFullName[fullName] !== undefined) {\n                                        optionsWithVisibilityAffectedByFullName[fullName].forEach(function (option) {\n                                            option.updateVisibility();\n                                        });\n                                    }\n                                    if (_this.updateCallback)\n                                        _this.updateCallback();\n                                };\n                            }\n                            var option = (_Option$className = Option[className]).make.apply(_Option$className, makeArgs)(data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray);\n                            if (!isInsideArray) {\n                                optionByFullName[fullName] = option;\n                                option.fullNamesAffectingVisibility.forEach(function (testName) {\n                                    if (optionsWithVisibilityAffectedByFullName[testName] === undefined) {\n                                        optionsWithVisibilityAffectedByFullName[testName] = [];\n                                    }\n                                    optionsWithVisibilityAffectedByFullName[testName].push(option);\n                                });\n                            }\n                            return option;\n                        };\n                        this.root = Option.Root.make(null, this.entriesDescription)(data, null, optionByFullName, simpleUpdateCallback, makeEntry, false);\n                    }\n                    // methods to be redefined by subclasses\n                    // TODO make them static?\n                    // public methods\n                    Options.prototype.export = function _export() {\n                        return this.root.shortenExport(this.root.export());\n                    };\n                    Options.prototype.fix = function fix() {\n                        return this.root.fix();\n                    };\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require(16);\n                            }\n                        },\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [];\n                            }\n                        }\n                    ]);\n                    return Options;\n                }();\n                module.exports = Options;\n            },\n            { '16': 16 }\n        ],\n        20: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(7);\n                var Lines = require(14);\n                var RefLines = function (_Lines) {\n                    babelHelpers.inherits(RefLines, _Lines);\n                    function RefLines(data, ref) {\n                        babelHelpers.classCallCheck(this, RefLines);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Lines.call(this, data));\n                        _this.ref = ref;\n                        return _this;\n                    }\n                    RefLines.parse = function parse(s) {\n                        var a = Lines.ba('');\n                        var re = /^(.*?)\\[([^\\]]+)\\]\\[([^\\]]+)\\]/;\n                        for (; s.length > 0;) {\n                            var match = re.exec(s);\n                            if (match) {\n                                a.t(match[1]);\n                                a.t(this.b(match[3]).ae(match[2]));\n                                s = s.substr(match[0].length);\n                            } else {\n                                a.t(s);\n                                break;\n                            }\n                        }\n                        return a.e();\n                    };\n                    RefLines.prototype.doGet = function doGet(formatting, html) {\n                        var plainOut = _Lines.prototype.doGet.call(this, formatting, html);\n                        var href = undefined;\n                        if (html && typeof formatting.refs == 'object') {\n                            href = formatting.refs[this.ref];\n                        }\n                        if (href !== undefined) {\n                            return plainOut.map(function (s) {\n                                return '<a href=\\'' + escape(href) + '\\'>' + s + '</a>';\n                            });\n                        } else {\n                            return plainOut;\n                        }\n                    };\n                    return RefLines;\n                }(Lines);\n                module.exports = RefLines;\n            },\n            {\n                '14': 14,\n                '7': 7\n            }\n        ],\n        21: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '<link rel=stylesheet href=',\n                        '>'\n                    ], [\n                        '<link rel=stylesheet href=',\n                        '>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<script src=',\n                        '></script>'\n                    ], [\n                        '<script src=',\n                        '></script>'\n                    ]), _templateObject3 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<html lang=',\n                        '>'\n                    ], [\n                        '<html lang=',\n                        '>'\n                    ]);\n                var Lines = require(14);\n                var NoseWrapLines = require(15);\n                var CodeSection = require(3);\n                var WebCode = function () {\n                    function WebCode() {\n                        babelHelpers.classCallCheck(this, WebCode);\n                    }\n                    WebCode.prototype.get = function get(formatting) {\n                        return this.getLines().get(formatting);\n                    };\n                    WebCode.prototype.getHtml = function getHtml(formatting) {\n                        return this.getLines().getHtml(formatting);\n                    };\n                    WebCode.prototype.extractSections = function extractSections(sectionModes) {\n                        if (sectionModes === undefined) {\n                            sectionModes = {};\n                        }\n                        var stylePlaceLines = NoseWrapLines.b('<style>', '</style>').ae(this.cachedStyleLines);\n                        var styleExtractLines = Lines.be();\n                        if (sectionModes.css == 'paste') {\n                            if (sectionModes.html == 'body') {\n                                stylePlaceLines = Lines.be();\n                            } else {\n                                stylePlaceLines = Lines.bae('<!-- <style> ' + this.getSectionPasteComment('css') + ' </style> -->');\n                            }\n                            styleExtractLines = this.cachedStyleLines;\n                        } else if (sectionModes.css == 'file') {\n                            stylePlaceLines = Lines.bae(Lines.html(_templateObject, this.basename + '.css'));\n                            styleExtractLines = this.cachedStyleLines;\n                        }\n                        var scriptPlaceLines = NoseWrapLines.b('<script>', '</script>').ae(this.cachedScriptLines);\n                        var scriptExtractLines = Lines.be();\n                        if (sectionModes.js == 'paste') {\n                            if (sectionModes.html == 'body') {\n                                scriptPlaceLines = Lines.be();\n                            } else {\n                                scriptPlaceLines = Lines.bae('<!-- <script> ' + this.getSectionPasteComment('js') + ' </script> -->');\n                            }\n                            scriptExtractLines = this.cachedScriptLines;\n                        } else if (sectionModes.js == 'file') {\n                            scriptPlaceLines = Lines.bae(Lines.html(_templateObject2, this.basename + '.js'));\n                            scriptExtractLines = this.cachedScriptLines;\n                        }\n                        var htmlExtractLines = undefined;\n                        if (sectionModes.html == 'body') {\n                            htmlExtractLines = this.getBodyHtmlSectionLines(stylePlaceLines, scriptPlaceLines);\n                        } else {\n                            htmlExtractLines = this.getFullHtmlSectionLines(stylePlaceLines, scriptPlaceLines);\n                        }\n                        var type = function (sectionName) {\n                            return 'text/' + (sectionName == 'js' ? 'javascript' : sectionName);\n                        };\n                        return {\n                            html: new CodeSection(this.filename, type('html'), htmlExtractLines),\n                            css: new CodeSection(this.basename + '.css', type('css'), styleExtractLines),\n                            js: new CodeSection(this.basename + '.js', type('js'), scriptExtractLines)\n                        };\n                    };\n                    // get title()\n                    // private:\n                    WebCode.prototype.getLines = function getLines() {\n                        return this.getFullHtmlSectionLines(NoseWrapLines.b('<style>', '</style>').ae(this.cachedStyleLines), NoseWrapLines.b('<script>', '</script>').ae(this.cachedScriptLines));\n                    };\n                    WebCode.prototype.getFullHtmlSectionLines = function getFullHtmlSectionLines(stylePlaceLines, scriptPlaceLines) {\n                        var a = Lines.b();\n                        a('<!DOCTYPE html>');\n                        if (this.lang !== null) {\n                            a(Lines.html(_templateObject3, this.lang));\n                        } else {\n                            a('<html>');\n                        }\n                        a('<head>', '<meta charset=utf-8>');\n                        if (this.title !== null) {\n                            a('<title>' + this.title + '</title>');\n                        }\n                        a(stylePlaceLines, this.cachedHeadLines, '</head>', '<body>', this.cachedBodyLines, scriptPlaceLines, '</body>', '</html>');\n                        return a.e();\n                    };\n                    WebCode.prototype.getBodyHtmlSectionLines = function getBodyHtmlSectionLines(stylePlaceLines, scriptPlaceLines) {\n                        return Lines.bae(stylePlaceLines, this.cachedHeadLines, this.cachedBodyLines, scriptPlaceLines);\n                    };\n                    WebCode.prototype.getSectionPasteComment = function getSectionPasteComment(sectionName) {\n                        // section placeholder comment in paste mode - likely to be overridden with i18n\n                        return sectionName + ' goes here';\n                    };\n                    babelHelpers.createClass(WebCode, [\n                        {\n                            key: 'filename',\n                            // public:\n                            get: function () {\n                                return this.basename + '.html';\n                            }\n                        },\n                        {\n                            key: 'mimeType',\n                            get: function () {\n                                return 'text/html';\n                            }\n                        },\n                        {\n                            key: 'cachedStyleLines',\n                            get: function () {\n                                if (!this._styleLines)\n                                    this._styleLines = this.styleLines;\n                                return this._styleLines;\n                            }\n                        },\n                        {\n                            key: 'cachedHeadLines',\n                            get: function () {\n                                if (!this._headLines)\n                                    this._headLines = this.headLines;\n                                return this._headLines;\n                            }\n                        },\n                        {\n                            key: 'cachedBodyLines',\n                            get: function () {\n                                if (!this._bodyLines)\n                                    this._bodyLines = this.bodyLines;\n                                return this._bodyLines;\n                            }\n                        },\n                        {\n                            key: 'cachedScriptLines',\n                            get: function () {\n                                if (!this._scriptLines)\n                                    this._scriptLines = this.scriptLines;\n                                return this._scriptLines;\n                            }    // to be redefined in subclasses:\n                        },\n                        {\n                            key: 'basename',\n                            get: function () {\n                                // filename base\n                                return 'source';\n                            }\n                        },\n                        {\n                            key: 'lang',\n                            get: function () {\n                                // language tag for <html lang=xx> or null to skip it - likely read from i18n\n                                return null;\n                            }\n                        },\n                        {\n                            key: 'title',\n                            get: function () {\n                                // page title or null to skip it\n                                return null;\n                            }\n                        },\n                        {\n                            key: 'styleLines',\n                            get: function () {\n                                // contents of <style>\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'headLines',\n                            get: function () {\n                                // contents of <head> following <style>, goes to <body> in html body mode\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'bodyLines',\n                            get: function () {\n                                // contents of <body> preceding <script>\n                                return Lines.be();\n                            }\n                        },\n                        {\n                            key: 'scriptLines',\n                            get: function () {\n                                // contents of <script>\n                                return Lines.be();\n                            }\n                        }\n                    ]);\n                    return WebCode;\n                }();\n                module.exports = WebCode;\n            },\n            {\n                '14': 14,\n                '15': 15,\n                '3': 3\n            }\n        ],\n        22: [\n            function (require, module, exports) {\n                'use strict';\n                var escape = require(7);\n                var Lines = require(14);\n                var WrapLines = function (_Lines) {\n                    babelHelpers.inherits(WrapLines, _Lines);\n                    function WrapLines(data) {\n                        babelHelpers.classCallCheck(this, WrapLines);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Lines.call(this, data));\n                        _this.wrappers = [];\n                        for (var i = 1; i < arguments.length; i++) {\n                            _this.wrappers.push(arguments[i]);\n                        }\n                        return _this;\n                    }\n                    WrapLines.prototype.isEmpty = function isEmpty() {\n                        return false;\n                    };\n                    WrapLines.prototype.doGet = function doGet(formatting, html) {\n                        var _this2 = this;\n                        var indent = '\\t';\n                        if (formatting.indent !== undefined) {\n                            indent = formatting.indent;\n                        }\n                        var out = [];\n                        var i = 0;\n                        var pushWrapper = function () {\n                            var item = _this2.wrappers[i];\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                out.push.apply(out, subOut);\n                            } else if (typeof item == 'string') {\n                                var s = html ? escape(item) : item;\n                                out.push(s);\n                            }\n                            i++;\n                        };\n                        pushWrapper();\n                        this.data.forEach(function (item) {\n                            if (item instanceof Lines) {\n                                var subOut = item.doGet(formatting, html);\n                                out.push.apply(out, subOut.map(function (s) {\n                                    return indent + s;\n                                }));\n                                if (_this2.wrappers.length != 2) {\n                                    pushWrapper();\n                                }\n                            } else if (typeof item == 'string') {\n                                var s = html ? escape(item) : item;\n                                out.push(indent + s);\n                                if (_this2.wrappers.length != 2) {\n                                    pushWrapper();\n                                }\n                            }\n                        });\n                        if (this.wrappers.length == 2) {\n                            pushWrapper();\n                        }\n                        return out;\n                    };\n                    return WrapLines;\n                }(Lines);\n                module.exports = WrapLines;\n            },\n            {\n                '14': 14,\n                '7': 7\n            }\n        ],\n        23: [\n            function (require, module, exports) {\n                'use strict';\n                var JsLines = require(13);\n                var RefLines = require(20);\n                var Feature = require(29);\n                var AudioContext = function (_Feature) {\n                    babelHelpers.inherits(AudioContext, _Feature);\n                    function AudioContext() {\n                        babelHelpers.classCallCheck(this, AudioContext);\n                        return babelHelpers.possibleConstructorReturn(this, _Feature.apply(this, arguments));\n                    }\n                    AudioContext.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var a = JsLines.b();\n                        if (featureContext.audioContext) {\n                            a(RefLines.parse('// ' + i18n('comment.context')), 'var ctx=new (AudioContext || webkitAudioContext);');\n                        }\n                        return a.e();\n                    };\n                    return AudioContext;\n                }(Feature);\n                module.exports = AudioContext;\n            },\n            {\n                '13': 13,\n                '20': 20,\n                '29': 29\n            }\n        ],\n        24: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                    '\\t<canvas id=my.canvas width=',\n                    ' height=',\n                    '></canvas>'\n                ], [\n                    '\\t<canvas id=my.canvas width=',\n                    ' height=',\n                    '></canvas>'\n                ]);\n                var Lines = require(14);\n                var JsLines = require(13);\n                var Feature = require(29);\n                var Canvas = function (_Feature) {\n                    babelHelpers.inherits(Canvas, _Feature);\n                    function Canvas(options) {\n                        babelHelpers.classCallCheck(this, Canvas);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.options = options;\n                        return _this;\n                    }\n                    Canvas.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        var a = Lines.b();\n                        if (featureContext.canvas) {\n                            a('<div>', Lines.html(_templateObject, this.options.width, this.options.height), '</div>');\n                        }\n                        return a.e();\n                    };\n                    Canvas.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var a = JsLines.b();\n                        if (featureContext.canvas) {\n                            a('var canvas=document.getElementById(\\'my.canvas\\');', 'var canvasContext=canvas.getContext(\\'2d\\');');\n                        }\n                        return a.e();\n                    };\n                    Canvas.prototype.getJsLoopPreLines = function getJsLoopPreLines(featureContext, i18n) {\n                        var a = JsLines.b();\n                        var writeStyle = function (canvasContextProperty, colorOption) {\n                            var cs = [\n                                'r',\n                                'g',\n                                'b'\n                            ];\n                            var color = cs.map(function (c) {\n                                return colorOption[c] + '%';\n                            }).join();\n                            var isBlack = cs.every(function (c) {\n                                return colorOption[c] == 0;\n                            });\n                            if (colorOption.a == 100) {\n                                if (!isBlack) {\n                                    a('canvasContext.' + canvasContextProperty + '=\\'rgb(' + color + ')\\';');\n                                }\n                            } else {\n                                a('canvasContext.' + canvasContextProperty + '=\\'rgba(' + color + ',' + (colorOption.a / 100).toFixed(2) + ')\\';');\n                            }\n                        };\n                        if (featureContext.canvas) {\n                            if (this.options.background.type == 'clear') {\n                                a('canvasContext.clearRect(0,0,canvas.width,canvas.height);');\n                            } else {\n                                writeStyle('fillStyle', this.options.background.color);\n                                a('canvasContext.fillRect(0,0,canvas.width,canvas.height);');\n                            }\n                            if (this.options.line.width != 1) {\n                                a('canvasContext.lineWidth=' + this.options.line.width + ';');\n                            }\n                            writeStyle('strokeStyle', this.options.line.color);\n                        }\n                        return a.e();\n                    };\n                    return Canvas;\n                }(Feature);\n                module.exports = Canvas;\n            },\n            {\n                '13': 13,\n                '14': 14,\n                '29': 29\n            }\n        ],\n        25: [\n            function (require, module, exports) {\n                'use strict';\n                var BaseCodeOutput = require(2);\n                var CodeOutput = function (_BaseCodeOutput) {\n                    babelHelpers.inherits(CodeOutput, _BaseCodeOutput);\n                    function CodeOutput() {\n                        babelHelpers.classCallCheck(this, CodeOutput);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseCodeOutput.apply(this, arguments));\n                    }\n                    CodeOutput.prototype.writeButtons = function writeButtons(getCode, getFormatting, i18n) {\n                        return _BaseCodeOutput.prototype.writeButtons.call(this, getCode, getFormatting, i18n).append(' <span class=\\'tip-warn\\'><span class=\\'tip-content\\'>' + i18n('code-output.warning.jsfiddle-run') + '</span></span>');\n                    };\n                    babelHelpers.createClass(CodeOutput, [{\n                            key: 'refs',\n                            get: function () {\n                                return {\n                                    context: 'https://www.w3.org/TR/webaudio/#AudioContext',\n                                    source: 'https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode',\n                                    gain: 'https://www.w3.org/TR/webaudio/#GainNode',\n                                    panner: 'https://www.w3.org/TR/webaudio/#the-stereopannernode-interface',\n                                    biquad: 'https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface',\n                                    convolver: 'https://www.w3.org/TR/webaudio/#ConvolverNode',\n                                    peaking: 'https://www.w3.org/TR/webaudio/#idl-def-BiquadFilterType.peaking',\n                                    destination: 'https://www.w3.org/TR/webaudio/#AudioDestinationNode',\n                                    compressor: 'https://www.w3.org/TR/webaudio/#the-dynamicscompressornode-interface',\n                                    analyser: 'https://www.w3.org/TR/webaudio/#the-analysernode-interface'\n                                };\n                            }\n                        }]);\n                    return CodeOutput;\n                }(BaseCodeOutput);\n                module.exports = CodeOutput;\n            },\n            { '2': 2 }\n        ],\n        26: [\n            function (require, module, exports) {\n                'use strict';\n                var AudioContext = require(23);\n                var SourceSet = require(36);\n                var FilterSequence = require(30);\n                var Destination = require(28);\n                var Canvas = require(24);\n                var Lines = require(14);\n                var JsLines = require(13);\n                var InterleaveLines = require(12);\n                var NoseWrapLines = require(15);\n                var BaseWebCode = require(21);\n                var Code = function (_BaseWebCode) {\n                    babelHelpers.inherits(Code, _BaseWebCode);\n                    function Code(options, i18n) {\n                        babelHelpers.classCallCheck(this, Code);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _BaseWebCode.call(this));\n                        _this.i18n = i18n;\n                        _this.featureContext = {};\n                        _this.features = [\n                            new AudioContext(),\n                            new SourceSet(options.sources),\n                            new FilterSequence(options.filters),\n                            new Destination(options.destination),\n                            new Canvas(options.canvas)\n                        ];\n                        _this.features.forEach(function (feature) {\n                            feature.requestFeatureContext(_this.featureContext);\n                        });\n                        return _this;\n                    }\n                    babelHelpers.createClass(Code, [\n                        {\n                            key: 'basename',\n                            get: function () {\n                                return 'webaudio';\n                            }\n                        },\n                        {\n                            key: 'lang',\n                            get: function () {\n                                return this.i18n.lang;\n                            }\n                        },\n                        {\n                            key: 'title',\n                            get: function () {\n                                return this.i18n('code.title');\n                            }\n                        },\n                        {\n                            key: 'styleLines',\n                            get: function () {\n                                var a = Lines.b();\n                                if (this.featureContext.alignedInputs) {\n                                    a('label {', '\\tdisplay: inline-block;', '\\twidth: 15em;', '\\ttext-align: right;', '\\tline-height: 0.8em;', '}', '.min {', '\\tdisplay: inline-block;', '\\twidth: 5em;', '\\ttext-align: right;', '}', '.max {', '\\tdisplay: inline-block;', '\\twidth: 5em;', '\\ttext-align: left;', '}');\n                                }\n                                if (this.featureContext.canvas) {\n                                    a('canvas {', '\\tborder: 1px solid;', '}');\n                                }\n                                return a.e();\n                            }\n                        },\n                        {\n                            key: 'bodyLines',\n                            get: function () {\n                                var _this2 = this;\n                                return Lines.bae.apply(Lines, this.features.map(function (feature) {\n                                    return feature.getHtmlLines(_this2.featureContext, _this2.i18n);\n                                }));\n                            }\n                        },\n                        {\n                            key: 'scriptLines',\n                            get: function () {\n                                var _this3 = this, _NoseWrapLines$b;\n                                var prevNodeJsNames = undefined;\n                                return InterleaveLines.bae.apply(InterleaveLines, this.features.map(function (feature) {\n                                    var lines = feature.getJsInitLines(_this3.featureContext, _this3.i18n, prevNodeJsNames);\n                                    prevNodeJsNames = feature.getNodeJsNames(_this3.featureContext, prevNodeJsNames);\n                                    return lines;\n                                }).concat([(_NoseWrapLines$b = NoseWrapLines.b(JsLines.bae('function visualize() {'), JsLines.bae('\\trequestAnimationFrame(visualize);', '}', 'requestAnimationFrame(visualize);'))).ae.apply(_NoseWrapLines$b, this.features.map(function (feature) {\n                                        return feature.getJsLoopPreLines(_this3.featureContext, _this3.i18n);\n                                    }).concat(this.features.map(function (feature) {\n                                        return feature.getJsLoopVisLines(_this3.featureContext, _this3.i18n);\n                                    })))]));\n                            }\n                        }\n                    ]);\n                    return Code;\n                }(BaseWebCode);\n                module.exports = Code;\n            },\n            {\n                '12': 12,\n                '13': 13,\n                '14': 14,\n                '15': 15,\n                '21': 21,\n                '23': 23,\n                '24': 24,\n                '28': 28,\n                '30': 30,\n                '36': 36\n            }\n        ],\n        27: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(14);\n                var Feature = require(29);\n                var CollectionFeature = function (_Feature) {\n                    babelHelpers.inherits(CollectionFeature, _Feature);\n                    function CollectionFeature(entryOptions) {\n                        babelHelpers.classCallCheck(this, CollectionFeature);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        var entryCounts = new Map();\n                        entryOptions.entries.forEach(function (entryOption) {\n                            var entryClass = _this.getEntryClass(entryOption);\n                            entryCounts.set(entryClass, entryCounts.get(entryClass) + 1 || 1);\n                        });\n                        var entryCounts2 = new Map();\n                        _this.entries = entryOptions.entries.map(function (entryOption) {\n                            var entryClass = _this.getEntryClass(entryOption);\n                            if (entryCounts.get(entryClass) > 1) {\n                                var n = entryCounts2.get(entryClass) || 0;\n                                entryCounts2.set(entryClass, n + 1);\n                                return new entryClass(entryOption, n);\n                            } else {\n                                return new entryClass(entryOption);\n                            }\n                        });\n                        return _this;\n                    }\n                    CollectionFeature.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        return Lines.bae.apply(Lines, this.entries.map(function (entry) {\n                            return entry.getHtmlLines(featureContext, i18n);\n                        }));\n                    };\n                    // abstract:\n                    // getEntryClass(entryOption) {}\n                    return CollectionFeature;\n                }(Feature);\n                module.exports = CollectionFeature;\n            },\n            {\n                '14': 14,\n                '29': 29\n            }\n        ],\n        28: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                    '<label for=my.compressor>',\n                    '</label>'\n                ], [\n                    '<label for=my.compressor>',\n                    '</label>'\n                ]);\n                var Lines = require(14);\n                var JsLines = require(13);\n                var NoseWrapLines = require(15);\n                var RefLines = require(20);\n                var Feature = require(29);\n                var Destination = function (_Feature) {\n                    babelHelpers.inherits(Destination, _Feature);\n                    function Destination(options) {\n                        babelHelpers.classCallCheck(this, Destination);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.options = options;\n                        return _this;\n                    }\n                    Destination.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        if (!featureContext.audioProcessing)\n                            return;\n                        if (this.options.compressor || this.options.waveform) {\n                            featureContext.audioContext = true;\n                        }\n                        if (this.options.waveform) {\n                            featureContext.canvas = true;\n                        }\n                    };\n                    Destination.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        var a = NoseWrapLines.b('<div>', '</div>');\n                        if (featureContext.audioProcessing && this.options.compressor) {\n                            a('<input id=my.compressor type=checkbox checked>', Lines.html(_templateObject, i18n('options.destination.compressor.enable')));\n                        }\n                        return a.e();\n                    };\n                    Destination.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var _this2 = this;\n                        var a = JsLines.b();\n                        if (featureContext.audioProcessing && featureContext.audioContext) {\n                            if (this.options.compressor) {\n                                (function () {\n                                    var nextNodeJsName = _this2.options.waveform ? 'analyserNode' : 'ctx.destination';\n                                    a.apply(undefined, [\n                                        RefLines.parse('// ' + i18n('comment.destination.compressor')),\n                                        'var compressorNode=ctx.createDynamicsCompressor();'\n                                    ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                        return prevNodeJsName + '.connect(compressorNode);';\n                                    })));\n                                    if (prevNodeJsNames.length > 0) {\n                                        a.apply(undefined, [\n                                            'document.getElementById(\\'my.compressor\\').onchange=function(){',\n                                            '\\tif (this.checked) {'\n                                        ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.disconnect(' + nextNodeJsName + ');';\n                                        }), prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.connect(compressorNode);';\n                                        }), ['\\t} else {'], prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.disconnect(compressorNode);';\n                                        }), prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.connect(' + nextNodeJsName + ');';\n                                        }), [\n                                            '\\t}',\n                                            '};',\n                                            ''\n                                        ]));\n                                    }\n                                    prevNodeJsNames = ['compressorNode'];\n                                }());\n                            }\n                            if (this.options.waveform) {\n                                a.apply(undefined, [\n                                    RefLines.parse('// ' + i18n('comment.destination.waveform')),\n                                    'var analyserNode=ctx.createAnalyser();'\n                                ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                    return prevNodeJsName + '.connect(analyserNode);';\n                                }), [\n                                    'analyserNode.fftSize=1024;',\n                                    'var analyserData=new Uint8Array(analyserNode.frequencyBinCount);',\n                                    ''\n                                ]));\n                                prevNodeJsNames = ['analyserNode'];\n                            }\n                            a.apply(undefined, [RefLines.parse('// ' + i18n('comment.destination'))].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                return prevNodeJsName + '.connect(ctx.destination);';\n                            })));\n                        }\n                        return a.e();\n                    };\n                    Destination.prototype.getJsLoopVisLines = function getJsLoopVisLines(featureContext, i18n) {\n                        var a = JsLines.b();\n                        if (featureContext.audioProcessing && this.options.waveform) {\n                            a('analyserNode.getByteTimeDomainData(analyserData);', 'canvasContext.beginPath();', 'for (var i=0;i<analyserData.length;i++) {', '\\tvar x=i*canvas.width/analyserData.length;', '\\tvar y=analyserData[i]*canvas.height/255;', '\\tif (i==0) {', '\\t\\tcanvasContext.moveTo(x,y);', '\\t} else {', '\\t\\tcanvasContext.lineTo(x,y);', '\\t}', '}', 'canvasContext.stroke();');\n                        }\n                        return a.e();\n                    };\n                    Destination.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        if (!featureContext.audioProcessing)\n                            return prevNodeJsNames;\n                        if (featureContext.audioContext) {\n                            return ['ctx.destination'];\n                        } else {\n                            return prevNodeJsNames;\n                        }\n                    };\n                    return Destination;\n                }(Feature);\n                module.exports = Destination;\n            },\n            {\n                '13': 13,\n                '14': 14,\n                '15': 15,\n                '20': 20,\n                '29': 29\n            }\n        ],\n        29: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require(14);\n                var Feature = function () {\n                    function Feature() {\n                        babelHelpers.classCallCheck(this, Feature);\n                    }\n                    Feature.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                    };\n                    Feature.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        return Lines.be();\n                    };\n                    Feature.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        return Lines.be();\n                    };\n                    Feature.prototype.getJsLoopPreLines = function getJsLoopPreLines(featureContext, i18n) {\n                        return Lines.be();\n                    };\n                    Feature.prototype.getJsLoopVisLines = function getJsLoopVisLines(featureContext, i18n) {\n                        return Lines.be();\n                    };\n                    Feature.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        return prevNodeJsNames;\n                    };\n                    return Feature;\n                }();\n                module.exports = Feature;\n            },\n            { '14': 14 }\n        ],\n        30: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '<abbr title=',\n                        '>'\n                    ], [\n                        '<abbr title=',\n                        '>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<label for=',\n                        '>',\n                        ':</label>'\n                    ], [\n                        '<label for=',\n                        '>',\n                        ':</label>'\n                    ]), _templateObject3 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<input id=',\n                        ' type=range value=',\n                        ' min=',\n                        ' max=',\n                        ' step=',\n                        '>'\n                    ], [\n                        '<input id=',\n                        ' type=range value=',\n                        ' min=',\n                        ' max=',\n                        ' step=',\n                        '>'\n                    ]), _templateObject4 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<select id=',\n                        '>'\n                    ], [\n                        '<select id=',\n                        '>'\n                    ]), _templateObject5 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<option selected=',\n                        ' value=',\n                        '>',\n                        '</option>'\n                    ], [\n                        '<option selected=',\n                        ' value=',\n                        '>',\n                        '</option>'\n                    ]), _templateObject6 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<span id=',\n                        '>',\n                        '</span>'\n                    ], [\n                        '<span id=',\n                        '>',\n                        '</span>'\n                    ]);\n                var camelCase = require(4);\n                var formatNumbers = require(9);\n                var Lines = require(14);\n                var JsLines = require(13);\n                var WrapLines = require(22);\n                var NoseWrapLines = require(15);\n                var InterleaveLines = require(12);\n                var RefLines = require(20);\n                var CollectionFeature = require(27);\n                var Filter = function () {\n                    function Filter(options, n) {\n                        babelHelpers.classCallCheck(this, Filter);\n                        this.options = options;\n                        this.n = n;\n                    }\n                    Filter.prototype.getPropertyOptionName = function getPropertyOptionName(property) {\n                        return 'options.filters.' + this.type + '.' + property.name;\n                    };\n                    Filter.prototype.getPropertyInputHtmlName = function getPropertyInputHtmlName(propertyName) {\n                        return 'my.' + this.type + this.nSuffix + '.' + propertyName;\n                    };\n                    Filter.prototype.getPropertyInputJsName = function getPropertyInputJsName(propertyName) {\n                        return camelCase(this.type + this.nSuffix + '.' + propertyName + '.input');\n                    };\n                    Filter.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        var _this = this;\n                        var hasRangeInputs = this.nodeProperties.some(function (property) {\n                            if (property.type == 'range') {\n                                var option = _this.options[property.name];\n                                return option.input;\n                            } else {\n                                return false;\n                            }\n                        });\n                        if (hasRangeInputs) {\n                            featureContext.alignedInputs = true;\n                        }\n                    };\n                    Filter.prototype.getHtmlPropertyLines = function getHtmlPropertyLines(i18n, property) {\n                        var _this2 = this;\n                        var option = this.options[property.name];\n                        var inputHtmlName = this.getPropertyInputHtmlName(property.name);\n                        var a = Lines.b();\n                        if (property.type == 'range' && option.input) {\n                            var p = option.precision;\n                            var fmtAttrs = formatNumbers.html({\n                                min: option.min,\n                                max: option.max,\n                                value: option.value\n                            }, p);\n                            var fmtLabels = formatNumbers({\n                                min: option.min,\n                                max: option.max\n                            }, p);\n                            var minMax = function (n) {\n                                return i18n.numberWithUnits(n, option.unit, function (a, e) {\n                                    return Lines.html(_templateObject, e) + a + '</abbr>';\n                                });\n                            };\n                            a(Lines.html(_templateObject2, inputHtmlName, i18n(this.getPropertyOptionName(property))), '<span class=min>' + minMax(fmtLabels.min) + '</span>', Lines.html(_templateObject3, inputHtmlName, fmtAttrs.value, fmtAttrs.min, fmtAttrs.max, p ? Math.pow(0.1, p).toFixed(p) : false), '<span class=max>' + minMax(fmtLabels.max) + '</span>');\n                        } else if (property.type == 'select' && option.input) {\n                            var _WrapLines$b;\n                            a(Lines.html(_templateObject2, inputHtmlName, i18n(this.getPropertyOptionName(property))), (_WrapLines$b = WrapLines.b(Lines.html(_templateObject4, inputHtmlName), '</select>')).ae.apply(_WrapLines$b, option.availableValues.map(function (value) {\n                                var title = i18n(_this2.getPropertyOptionName(property) + '.' + value);\n                                return Lines.html(_templateObject5, option.value == value, value != title && value, title);\n                            })));\n                        } else if (property.type == 'xhr') {\n                            a(Lines.html(_templateObject6, inputHtmlName, i18n(this.getPropertyOptionName(property) + '.loading')));\n                        }\n                        return a.e();\n                    };\n                    // { not called if skipNode is set\n                    Filter.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        var _this3 = this;\n                        return Lines.bae.apply(Lines, this.nodeProperties.map(function (property) {\n                            return NoseWrapLines.b('<div>', '</div>').ae(_this3.getHtmlPropertyLines(i18n, property));\n                        }));\n                    };\n                    Filter.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                        var _this4 = this;\n                        return JsLines.bae.apply(JsLines, [\n                            RefLines.parse('// ' + i18n('comment.filters.' + this.type)),\n                            'var ' + this.nodeJsName + '=ctx.' + this.ctxCreateMethodName + '();'\n                        ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                            return prevNodeJsName + '.connect(' + _this4.nodeJsName + ');';\n                        })));\n                    };\n                    babelHelpers.createClass(Filter, [\n                        {\n                            key: 'nSuffix',\n                            get: function () {\n                                if (this.n !== undefined) {\n                                    return '.' + this.n;\n                                } else {\n                                    return '';\n                                }\n                            }\n                        },\n                        {\n                            key: 'nodeJsName',\n                            get: function () {\n                                return camelCase(this.type + this.nSuffix + '.node');\n                            }\n                        },\n                        {\n                            key: 'skipNode',\n                            get: function () {\n                                return false;\n                            }\n                        },\n                        {\n                            key: 'nodeJsNames',\n                            get: function () {\n                                return [this.nodeJsName];\n                            }    // }\n                                 // abstract:\n                                 // get type()\n                                 // get ctxCreateMethodName()\n                                 // get nodeProperties()\n                        }\n                    ]);\n                    return Filter;\n                }();\n                var SinglePathFilter = function (_Filter) {\n                    babelHelpers.inherits(SinglePathFilter, _Filter);\n                    function SinglePathFilter() {\n                        babelHelpers.classCallCheck(this, SinglePathFilter);\n                        return babelHelpers.possibleConstructorReturn(this, _Filter.apply(this, arguments));\n                    }\n                    SinglePathFilter.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                        var _this6 = this;\n                        return Lines.bae.apply(Lines, [_Filter.prototype.getJsInitLines.call(this, i18n, prevNodeJsNames)].concat(this.nodeProperties.map(function (property) {\n                            var option = _this6.options[property.name];\n                            var nodePropertyJsName = _this6.nodeJsName + '.' + property.name + (property.type == 'range' ? '.value' : '');\n                            var a = JsLines.b();\n                            if (option.input) {\n                                var inputJsName = _this6.getPropertyInputJsName(property.name);\n                                var inputHtmlName = _this6.getPropertyInputHtmlName(property.name);\n                                var value = inputJsName + '.value';\n                                if (property.fn) {\n                                    value = property.fn(value);\n                                }\n                                var eventProp = property.type == 'range' ? 'oninput' : 'onchange';\n                                a('var ' + inputJsName + '=document.getElementById(\\'' + inputHtmlName + '\\');', // was for IE11 compat (but IE11 has no Web Audio): (property.type=='range'?inputJsName+\".oninput=\":\"\")+inputJsName+\".onchange=function(){\",\n                                ';(' + inputJsName + '.' + eventProp + '=function(){', '\\t' + nodePropertyJsName + '=' + value + ';', '})();');\n                            } else if (option.value != option.defaultValue) {\n                                var value = option.value;\n                                if (property.type == 'select') {\n                                    value = '\\'' + value + '\\'';\n                                }\n                                if (property.fn) {\n                                    value = property.fn(value);\n                                }\n                                a(nodePropertyJsName + '=' + value + ';');\n                            }\n                            return a.e();\n                        })));\n                    };\n                    return SinglePathFilter;\n                }(Filter);\n                var PassiveByDefaultSinglePathFilter = function (_SinglePathFilter) {\n                    babelHelpers.inherits(PassiveByDefaultSinglePathFilter, _SinglePathFilter);\n                    function PassiveByDefaultSinglePathFilter() {\n                        babelHelpers.classCallCheck(this, PassiveByDefaultSinglePathFilter);\n                        return babelHelpers.possibleConstructorReturn(this, _SinglePathFilter.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(PassiveByDefaultSinglePathFilter, [{\n                            key: 'skipNode',\n                            get: function () {\n                                var _this8 = this;\n                                return this.nodeProperties.every(function (property) {\n                                    var option = _this8.options[property.name];\n                                    return option.value == option.defaultValue && !option.input;\n                                });\n                            }\n                        }]);\n                    return PassiveByDefaultSinglePathFilter;\n                }(SinglePathFilter);\n                var filterClasses = {\n                    gain: function (_PassiveByDefaultSing) {\n                        babelHelpers.inherits(gain, _PassiveByDefaultSing);\n                        function gain() {\n                            babelHelpers.classCallCheck(this, gain);\n                            return babelHelpers.possibleConstructorReturn(this, _PassiveByDefaultSing.apply(this, arguments));\n                        }\n                        babelHelpers.createClass(gain, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'gain';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createGain';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [{\n                                            name: 'gain',\n                                            type: 'range'\n                                        }];\n                                }\n                            }\n                        ]);\n                        return gain;\n                    }(PassiveByDefaultSinglePathFilter),\n                    panner: function (_PassiveByDefaultSing2) {\n                        babelHelpers.inherits(panner, _PassiveByDefaultSing2);\n                        function panner() {\n                            babelHelpers.classCallCheck(this, panner);\n                            return babelHelpers.possibleConstructorReturn(this, _PassiveByDefaultSing2.apply(this, arguments));\n                        }\n                        babelHelpers.createClass(panner, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'panner';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createStereoPanner';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [{\n                                            name: 'pan',\n                                            type: 'range'\n                                        }];\n                                }\n                            }\n                        ]);\n                        return panner;\n                    }(PassiveByDefaultSinglePathFilter),\n                    biquad: function (_SinglePathFilter2) {\n                        babelHelpers.inherits(biquad, _SinglePathFilter2);\n                        function biquad() {\n                            babelHelpers.classCallCheck(this, biquad);\n                            return babelHelpers.possibleConstructorReturn(this, _SinglePathFilter2.apply(this, arguments));\n                        }\n                        babelHelpers.createClass(biquad, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'biquad';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createBiquadFilter';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [\n                                        {\n                                            name: 'type',\n                                            type: 'select'\n                                        },\n                                        {\n                                            name: 'frequency',\n                                            type: 'range'\n                                        },\n                                        {\n                                            name: 'Q',\n                                            type: 'range',\n                                            fn: function (x) {\n                                                return 'Math.pow(10,' + x + ')';\n                                            }\n                                        },\n                                        {\n                                            name: 'gain',\n                                            type: 'range'\n                                        },\n                                        {\n                                            name: 'detune',\n                                            type: 'range'\n                                        }\n                                    ];\n                                }\n                            },\n                            {\n                                key: 'skipNode',\n                                get: function () {\n                                    // lowshelf, highshelf and peaking are passive when gain==0\n                                    return !this.options.type.input && [\n                                        'lowshelf',\n                                        'highshelf',\n                                        'peaking'\n                                    ].indexOf(this.options.type.value) >= 0 && !this.options.gain.input && this.options.gain == 0;\n                                }\n                            }\n                        ]);\n                        return biquad;\n                    }(SinglePathFilter),\n                    convolver: function (_Filter2) {\n                        babelHelpers.inherits(convolver, _Filter2);\n                        function convolver() {\n                            babelHelpers.classCallCheck(this, convolver);\n                            return babelHelpers.possibleConstructorReturn(this, _Filter2.apply(this, arguments));\n                        }\n                        convolver.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                            var _this13 = this;\n                            var messageHtmlName = this.getPropertyInputHtmlName('buffer');\n                            var a = JsLines.b();\n                            if (this.options.reverb.input || this.options.reverb != 1) {\n                                a(RefLines.parse('// ' + i18n('comment.filters.' + this.type)));\n                            } else {\n                                a(RefLines.parse('// ' + i18n('comment.filters.' + this.type + '.single')));\n                            }\n                            a.apply(undefined, ['var ' + this.nodeJsName + '=ctx.' + this.ctxCreateMethodName + '();'].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                return prevNodeJsName + '.connect(' + _this13.nodeJsName + ');';\n                            })));\n                            if (this.options.reverb.input || this.options.reverb != 1) {\n                                a.apply(undefined, [\n                                    'var ' + this.wetGainNodeJsName + '=ctx.createGain();',\n                                    this.nodeJsName + '.connect(' + this.wetGainNodeJsName + ');',\n                                    'var ' + this.dryGainNodeJsName + '=ctx.createGain();'\n                                ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                    return prevNodeJsName + '.connect(' + _this13.dryGainNodeJsName + ');';\n                                })));\n                                if (this.options.reverb.input) {\n                                    var inputHtmlName = this.getPropertyInputHtmlName('reverb');\n                                    var inputJsName = this.getPropertyInputJsName('reverb');\n                                    a('var ' + inputJsName + '=document.getElementById(\\'' + inputHtmlName + '\\');', ';(' + inputJsName + '.oninput=function(){', '\\t' + this.wetGainNodeJsName + '.gain.value=' + inputJsName + '.value;', '\\t' + this.dryGainNodeJsName + '.gain.value=1-' + inputJsName + '.value;', '})();');\n                                }\n                            }\n                            a('var xhr=new XMLHttpRequest();', 'xhr.open(\\'GET\\',\\'' + this.options.url + '\\');', // TODO html escape\n                            'xhr.responseType=\\'arraybuffer\\';', 'xhr.onload=function(){', '\\tif (this.status==200) {', // TODO we are checking status here, but what if <audio>'s status is an error?\n                            '\\t\\tctx.decodeAudioData(this.response,function(buffer){', '\\t\\t\\t' + this.nodeJsName + '.buffer=buffer;', '\\t\\t\\tdocument.getElementById(\\'' + messageHtmlName + '\\').textContent=\\'\\';', '\\t\\t});', '\\t} else {', '\\t\\tthis.onerror();', '\\t}', '};', 'xhr.onerror=function(){', '\\tdocument.getElementById(\\'' + messageHtmlName + '\\').textContent=\\'' + i18n('options.filters.convolver.buffer.error') + '\\';', '};', 'xhr.send();');\n                            return a.e();\n                        };\n                        babelHelpers.createClass(convolver, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'convolver';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createConvolver';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [\n                                        {\n                                            name: 'reverb',\n                                            type: 'range'\n                                        },\n                                        {\n                                            name: 'buffer',\n                                            type: 'xhr'\n                                        }\n                                    ];\n                                }\n                            },\n                            {\n                                key: 'dryGainNodeJsName',\n                                get: function () {\n                                    return camelCase(this.type + this.nSuffix + '.dry.gain.node');\n                                }\n                            },\n                            {\n                                key: 'wetGainNodeJsName',\n                                get: function () {\n                                    return camelCase(this.type + this.nSuffix + '.wet.gain.node');\n                                }\n                            },\n                            {\n                                key: 'skipNode',\n                                get: function () {\n                                    return this.options.reverb == 0 && !this.options.reverb.input;\n                                }\n                            },\n                            {\n                                key: 'nodeJsNames',\n                                get: function () {\n                                    if (this.options.reverb.input || this.options.reverb != 1) {\n                                        return [\n                                            this.wetGainNodeJsName,\n                                            this.dryGainNodeJsName\n                                        ];\n                                    } else {\n                                        return [this.nodeJsName];\n                                    }\n                                }\n                            }\n                        ]);\n                        return convolver;\n                    }(Filter),\n                    equalizer: function (_Filter3) {\n                        babelHelpers.inherits(equalizer, _Filter3);\n                        function equalizer() {\n                            babelHelpers.classCallCheck(this, equalizer);\n                            return babelHelpers.possibleConstructorReturn(this, _Filter3.apply(this, arguments));\n                        }\n                        equalizer.prototype.getFrequencyOption = function getFrequencyOption(i) {\n                            return this.options[this.nodeProperties[i].name];\n                        };\n                        equalizer.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                            if (!this.allGainsConstant) {\n                                featureContext.alignedInputs = true;\n                            }\n                        };\n                        equalizer.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                            var _this15 = this;\n                            var singleFreq = this.affectedFreqsAndOptions.length == 1;\n                            var allGainsConstant = this.affectedFreqsAndOptions.every(function (fo) {\n                                return fo.option.input == false;\n                            });\n                            var noGainsConstant = this.affectedFreqsAndOptions.every(function (fo) {\n                                return fo.option.input == true;\n                            });\n                            var getJsData = function () {\n                                return _this15.affectedFreqsAndOptions.map(function (fo) {\n                                    if (noGainsConstant) {\n                                        return fo.freq;\n                                    } else {\n                                        return '[' + fo.freq + ',' + (fo.option.input ? 'null' : fo.option.value) + ']';\n                                    }\n                                }).join();\n                            };\n                            var getJsDataItem = function () {\n                                if (noGainsConstant) {\n                                    return 'freq';\n                                } else {\n                                    return 'freqData';\n                                }\n                            };\n                            var getJsLoopLines = function () {\n                                var freq = singleFreq ? _this15.affectedFreqsAndOptions[0].freq : 'freq';\n                                var gain = singleFreq ? _this15.affectedFreqsAndOptions[0].option.value : 'gain';\n                                var nodeJsName = allGainsConstant || singleFreq ? _this15.nodeJsName : 'node';\n                                var inputJsName = singleFreq ? _this15.getPropertyInputJsName('gain' + freq) : 'input';\n                                var inputHtmlNameExpr = singleFreq ? '\\'' + _this15.getPropertyInputHtmlName('gain' + freq) + '\\'' : '\\'' + _this15.getPropertyInputHtmlName('gain') + '\\'+freq';\n                                var a = JsLines.b();\n                                if (!(noGainsConstant || singleFreq)) {\n                                    a('var freq=freqData[0], gain=freqData[1];');\n                                }\n                                if (allGainsConstant && !singleFreq) {\n                                    a('');\n                                } else {\n                                    a('var ');\n                                }\n                                a.t(nodeJsName + '=ctx.' + _this15.ctxCreateMethodName + '();');\n                                if (singleFreq) {\n                                    a.apply(undefined, prevNodeJsNames.map(function (prevNodeJsName) {\n                                        return prevNodeJsName + '.connect(' + nodeJsName + ');';\n                                    }));\n                                } else {\n                                    if (prevNodeJsNames.length == 1) {\n                                        a('prevNode.connect(' + nodeJsName + ');');\n                                    } else {\n                                        a('prevNodes.forEach(function(prevNode){', '\\tprevNode.connect(' + nodeJsName + ');', '});');\n                                    }\n                                }\n                                a(nodeJsName + '.type=\\'peaking\\';', nodeJsName + '.frequency.value=' + freq + ';');\n                                var constLines = JsLines.bae(nodeJsName + '.gain.value=' + gain + ';');\n                                var varLines = JsLines.bae('var ' + inputJsName + '=document.getElementById(' + inputHtmlNameExpr + ');', ';(' + inputJsName + '.oninput=function(){', '\\t' + nodeJsName + '.gain.value=' + inputJsName + '.value;', '})();');\n                                if (!noGainsConstant && allGainsConstant) {\n                                    a(constLines);\n                                } else if (noGainsConstant && !allGainsConstant) {\n                                    a(varLines);\n                                } else if (!noGainsConstant && !allGainsConstant) {\n                                    a(WrapLines.b('if (gain!==null) {', '} else {', '}').ae(constLines, varLines));\n                                }\n                                if (!singleFreq) {\n                                    var outerNodeJsName = allGainsConstant ? nodeJsName : _this15.nodeJsName + '=' + nodeJsName;\n                                    if (prevNodeJsNames.length == 1) {\n                                        a('prevNode=' + outerNodeJsName + ';');\n                                    } else {\n                                        a('prevNodes=[' + outerNodeJsName + '];');\n                                    }\n                                }\n                                return a.e();\n                            };\n                            if (singleFreq) {\n                                return JsLines.bae(RefLines.parse('// ' + i18n('comment.filters.' + this.type + '.single')), getJsLoopLines());\n                            } else {\n                                var a = JsLines.b();\n                                a(RefLines.parse('// ' + i18n('comment.filters.' + this.type)));\n                                if (prevNodeJsNames.length == 1) {\n                                    a('var prevNode=' + prevNodeJsNames[0] + ';');\n                                } else {\n                                    a('var prevNodes=[' + prevNodeJsNames.join() + '];');\n                                }\n                                a('var ' + this.nodeJsName + ';', WrapLines.b(JsLines.bae(';[' + getJsData() + '].forEach(function(' + getJsDataItem() + '){'), JsLines.bae('});')).ae(getJsLoopLines()));\n                                return a.e();\n                            }\n                        };\n                        babelHelpers.createClass(equalizer, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'equalizer';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createBiquadFilter';\n                                }\n                            },\n                            {\n                                key: 'frequencies',\n                                get: function () {\n                                    return [\n                                        60,\n                                        170,\n                                        350,\n                                        1000,\n                                        3500,\n                                        10000\n                                    ];\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return this.frequencies.map(function (freq) {\n                                        return {\n                                            name: 'gain' + freq,\n                                            type: 'range'\n                                        };\n                                    });\n                                }\n                            },\n                            {\n                                key: 'affectedFreqsAndOptions',\n                                get: function () {\n                                    var _this16 = this;\n                                    return this.frequencies.map(function (freq, i) {\n                                        var option = _this16.getFrequencyOption(i);\n                                        return {\n                                            freq: freq,\n                                            option: option\n                                        };\n                                    }).filter(function (fo) {\n                                        return fo.option.input != false || fo.option.value != 0;\n                                    });\n                                }\n                            },\n                            {\n                                key: 'skipNode',\n                                get: function () {\n                                    return this.affectedFreqsAndOptions.length == 0;\n                                }\n                            }\n                        ]);\n                        return equalizer;\n                    }(Filter)\n                };\n                var FilterSequence = function (_CollectionFeature) {\n                    babelHelpers.inherits(FilterSequence, _CollectionFeature);\n                    function FilterSequence() {\n                        babelHelpers.classCallCheck(this, FilterSequence);\n                        return babelHelpers.possibleConstructorReturn(this, _CollectionFeature.apply(this, arguments));\n                    }\n                    FilterSequence.prototype.getEntryClass = function getEntryClass(entryOption) {\n                        return filterClasses[entryOption.filter];\n                    };\n                    FilterSequence.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        if (!featureContext.audioProcessing)\n                            return;\n                        this.entries.forEach(function (entry) {\n                            if (!entry.skipNode) {\n                                featureContext.audioContext = true;\n                                entry.requestFeatureContext(featureContext);\n                            }\n                        });\n                    };\n                    FilterSequence.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        if (!featureContext.audioProcessing)\n                            return Lines.be();\n                        return Lines.bae.apply(Lines, this.entries.filter(function (entry) {\n                            return !entry.skipNode;\n                        }).map(function (entry) {\n                            return entry.getHtmlLines(featureContext, i18n);\n                        }));\n                    };\n                    FilterSequence.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        if (!featureContext.audioProcessing)\n                            return Lines.be();\n                        return InterleaveLines.bae.apply(InterleaveLines, this.entries.filter(function (entry) {\n                            return !entry.skipNode;\n                        }).map(function (entry) {\n                            var lines = entry.getJsInitLines(i18n, prevNodeJsNames);\n                            prevNodeJsNames = entry.nodeJsNames;\n                            return lines;\n                        }));\n                    };\n                    FilterSequence.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        if (!featureContext.audioProcessing)\n                            return prevNodeJsNames;\n                        this.entries.forEach(function (entry) {\n                            if (!entry.skipNode) {\n                                prevNodeJsNames = entry.nodeJsNames;\n                            }\n                        });\n                        return prevNodeJsNames;\n                    };\n                    return FilterSequence;\n                }(CollectionFeature);\n                module.exports = FilterSequence;\n            },\n            {\n                '12': 12,\n                '13': 13,\n                '14': 14,\n                '15': 15,\n                '20': 20,\n                '22': 22,\n                '27': 27,\n                '4': 4,\n                '9': 9\n            }\n        ],\n        31: [\n            function (require, module, exports) {\n                'use strict';\n                var langStrings = {\n                    en: {\n                        'options.sources': 'Sources',\n                        'options.sources.{audio,video}': '{Audio,Video} element',\n                        'options.sources.{audio,video}.add': 'Add {} element',\n                        'options.sources.{audio,video}.url': 'Source URL',\n                        'options.sources.video.{width,height}': 'Player {}',\n                        'options.filters': 'Filters',\n                        'options.filters.gain': 'Gain',\n                        'options.filters.gain.add': 'Add gain',\n                        'options.filters.gain.gain': 'Gain',\n                        'options.filters.panner': 'Stereo panner',\n                        'options.filters.panner.add': 'Add stereo panner',\n                        'options.filters.panner.pan': 'Pan',\n                        'options.filters.biquad': 'Biquad filter',\n                        // [[Digital biquad filter]]\n                        'options.filters.biquad.add': 'Add biquad filter',\n                        'options.filters.biquad.type': 'Filter type',\n                        'options.filters.biquad.type.{lowpass,highpass,bandpass,lowshelf,highshelf,peaking,notch,allpass}': '{}',\n                        'options.filters.biquad.frequency': 'Frequency',\n                        'options.filters.biquad.Q': 'log(Q)',\n                        'options.filters.biquad.detune': 'Detune',\n                        'options.filters.biquad.gain': 'Gain',\n                        'options.filters.convolver': 'Convolver',\n                        'options.filters.convolver.add': 'Add convolver',\n                        'options.filters.convolver.url': 'Impulse responce URL',\n                        'options.filters.convolver.reverb': 'Reverb (dry/wet)',\n                        'options.filters.convolver.buffer.loading': 'Loading and decoding the impulse response',\n                        'options.filters.convolver.buffer.error': 'Error while loading the impulse response',\n                        'options.filters.equalizer': 'Equalizer',\n                        'options.filters.equalizer.add': 'Add equalizer',\n                        'options.filters.equalizer.gain{60,170,350,1000,3500,10000}': '{} Hz gain',\n                        'options.destination': 'Destination',\n                        'options.destination.compressor': 'Add dynamics compressor before the destination',\n                        'options.destination.compressor.enable': 'Enable dynamics compressor',\n                        'options.destination.waveform': 'Add waveform visualization',\n                        'options.canvas': 'Canvas',\n                        'options.canvas.{width,height}': 'Canvas {}',\n                        'options.canvas.line': 'Waveform line',\n                        'options.canvas.line.width': 'Waveform line width',\n                        'options.canvas.line.color': 'Waveform line color',\n                        'options.canvas.line.color.{r,g,b,a}': 'Waveform line {red,green,blue,opacity}',\n                        'options.canvas.background': 'Background',\n                        'options.canvas.background.type': 'Background type',\n                        'options.canvas.background.type.{clear,filled}': '{}',\n                        'options.canvas.background.color': 'Background fill color',\n                        'options.canvas.background.color.{r,g,b,a}': 'Background fill {red,green,blue,opacity (blur)}',\n                        'options-output.input': 'Editable',\n                        'options-output.range': 'with range',\n                        'code-output.warning.jsfiddle-run': 'You may have to click <kbd>Run</kbd> in JSFiddle to get sound output working',\n                        'code.title': 'Web Audio API example \\u2014 generated code',\n                        'comment.context': 'create [audio context][context]',\n                        'comment.sources.audio': 'create [audio source node][source]',\n                        'comment.sources.video': 'create [video source node][source]',\n                        'comment.filters.gain': 'create [gain node][gain]',\n                        'comment.filters.panner': 'create [stereo panner node][panner]',\n                        'comment.filters.biquad': 'create [biquad filter node][biquad]',\n                        'comment.filters.convolver': 'create dry and wet routes with [convolver node][convolver]',\n                        'comment.filters.convolver.single': 'create [convolver node][convolver]',\n                        'comment.filters.equalizer': 'create equalizer as a sequence of [peaking][peaking] [biquad filter nodes][biquad]',\n                        'comment.filters.equalizer.single': 'create equalizer as a [peaking][peaking] [biquad filter node][biquad]',\n                        'comment.destination': 'connect last node to [destination][destination]',\n                        'comment.destination.compressor': 'create [dynamics compressor node][compressor]',\n                        'comment.destination.waveform': 'create [analyser node][analyser] for waveform visualization',\n                        'units.pixel.a': 'px',\n                        'units.pixel.{1,2}': 'pixel{,s}',\n                        'units.hertz.a': 'Hz',\n                        'units.hertz.{1,2}': 'Hertz',\n                        'units.decibel.a': 'dB',\n                        'units.decibel.{1,2}': 'decibel{,s}'\n                    },\n                    ru: {\n                        'options.sources': 'Источники',\n                        'options.sources.{audio,video}': 'Элемент <code>{}</code>',\n                        'options.sources.{audio,video}.add': 'Добавить элемент <code>{}</code>',\n                        'options.sources.{audio,video}.url': 'URL источника',\n                        'options.sources.video.{width,height}': '{Ширина,Высота} проигрывателя',\n                        'options.filters': 'Фильтры',\n                        'options.filters.gain': 'Усилитель',\n                        'options.filters.gain.add': 'Добавить усилитель',\n                        'options.filters.gain.gain': 'Коэффициент усиления',\n                        'options.filters.panner': 'Панорамирование',\n                        'options.filters.panner.add': 'Добавить панорамирование',\n                        'options.filters.panner.pan': 'Баланс',\n                        'options.filters.biquad': 'Биквадратный фильтр',\n                        'options.filters.biquad.add': 'Добавить биквадратный фильтр',\n                        'options.filters.biquad.type': 'Тип фильтра',\n                        'options.filters.biquad.type.lowpass': 'нижних частот',\n                        'options.filters.biquad.type.highpass': 'верхних частот',\n                        'options.filters.biquad.type.bandpass': 'полосовой',\n                        'options.filters.biquad.type.{lowshelf,highshelf,peaking}': '{}',\n                        // TODO\n                        'options.filters.biquad.type.notch': 'полосно-заграждающий',\n                        'options.filters.biquad.type.allpass': 'всепропускающий',\n                        // http://www.dsplib.ru/content/allpass/allpass.html\n                        'options.filters.biquad.frequency': 'Частота',\n                        'options.filters.biquad.Q': 'Логарифм добротности',\n                        'options.filters.biquad.detune': 'Detune',\n                        'options.filters.biquad.gain': 'Усиление',\n                        'options.filters.convolver': 'Свёртка',\n                        'options.filters.convolver.add': 'Добавить свёртку',\n                        'options.filters.convolver.url': 'URL импульсной характеристики',\n                        'options.filters.convolver.reverb': 'Соотношение прямого/обработанного звука',\n                        // http://www.ixbt.com/proaudio/theory-of-reverb.shtml\n                        'options.filters.convolver.buffer.loading': 'Идёт загрузка и декодирование импульсной характеристики',\n                        'options.filters.convolver.buffer.error': 'Ошибка загрузки импульсной характеристики',\n                        'options.filters.equalizer': 'Эквалайзер',\n                        'options.filters.equalizer.add': 'Добавить эквалайзер',\n                        'options.filters.equalizer.gain{60,170,350,1000,3500,10000}': 'Усиление частоты {} Гц',\n                        'options.destination': 'Выход',\n                        'options.destination.compressor': 'Добавить компрессор перед выходом',\n                        'options.destination.compressor.enable': 'Включить компрессор',\n                        'options.destination.waveform': 'Добавить визуализацию формы волны',\n                        'options.canvas': 'Элемент <code>canvas</code>',\n                        'options.canvas.{width,height}': '{Ширина,Высота} элемента <code>canvas</code>',\n                        'options.canvas.line': 'Линия волны',\n                        'options.canvas.line.width': 'Ширина линии волны',\n                        'options.canvas.line.color': 'Цвет линии волны',\n                        'options.canvas.line.color.{r,g,b,a}': '{Красный ,Зелёный ,Синий ,Альфа-}канал линии волны',\n                        'options.canvas.background': 'Фон',\n                        'options.canvas.background.type': 'Тип фона',\n                        'options.canvas.background.type.{clear,filled}': '{прозрачный,закрашенный}',\n                        'options.canvas.background.color': 'Цвет фона',\n                        'options.canvas.background.color.{r,g,b,a}': '{Красный ,Зелёный ,Синий ,Альфа-}канал фона',\n                        'options-output.input': 'Значение изменяемо',\n                        'options-output.range': 'в диапазоне',\n                        'code-output.warning.jsfiddle-run': 'Для корректного вывода звука в JSFiddle может потребоваться нажатие кнопки <kbd>Run</kbd>',\n                        'code.title': 'Пример использования Web Audio API \\u2014 сгенерированный код',\n                        'comment.context': 'создаём [аудио-контекст][context]',\n                        'comment.sources.audio': 'создаём [узел источника аудио][source]',\n                        'comment.sources.video': 'создаём [узел источника видео][source]',\n                        'comment.filters.gain': 'создаём [узел усилителя][gain]',\n                        'comment.filters.panner': 'создаём [узел панорамирования][panner]',\n                        'comment.filters.biquad': 'создаём [узел биквадратичного фильтра][biquad]',\n                        'comment.filters.convolver': 'создаём прямой путь и путь через [узел свёртки][convolver]',\n                        'comment.filters.convolver.single': 'создаём [узел свёртки][convolver]',\n                        'comment.filters.equalizer': 'создаём эквалайзер в виде последовательности [peaking][peaking] [биквадратичных фильтров][biquad]',\n                        'comment.filters.equalizer.single': 'создаём эквалайзер в виде [peaking][peaking] [биквадратичного фильтра][biquad]',\n                        'comment.destination': 'соединяем последний узел с [выходом][destination]',\n                        'comment.destination.compressor': 'создаём [узел компрессора][compressor]',\n                        'comment.destination.waveform': 'создаём [узел анализатора][analyser] для визуализации формы волны',\n                        'units.pixel.a': 'px',\n                        'units.pixel.{1,2,5}': 'пиксел{ь,я,ей}',\n                        'units.hertz.a': 'Гц',\n                        'units.hertz.{1,2,5}': 'Герц{,а,}',\n                        'units.decibel.a': 'дБ',\n                        'units.decibel.{1,2,5}': 'децибел{,а,ов}'\n                    }\n                };\n                /*\r\nfunction i18nLinkFilter(inStrings) {\r\n\tconst linkRegexp=/\\[(\\S+)\\s+([^\\]]+)]/g\r\n\tconst outStrings={}\r\n\tfor (let id in inStrings) {\r\n\t\toutStrings[id]=inStrings[id].replace(linkRegexp,(match,url,text)=>\"<a href='\"+url+\"'>\"+text+\"</a>\")\r\n\t}\r\n\treturn outStrings\r\n}\r\nstrings=i18nLinkFilter(strings)\r\n*/\n                for (var lang in langStrings) {\n                    var strings = langStrings[lang];\n                    strings = require(10)(strings);\n                    //strings=require('crnx-base/i18n-link-wikipedia')(lang)(strings)\n                    strings = require(17)(lang)(strings);\n                    strings = require(1)(lang)(strings);\n                    langStrings[lang] = strings;\n                }\n                module.exports = require(11)(langStrings);\n            },\n            {\n                '1': 1,\n                '10': 10,\n                '11': 11,\n                '17': 17\n            }\n        ],\n        32: [\n            function (require, module, exports) {\n                'use strict';\n                var idCounter = 0;\n                function generateId() {\n                    return 'webaudio-starter-id-' + idCounter++;\n                }\n                var i18ns = require(31);\n                var Options = require(35);\n                var Code = require(26);\n                var OptionsOutput = require(34);\n                var CodeOutput = require(25);\n                $(function () {\n                    $('.webaudio-starter').each(function () {\n                        var $container = $(this);\n                        var lang = $container.closest('[lang]').attr('lang');\n                        var i18n = i18ns(lang);\n                        var options = new Options();\n                        var codeOutput = new CodeOutput(function () {\n                            return new Code(options.fix(), i18n);\n                        }, i18n);\n                        options.updateCallback = codeOutput.update;\n                        var optionsOutput = new OptionsOutput(options, generateId, i18n);\n                        $container.empty().append(optionsOutput.$output, codeOutput.$output);\n                    });\n                });\n            },\n            {\n                '25': 25,\n                '26': 26,\n                '31': 31,\n                '34': 34,\n                '35': 35\n            }\n        ],\n        33: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = Object.create(require(16));\n                // differs from webgl-starter:\n                //\tinput is a boolean\n                // \tfloat subclasses have a fixed precision of 2\n                //\tno speed\n                //\tcan specify defaultMin, defaultMax\n                //\tfixed has defaultValue - although it's potentially confusing: user input default vs Web Audio Node property default - they are currently the same\n                Option.LiveNumber = function (_Option$Number) {\n                    babelHelpers.inherits(_class, _Option$Number);\n                    function _class(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class);\n                        var dataValue = undefined, dataMin = undefined, dataMax = undefined, dataInput = undefined;\n                        if (typeof data == 'object') {\n                            dataValue = data.value;\n                            dataMin = data.min;\n                            dataMax = data.max;\n                            dataInput = data.input;\n                        } else {\n                            dataValue = data;\n                        }\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Number.apply(this, arguments));\n                        if (settings.defaultMin !== undefined) {\n                            _this.defaultMin = settings.defaultMin;\n                        } else {\n                            _this.defaultMin = _this.availableMin;\n                        }\n                        if (settings.defaultMax !== undefined) {\n                            _this.defaultMax = settings.defaultMax;\n                        } else {\n                            _this.defaultMax = _this.availableMax;\n                        }\n                        _this._min = dataMin !== undefined ? dataMin : _this.defaultMin;\n                        _this._max = dataMax !== undefined ? dataMax : _this.defaultMax;\n                        _this._input = !!dataInput;\n                        _this._$range = null;\n                        return _this;\n                    }\n                    _class.prototype.updateInternalVisibility = function updateInternalVisibility() {\n                        if (this._$range)\n                            this._$range.toggle(this._input);\n                    };\n                    _class.prototype.exportHelper = function exportHelper(src) {\n                        var data = {};\n                        if (src.value != src.defaultValue)\n                            data.value = src.value;\n                        if (src.min != src.availableMin)\n                            data.min = src.min;\n                        if (src.max != src.availableMax)\n                            data.max = src.max;\n                        if (src.input)\n                            data.input = src.input;\n                        return data;\n                    };\n                    _class.prototype.export = function _export() {\n                        return this.exportHelper(this);\n                    };\n                    _class.prototype.fix = function fix() {\n                        var fixed = _Option$Number.prototype.fix.call(this);\n                        fixed.min = this.min;\n                        fixed.max = this.max;\n                        fixed.input = this.input;\n                        fixed.defaultValue = this.defaultValue;\n                        return fixed;\n                    };\n                    babelHelpers.createClass(_class, [\n                        {\n                            key: 'input',\n                            get: function () {\n                                return this._input;\n                            },\n                            set: function (input) {\n                                this._input = input;\n                                this.updateInternalVisibility();\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'min',\n                            get: function () {\n                                return this._min;\n                            },\n                            set: function (min) {\n                                this._min = min;\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'max',\n                            get: function () {\n                                return this._max;\n                            },\n                            set: function (max) {\n                                this._max = max;\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: '$range',\n                            get: function () {\n                                return this._$range;\n                            },\n                            set: function ($range) {\n                                this._$range = $range;\n                                this.updateInternalVisibility();\n                            }\n                        }\n                    ]);\n                    return _class;\n                }(Option.Number);\n                Option.LiveInt = function (_Option$LiveNumber) {\n                    babelHelpers.inherits(_class2, _Option$LiveNumber);\n                    function _class2() {\n                        babelHelpers.classCallCheck(this, _class2);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class2, [{\n                            key: 'precision',\n                            get: function () {\n                                return 0;\n                            }\n                        }]);\n                    return _class2;\n                }(Option.LiveNumber);\n                Option.LiveFloat = function (_Option$LiveNumber2) {\n                    babelHelpers.inherits(_class3, _Option$LiveNumber2);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber2.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class3, [{\n                            key: 'precision',\n                            get: function () {\n                                return 2;\n                            }\n                        }]);\n                    return _class3;\n                }(Option.LiveNumber);\n                var FixedLiveSelect = function () {\n                    function FixedLiveSelect(src) {\n                        babelHelpers.classCallCheck(this, FixedLiveSelect);\n                        this.value = src.value;\n                        this.input = src.input;\n                        this.defaultValue = src.defaultValue;\n                        this.availableValues = src.availableValues;\n                        this.name = src.name;\n                    }\n                    FixedLiveSelect.prototype.valueOf = function valueOf() {\n                        return this.value;\n                    };\n                    FixedLiveSelect.prototype.toString = function toString() {\n                        return this.value;\n                    };\n                    return FixedLiveSelect;\n                }();\n                Option.LiveSelect = function (_Option$Select) {\n                    babelHelpers.inherits(_class4, _Option$Select);\n                    function _class4(name, settings, data, fullName, optionByFullName, updateCallback, makeEntry, isInsideArray) {\n                        babelHelpers.classCallCheck(this, _class4);\n                        var dataValue = undefined, dataInput = undefined;\n                        if (typeof data == 'object') {\n                            dataValue = data.value;\n                            dataInput = data.input;\n                        } else {\n                            dataValue = data;\n                        }\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$Select.apply(this, arguments));\n                        _this4._input = !!dataInput;\n                        return _this4;\n                    }\n                    _class4.prototype.export = function _export() {\n                        var data = {};\n                        if (this.value != this.defaultValue)\n                            data.value = this.value;\n                        if (this.input)\n                            data.input = this.input;\n                        return data;\n                    };\n                    _class4.prototype.fix = function fix() {\n                        return new FixedLiveSelect(this);\n                    };\n                    babelHelpers.createClass(_class4, [{\n                            key: 'input',\n                            get: function () {\n                                return this._input;\n                            },\n                            set: function (input) {\n                                this._input = input;\n                                this.updateCallback();\n                            }\n                        }]);\n                    return _class4;\n                }(Option.Select);\n                module.exports = Option;\n            },\n            { '16': 16 }\n        ],\n        34: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require(33);\n                var BaseOptionsOutput = require(18);\n                var OptionsOutput = function (_BaseOptionsOutput) {\n                    babelHelpers.inherits(OptionsOutput, _BaseOptionsOutput);\n                    function OptionsOutput() {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptionsOutput.apply(this, arguments));\n                    }\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        _BaseOptionsOutput.prototype.setOptionClassWriters.call(this, optionClassWriters);\n                        optionClassWriters.set(Option.LiveNumber, function (option, writeOption, i18n, generateId) {\n                            var p = option.precision;\n                            var setInputAttrs = function ($input) {\n                                return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', Math.pow(0.1, p).toFixed(p));\n                            };\n                            var writeMinMaxInput = function (minOrMax) {\n                                return setInputAttrs($('<input type=\\'number\\' required>')).val(option[minOrMax]).on('input change', function () {\n                                    if (this.checkValidity()) {\n                                        option[minOrMax] = parseFloat(this.value);\n                                    }\n                                });\n                            };\n                            var inputCheckboxId = generateId();\n                            var $inputCheckbox = undefined, $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                            var $output = optionClassWriters.get(Option.Number)(option, writeOption, i18n, generateId);\n                            $output.find('button').before($inputCheckbox = $('<input type=\\'checkbox\\' id=\\'' + inputCheckboxId + '\\'>').prop('checked', option.input).change(function () {\n                                option.input = $(this).prop('checked');\n                            }), ' <label for=\\'' + inputCheckboxId + '\\'>' + i18n('options-output.input') + '</label> ', option.$range = $('<span class=\\'range\\'>').append(i18n('options-output.range') + ' ', $rangeMinInput = writeMinMaxInput('min'), ' .. ', $rangeMaxInput = writeMinMaxInput('max')), ' ').click(function () {\n                                $inputCheckbox.prop('checked', false).change();\n                                $rangeMinInput.val(option.defaultMin).change();\n                                $rangeMaxInput.val(option.defaultMax).change();\n                            });\n                            return $output;\n                        });\n                        optionClassWriters.set(Option.LiveSelect, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            var inputCheckboxId = generateId();\n                            var $select = undefined, $inputCheckbox = undefined;\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label> ', $select = $('<select id=\\'' + id + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').val(availableValue).html(i18n('options.' + option.fullName + '.' + availableValue));\n                            })).val(option.value).change(function () {\n                                option.value = this.value;\n                            }), ' ', $inputCheckbox = $('<input type=\\'checkbox\\' id=\\'' + inputCheckboxId + '\\'>').prop('checked', option.input).change(function () {\n                                option.input = $(this).prop('checked');\n                            }), ' <label for=\\'' + inputCheckboxId + '\\'>' + i18n('options-output.input') + '</label> ', $('<button type=\\'button\\'>' + i18n('options-output.reset') + '</button>').click(function () {\n                                $select.val(option.defaultValue).change();\n                                $inputCheckbox.prop('checked', false).change();\n                            }));\n                        });\n                    };\n                    return OptionsOutput;\n                }(BaseOptionsOutput);\n                module.exports = OptionsOutput;\n            },\n            {\n                '18': 18,\n                '33': 33\n            }\n        ],\n        35: [\n            function (require, module, exports) {\n                'use strict';\n                var BaseOptions = require(19);\n                var Options = function (_BaseOptions) {\n                    babelHelpers.inherits(Options, _BaseOptions);\n                    function Options() {\n                        babelHelpers.classCallCheck(this, Options);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptions.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [\n                                    [\n                                        'Array',\n                                        'sources',\n                                        [\n                                            // urls are from w3c mooc\n                                            [\n                                                'Group',\n                                                'audio',\n                                                [[\n                                                        'Text',\n                                                        'url',\n                                                        [\n                                                            'http://mainline.i3s.unice.fr/mooc/guitarRiff1.mp3',\n                                                            'http://mainline.i3s.unice.fr/mooc/drums.mp3',\n                                                            'http://mainline.i3s.unice.fr/mooc/LaSueur.mp3'\n                                                        ]\n                                                    ]]\n                                            ],\n                                            [\n                                                'Group',\n                                                'video',\n                                                [\n                                                    [\n                                                        'Text',\n                                                        'url',\n                                                        [\n                                                            'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.webm',\n                                                            'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.mp4',\n                                                            'http://mainline.i3s.unice.fr/mooc/sintel.webm',\n                                                            'http://mainline.i3s.unice.fr/mooc/sintel.mp4'\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'Int',\n                                                        'width',\n                                                        [\n                                                            1,\n                                                            1920\n                                                        ],\n                                                        320,\n                                                        { unit: 'pixel' }\n                                                    ],\n                                                    [\n                                                        'Int',\n                                                        'height',\n                                                        [\n                                                            1,\n                                                            1080\n                                                        ],\n                                                        240,\n                                                        { unit: 'pixel' }\n                                                    ]\n                                                ]\n                                            ]\n                                        ],\n                                        'source'\n                                    ],\n                                    [\n                                        'Array',\n                                        'filters',\n                                        [\n                                            [\n                                                'Group',\n                                                'gain',\n                                                [[\n                                                        'LiveFloat',\n                                                        'gain',\n                                                        [\n                                                            0,\n                                                            10\n                                                        ],\n                                                        1,\n                                                        { defaultMax: 1 }\n                                                    ]]\n                                            ],\n                                            [\n                                                'Group',\n                                                'panner',\n                                                [[\n                                                        'LiveFloat',\n                                                        'pan',\n                                                        [\n                                                            -1,\n                                                            1\n                                                        ],\n                                                        0\n                                                    ]]\n                                            ],\n                                            [\n                                                'Group',\n                                                'biquad',\n                                                [\n                                                    [\n                                                        'LiveSelect',\n                                                        'type',\n                                                        [\n                                                            'lowpass',\n                                                            'highpass',\n                                                            'bandpass',\n                                                            'lowshelf',\n                                                            'highshelf',\n                                                            'peaking',\n                                                            'notch',\n                                                            'allpass'\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'LiveInt',\n                                                        'frequency',\n                                                        [\n                                                            0,\n                                                            22050\n                                                        ],\n                                                        350,\n                                                        { unit: 'hertz' }\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'Q',\n                                                        [\n                                                            -4,\n                                                            4\n                                                        ],\n                                                        0\n                                                    ],\n                                                    // log Q\n                                                    [\n                                                        'LiveInt',\n                                                        'gain',\n                                                        [\n                                                            -30,\n                                                            30\n                                                        ],\n                                                        0,\n                                                        { unit: 'decibel' }\n                                                    ],\n                                                    [\n                                                        'LiveInt',\n                                                        'detune',\n                                                        [\n                                                            0,\n                                                            100\n                                                        ],\n                                                        { unit: '\\xA2' }\n                                                    ]\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'convolver',\n                                                [\n                                                    [\n                                                        'LiveFloat',\n                                                        'reverb',\n                                                        [\n                                                            0,\n                                                            1\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'Text',\n                                                        'url',\n                                                        ['http://mainline.i3s.unice.fr/mooc/Scala-Milan-Opera-Hall.wav']\n                                                    ]\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'equalizer',\n                                                [\n                                                    60,\n                                                    170,\n                                                    350,\n                                                    1000,\n                                                    3500,\n                                                    10000\n                                                ].map(function (freq) {\n                                                    return [\n                                                        'LiveInt',\n                                                        'gain' + freq,\n                                                        [\n                                                            -30,\n                                                            30\n                                                        ],\n                                                        0,\n                                                        { unit: 'decibel' }\n                                                    ];\n                                                })\n                                            ]\n                                        ],\n                                        'filter'\n                                    ],\n                                    [\n                                        'Group',\n                                        'destination',\n                                        [\n                                            [\n                                                'Checkbox',\n                                                'compressor'\n                                            ],\n                                            // Firefox compresses automatically?\n                                            [\n                                                'Checkbox',\n                                                'waveform'\n                                            ]\n                                        ]\n                                    ],\n                                    [\n                                        'Group',\n                                        'canvas',\n                                        [\n                                            [\n                                                'Int',\n                                                'width',\n                                                [\n                                                    1,\n                                                    1920\n                                                ],\n                                                300,\n                                                { unit: 'pixel' }\n                                            ],\n                                            [\n                                                'Int',\n                                                'height',\n                                                [\n                                                    1,\n                                                    1080\n                                                ],\n                                                100,\n                                                { unit: 'pixel' }\n                                            ],\n                                            [\n                                                'Group',\n                                                'line',\n                                                [\n                                                    [\n                                                        'Float',\n                                                        'width',\n                                                        [\n                                                            0,\n                                                            10\n                                                        ],\n                                                        1,\n                                                        { unit: 'pixel' }\n                                                    ],\n                                                    [\n                                                        'Group',\n                                                        'color',\n                                                        [\n                                                            [\n                                                                'Int',\n                                                                'r',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                0,\n                                                                { unit: '%' }\n                                                            ],\n                                                            [\n                                                                'Int',\n                                                                'g',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                0,\n                                                                { unit: '%' }\n                                                            ],\n                                                            [\n                                                                'Int',\n                                                                'b',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                0,\n                                                                { unit: '%' }\n                                                            ],\n                                                            [\n                                                                'Int',\n                                                                'a',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                100,\n                                                                { unit: '%' }\n                                                            ]\n                                                        ]\n                                                    ]\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'background',\n                                                [\n                                                    [\n                                                        'Select',\n                                                        'type',\n                                                        [\n                                                            'clear',\n                                                            'filled'\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'Group',\n                                                        'color',\n                                                        [\n                                                            [\n                                                                'Int',\n                                                                'r',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                100,\n                                                                { unit: '%' }\n                                                            ],\n                                                            [\n                                                                'Int',\n                                                                'g',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                100,\n                                                                { unit: '%' }\n                                                            ],\n                                                            [\n                                                                'Int',\n                                                                'b',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                100,\n                                                                { unit: '%' }\n                                                            ],\n                                                            [\n                                                                'Int',\n                                                                'a',\n                                                                [\n                                                                    0,\n                                                                    100\n                                                                ],\n                                                                100,\n                                                                { unit: '%' }\n                                                            ]\n                                                        ],\n                                                        { visibilityData: { 'canvas.background.type': ['filled'] } }\n                                                    ]\n                                                ]\n                                            ]\n                                        ],\n                                        { visibilityData: { 'destination.waveform': [true] } }\n                                    ]\n                                ];\n                            }\n                        },\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require(33);\n                            }\n                        }\n                    ]);\n                    return Options;\n                }(BaseOptions);\n                module.exports = Options;\n            },\n            {\n                '19': 19,\n                '33': 33\n            }\n        ],\n        36: [\n            function (require, module, exports) {\n                'use strict';\n                var _templateObject = babelHelpers.taggedTemplateLiteralLoose([\n                        '<audio src=',\n                        ' id=',\n                        ' controls loop crossorigin=',\n                        '></audio>'\n                    ], [\n                        '<audio src=',\n                        ' id=',\n                        ' controls loop crossorigin=',\n                        '></audio>'\n                    ]), _templateObject2 = babelHelpers.taggedTemplateLiteralLoose([\n                        '<video src=',\n                        ' id=',\n                        ' width=',\n                        ' height=',\n                        ' controls loop crossorigin=',\n                        '></video>'\n                    ], [\n                        '<video src=',\n                        ' id=',\n                        ' width=',\n                        ' height=',\n                        ' controls loop crossorigin=',\n                        '></video>'\n                    ]);\n                var camelCase = require(4);\n                var Lines = require(14);\n                var JsLines = require(13);\n                var WrapLines = require(22);\n                var InterleaveLines = require(12);\n                var RefLines = require(20);\n                var CollectionFeature = require(27);\n                var Source = function () {\n                    function Source(options, n) {\n                        babelHelpers.classCallCheck(this, Source);\n                        this.options = options;\n                        this.n = n;\n                    }\n                    Source.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        return WrapLines.b('<div>', '</div>').ae(this.getElementHtmlLines(featureContext, i18n));\n                    };\n                    Source.prototype.getJsInitLines = function getJsInitLines(i18n) {\n                        return JsLines.bae(RefLines.parse('// ' + i18n('comment.sources.' + this.type)), 'var ' + this.nodeJsName + '=ctx.createMediaElementSource(document.getElementById(\\'' + this.elementHtmlName + '\\'));');\n                    };\n                    // abstract:\n                    // get type()\n                    // getElementHtmlLines(featureContext,i18n)\n                    babelHelpers.createClass(Source, [\n                        {\n                            key: 'nSuffix',\n                            get: function () {\n                                if (this.n !== undefined) {\n                                    return '.' + this.n;\n                                } else {\n                                    return '';\n                                }\n                            }\n                        },\n                        {\n                            key: 'elementHtmlName',\n                            get: function () {\n                                return 'my.' + this.type + this.nSuffix;\n                            }\n                        },\n                        {\n                            key: 'nodeJsName',\n                            get: function () {\n                                return camelCase(this.type + this.nSuffix + '.node');\n                            }\n                        }\n                    ]);\n                    return Source;\n                }();\n                var sourceClasses = {\n                    audio: function (_Source) {\n                        babelHelpers.inherits(audio, _Source);\n                        function audio() {\n                            babelHelpers.classCallCheck(this, audio);\n                            return babelHelpers.possibleConstructorReturn(this, _Source.apply(this, arguments));\n                        }\n                        audio.prototype.getElementHtmlLines = function getElementHtmlLines(featureContext, i18n) {\n                            return Lines.bae(Lines.html(_templateObject, this.options.url, this.elementHtmlName, featureContext.audioContext ? 'anonymous' : false));\n                        };\n                        babelHelpers.createClass(audio, [{\n                                key: 'type',\n                                get: function () {\n                                    return 'audio';\n                                }\n                            }]);\n                        return audio;\n                    }(Source),\n                    video: function (_Source2) {\n                        babelHelpers.inherits(video, _Source2);\n                        function video() {\n                            babelHelpers.classCallCheck(this, video);\n                            return babelHelpers.possibleConstructorReturn(this, _Source2.apply(this, arguments));\n                        }\n                        video.prototype.getElementHtmlLines = function getElementHtmlLines(featureContext, i18n) {\n                            return Lines.bae(Lines.html(_templateObject2, this.options.url, this.elementHtmlName, this.options.width, this.options.height, featureContext.audioContext ? 'anonymous' : false));\n                        };\n                        babelHelpers.createClass(video, [{\n                                key: 'type',\n                                get: function () {\n                                    return 'video';\n                                }\n                            }]);\n                        return video;\n                    }(Source)\n                };\n                var SourceSet = function (_CollectionFeature) {\n                    babelHelpers.inherits(SourceSet, _CollectionFeature);\n                    function SourceSet() {\n                        babelHelpers.classCallCheck(this, SourceSet);\n                        return babelHelpers.possibleConstructorReturn(this, _CollectionFeature.apply(this, arguments));\n                    }\n                    SourceSet.prototype.getEntryClass = function getEntryClass(entryOption) {\n                        return sourceClasses[entryOption.source];\n                    };\n                    SourceSet.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        if (this.entries.length > 0) {\n                            featureContext.audioProcessing = true;\n                        }\n                    };\n                    SourceSet.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var a = InterleaveLines.b();\n                        if (featureContext.audioContext) {\n                            a.apply(undefined, this.entries.map(function (entry) {\n                                return entry.getJsInitLines(i18n);\n                            }));\n                        }\n                        return a.e();\n                    };\n                    SourceSet.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        if (featureContext.audioContext) {\n                            return this.entries.map(function (entry) {\n                                return entry.nodeJsName;\n                            });\n                        } else {\n                            return prevNodeJsNames;\n                        }\n                    };\n                    return SourceSet;\n                }(CollectionFeature);\n                module.exports = SourceSet;\n            },\n            {\n                '12': 12,\n                '13': 13,\n                '14': 14,\n                '20': 20,\n                '22': 22,\n                '27': 27,\n                '4': 4\n            }\n        ]\n    }, {}, [32]));\n}());","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tconst additionalStringsPrefix='code-output'\r\n\tconst additionalStrings={\r\n\t\ten: {\r\n\t\t\t'save': \"Save source code\",\r\n\t\t\t'run': \"Run in new window\",\r\n\t\t\t'open.codepen': \"Open in CodePen\",\r\n\t\t\t'open.jsfiddle': \"Open in JSFiddle\",\r\n\t\t\t'section.html': \"HTML\",\r\n\t\t\t'section.css': \"CSS\",\r\n\t\t\t'section.js': \"JavaScript\",\r\n\t\t\t'embedded': \"embedded in HTML source code\",\r\n\t\t\t'mode.full': \"complete HTML\",\r\n\t\t\t'mode.body': \"only HTML body\",\r\n\t\t\t'mode.embed': \"embed in HTML\",\r\n\t\t\t'mode.paste': \"extract to paste into HTML later\",\r\n\t\t\t'mode.file': \"extract to load as external resource\",\r\n\t\t\t'formatting': \"Formatting\",\r\n\t\t\t'formatting.indent': \"indent with tabs\",\r\n\t\t\t'formatting.indentNumber': \"spaces per indent\",\r\n\t\t\t'formatting.jsSemicolons': \"JavaScript semicolons\",\r\n\t\t\t'warning.no-hljs': \"<a href=https://highlightjs.org/>highlight.js</a> (hosted on <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) is not loaded. Syntax highlighting is disabled.\",\r\n\t\t},\r\n\t\tru: {\r\n\t\t\t'save': \"Сохранить исходный код\",\r\n\t\t\t'run': \"Запустить в новом окне\",\r\n\t\t\t'open.codepen': \"Открыть в CodePen\",\r\n\t\t\t'open.jsfiddle': \"Открыть в JSFiddle\",\r\n\t\t\t'section.html': \"HTML\",\r\n\t\t\t'section.css': \"CSS\",\r\n\t\t\t'section.js': \"JavaScript\",\r\n\t\t\t'embedded': \"встроен в код HTML\",\r\n\t\t\t'mode.full': \"полностью\",\r\n\t\t\t'mode.body': \"только <code>body</code>\",\r\n\t\t\t'mode.embed': \"встроить в HTML\",\r\n\t\t\t'mode.paste': \"извлечь для последующей вставки в HTML\",\r\n\t\t\t'mode.file': \"извлечь для загрузки в качестве внешнего ресурса\",\r\n\t\t\t'formatting': \"Форматирование\",\r\n\t\t\t'formatting.indent': \"отступы с помощью tab\",\r\n\t\t\t'formatting.indentNumber': \"пробелов в отступе\",\r\n\t\t\t'formatting.jsSemicolons': \"<code>;</code> в JavaScript\",\r\n\t\t\t'warning.no-hljs': \"<a href=https://highlightjs.org/>highlight.js</a> (с сервера <a href=http://cdnjs.cloudflare.com>cdnjs.cloudflare.com</a>) не загружен. Подсветка синтаксиса отключена.\",\r\n\t\t},\r\n\t}\r\n\tfor (let id in additionalStrings[lang]) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[lang][id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst debounce=require('./fake-lodash/debounce')\r\nconst repeat=require('./fake-lodash/repeat')\r\n\r\nconst getHtmlDataUri=(html)=>'data:text/html;charset=utf-8,'+encodeURIComponent(html)\r\n\r\nclass CodeOutput {\r\n\tconstructor(generateCode,i18n) {\r\n\t\tlet code=generateCode()\r\n\t\tconst $sectionCode={}, $sectionModeInput={}\r\n\t\tlet $indentCheckbox, $indentNumber, $jsSemicolonsCheckbox\r\n\t\tconst getCode=()=>code\r\n\t\tconst getFormatting=()=>{\r\n\t\t\tlet indent='\\t'\r\n\t\t\tif (!$indentCheckbox.prop('checked')) {\r\n\t\t\t\tlet n=4\r\n\t\t\t\tif ($indentNumber[0].checkValidity()) {\r\n\t\t\t\t\tn=Number($indentNumber.val())\r\n\t\t\t\t}\r\n\t\t\t\tindent=repeat(' ',n)\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\trefs: this.refs,\r\n\t\t\t\tindent,\r\n\t\t\t\tjsSemicolons: $jsSemicolonsCheckbox.prop('checked'),\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst getSectionModes=()=>({\r\n\t\t\thtml: $sectionModeInput['html'].val(),\r\n\t\t\tcss:  $sectionModeInput['css' ].val(),\r\n\t\t\tjs:   $sectionModeInput['js'  ].val(),\r\n\t\t})\r\n\t\tconst extractCode=()=>{\r\n\t\t\tconst sectionModes=getSectionModes()\r\n\t\t\tconst sections=code.extractSections(sectionModes)\r\n\t\t\tfor (let sectionName in sections) {\r\n\t\t\t\tif (sectionModes[sectionName]=='embed') {\r\n\t\t\t\t\t$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t\t\"<p>\"+i18n('code-output.embedded')+\"</p>\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet $code\r\n\t\t\t\t\t$sectionCode[sectionName].empty().append(\r\n\t\t\t\t\t\t$(\"<pre>\").append(\r\n\t\t\t\t\t\t\t$code=$(\"<code class='\"+sectionName+\"'>\")\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t\t$code.html(\r\n\t\t\t\t\t\tsections[sectionName].getHtml(getFormatting()).join(\"\\n\")\r\n\t\t\t\t\t)\r\n\t\t\t\t\tif (window.hljs) {\r\n\t\t\t\t\t\thljs.highlightBlock($code[0])\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst writeFormattingControls=()=>{\r\n\t\t\treturn $(\"<details>\").append(\r\n\t\t\t\t\"<summary>\"+i18n('code-output.formatting')+\"</summary>\",\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentCheckbox=$(\"<input type='checkbox' checked>\").change(extractCode),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.indent')\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$indentNumber=$(\"<input type='number' min='0' max='32' value='4' required>\").on('input change',extractCode),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.indentNumber')\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\t$(\"<div>\").append(\r\n\t\t\t\t\t$(\"<label>\").append(\r\n\t\t\t\t\t\t$jsSemicolonsCheckbox=$(\"<input type='checkbox'>\").change(extractCode),\r\n\t\t\t\t\t\t\" \"+i18n('code-output.formatting.jsSemicolons')\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst writeSection=(sectionName)=>{\r\n\t\t\tconst extractable=sectionName!='html'\r\n\t\t\tconst $summary=$(\"<summary>\"+i18n('code-output.section.'+sectionName)+\"</summary>\")\r\n\t\t\tlet $saveButton\r\n\t\t\t$summary.append(\r\n\t\t\t\t\" \",\r\n\t\t\t\t$sectionModeInput[sectionName]=$(\"<select>\").append(\r\n\t\t\t\t\t(sectionName=='html'\r\n\t\t\t\t\t\t? ['full','body']\r\n\t\t\t\t\t\t: ['embed','paste','file']\r\n\t\t\t\t\t).map(mode=>\r\n\t\t\t\t\t\t$(\"<option>\").val(mode).html(i18n('code-output.mode.'+mode))\r\n\t\t\t\t\t)\r\n\t\t\t\t).change(function(){\r\n\t\t\t\t\tif (extractable) {\r\n\t\t\t\t\t\t$saveButton.prop('disabled',this.value=='embed')\r\n\t\t\t\t\t}\r\n\t\t\t\t\textractCode()\r\n\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t/*\r\n\t\t\t\t// doesn't work in IE\r\n\t\t\t\t$(\"<a download='\"+section.filename+\"'><button type='button'>\"+i18n('code-output.save')+\"</button></a>\").click(function(){\r\n\t\t\t\t\t// yes I want a button, but download attr is only available for links\r\n\t\t\t\t\t$(this).attr('href',getHtmlDataUri(\r\n\t\t\t\t\t\tsection.get(this.formatting).join(\"\\n\")\r\n\t\t\t\t\t))\r\n\t\t\t\t})\r\n\t\t\t\t*/\r\n\t\t\t\t$saveButton=$(\"<button type='button'>\"+i18n('code-output.save')+\"</button>\").click(function(){\r\n\t\t\t\t\tconst section=code.extractSections(getSectionModes())[sectionName]\r\n\t\t\t\t\t// http://stackoverflow.com/a/24354303\r\n\t\t\t\t\tconst blob=new Blob(\r\n\t\t\t\t\t\t[section.get(getFormatting()).join(\"\\n\")],\r\n\t\t\t\t\t\t{type:section.mimeType}\r\n\t\t\t\t\t)\r\n\t\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\t\tnavigator.msSaveOrOpenBlob(blob,section.filename)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst $a=$(\"<a>\")\r\n\t\t\t\t\t\t\t.attr('download',section.filename)\r\n\t\t\t\t\t\t\t.attr('href',URL.createObjectURL(blob))\r\n\t\t\t\t\t\t\t.appendTo('body')\r\n\t\t\t\t\t\t$a.get(0).click()\r\n\t\t\t\t\t\t$a.remove()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tif (extractable) {\r\n\t\t\t\t$saveButton.prop('disabled',$sectionModeInput[sectionName].val()=='embed')\r\n\t\t\t}\r\n\t\t\treturn $(\"<details open>\").append(\r\n\t\t\t\t$summary,\r\n\t\t\t\t$sectionCode[sectionName]=$(\"<div class='code'>\")\r\n\t\t\t)\r\n\t\t}\r\n\t\tconst $output=$(\"<div class='code-output'>\").append(this.writeButtons(getCode,getFormatting,i18n)).append(\r\n\t\t\twriteFormattingControls(),\r\n\t\t\twriteSection('html'),\r\n\t\t\twriteSection('css'),\r\n\t\t\twriteSection('js')\r\n\t\t)\r\n\t\tif (!window.hljs) {\r\n\t\t\t$output.append(\"<p>\"+i18n('code-output.warning.no-hljs')+\"</p>\")\r\n\t\t}\r\n\t\t$output.append(this.writeButtons(getCode,getFormatting,i18n))\r\n\t\textractCode()\r\n\r\n\t\tconst delay=200\r\n\t\tconst update=debounce(()=>{\r\n\t\t\tcode=generateCode()\r\n\t\t\textractCode()\r\n\t\t},delay)\r\n\r\n\t\t// public props:\r\n\t\tthis.$output=$output\r\n\t\tthis.update=update\r\n\t}\r\n\r\n\t// private interface:\r\n\tget refs() {\r\n\t\treturn {}\r\n\t}\r\n\twriteButtons(getCode,getFormatting,i18n) {\r\n\t\treturn $(\"<div>\").append(\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.run')+\"</button>\").click(function(){\r\n\t\t\t\tconst code=getCode()\r\n\t\t\t\tconst html=code.get(getFormatting()).join(\"\\n\")\r\n\t\t\t\tif (navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\t// has drawbacks:\r\n\t\t\t\t\t// * Firefox and Chrome have trouble showing the source\r\n\t\t\t\t\t// * weird bug in Firefox:\r\n\t\t\t\t\t//   in webgl-starter: add z-rotation, slider input, add speed, slider input, run, change rotation range, run again\r\n\t\t\t\t\t// * Firefox shows url of a generator page\r\n\t\t\t\t\tconst w=window.open(\"\",\"generatedCode\")\r\n\t\t\t\t\tw.document.open()\r\n\t\t\t\t\tw.document.write(html)\r\n\t\t\t\t\tw.document.close()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// has drawbacks:\r\n\t\t\t\t\t// * doesn't work in IE b/c they decided it's security risk\r\n\t\t\t\t\t// * long url\r\n\t\t\t\t\twindow.open(getHtmlDataUri(html),\"generatedCode\")\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.codepen')+\"</button>\").click(function(){\r\n\t\t\t\t// http://blog.codepen.io/documentation/api/prefill/\r\n\t\t\t\tconst code=getCode()\r\n\t\t\t\tconst sections=code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(getFormatting()).join(\"\\n\")\r\n\t\t\t\t$(\"<form method='post' action='http://codepen.io/pen/define/' target='codepenGeneratedCode'>\").append(\r\n\t\t\t\t\t$(\"<input type='hidden' name='data'>\").val(JSON.stringify({\r\n\t\t\t\t\t\thtml: getSection('html'),\r\n\t\t\t\t\t\tcss: getSection('css'),\r\n\t\t\t\t\t\tjs: getSection('js'),\r\n\t\t\t\t\t\ttitle: code.title,\r\n\t\t\t\t\t}))\r\n\t\t\t\t).appendTo('body').submit().remove()\r\n\t\t\t}),\r\n\t\t\t\" \",\r\n\t\t\t$(\"<button type='button'>\"+i18n('code-output.open.jsfiddle')+\"</button>\").click(function(){\r\n\t\t\t\t// http://doc.jsfiddle.net/api/post.html\r\n\t\t\t\tconst code=getCode()\r\n\t\t\t\tconst sections=code.extractSections({html:'body',css:'paste',js:'paste'})\r\n\t\t\t\tconst getSection=sectionName=>\r\n\t\t\t\t\tsections[sectionName].get(getFormatting()).join(\"\\n\")\r\n\t\t\t\tconst writeSection=sectionName=>\r\n\t\t\t\t\t$(\"<input type='hidden'>\")\r\n\t\t\t\t\t\t.attr('name',sectionName)\r\n\t\t\t\t\t\t.val(getSection(sectionName))\r\n\t\t\t\t$(\"<form method='post' action='http://jsfiddle.net/api/post/library/pure/' target='jsfiddleGeneratedCode'>\").append(\r\n\t\t\t\t\twriteSection('html'),\r\n\t\t\t\t\twriteSection('css'),\r\n\t\t\t\t\twriteSection('js'),\r\n\t\t\t\t\t$(\"<input type='hidden' name='title'>\").val(code.title),\r\n\t\t\t\t\t\"<input type='hidden' name='wrap' value='b'>\"\r\n\t\t\t\t).appendTo('body').submit().remove()\r\n\t\t\t})\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeOutput\r\n","'use strict'\r\n\r\nclass CodeSection {\r\n\tconstructor(filename,mimeType,lines) {\r\n\t\tthis.filename=filename\r\n\t\tthis.mimeType=mimeType\r\n\t\tthis.lines=lines\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.lines.get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.lines.getHtml(formatting)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeSection\r\n","// assumes string is dot-separated, like this: \"some.html.id\"\r\nvar capitalize=require('./capitalize')\r\nmodule.exports=function(s) {\r\n\treturn s.split('.').map((w,i)=>i>0?capitalize(w):w).join('')\r\n}\r\n","// assumes string is lowercase\r\nmodule.exports=function(s){\r\n\treturn s.charAt(0).toUpperCase()+s.slice(1)\r\n}\r\n","// no options\r\nmodule.exports=function(func,wait){\r\n\tvar timeoutId=null\r\n\treturn function(){\r\n\t\tclearTimeout(timeoutId)\r\n\t\ttimeoutId=setTimeout(func,wait)\r\n\t}\r\n}\r\n","module.exports=function(s){\r\n\tvar entityMap={\r\n\t\t'&': '&amp;',\r\n\t\t'<': '&lt;',\r\n\t\t'>': '&gt;',\r\n\t\t'\"': '&quot;',\r\n\t\t\"'\": '&#39;',\r\n\t\t// lodash also escapes `\r\n\t}\r\n\treturn String(s).replace(/[&<>\"']/g,m=>entityMap[m])\r\n}\r\n","module.exports=function(s,n){\r\n\treturn Array(n+1).join(s)\r\n}\r\n","'use strict'\r\n\r\nconst formatNumbersInternal=(numbers,precision,keepDot,noPlus)=>{\r\n\tlet maxPrecision=0\r\n\tif (keepDot) {\r\n\t\tmaxPrecision=1\r\n\t}\r\n\tlet hasNegative=false\r\n\tfor (let i in numbers) {\r\n\t\tlet p\r\n\t\tif (precision!==undefined) {\r\n\t\t\tp=precision\r\n\t\t} else if (numbers[i].precision!==undefined) {\r\n\t\t\tp=numbers[i].precision\r\n\t\t} else {\r\n\t\t\tthrow new Error('formatNumbers received no precision')\r\n\t\t}\r\n\t\tconst number=Number(numbers[i])\r\n\t\tif (number<0) hasNegative=true\r\n\t\tlet s=number.toFixed(p)\r\n\t\tif (p>0) {\r\n\t\t\tp-=s.match(/0*$/)[0].length\r\n\t\t}\r\n\t\tif (p>maxPrecision) {\r\n\t\t\tmaxPrecision=p\r\n\t\t}\r\n\t}\r\n\tconst ss={}\r\n\tfor (let i in numbers) {\r\n\t\tconst number=Number(numbers[i])\r\n\t\tlet s=number.toFixed(maxPrecision)\r\n\t\tif (!noPlus && hasNegative && number>0) {\r\n\t\t\ts='+'+s\r\n\t\t}\r\n\t\tss[i]=s\r\n\t}\r\n\treturn ss\r\n}\r\n\r\nconst formatNumbers=(number,precision)=>formatNumbersInternal(number,precision)\r\nformatNumbers.html =(number,precision)=>formatNumbersInternal(number,precision,false,true)\r\nformatNumbers.js   =(number,precision)=>formatNumbersInternal(number,precision)\r\nformatNumbers.glsl =(number,precision)=>formatNumbersInternal(number,precision,true)\r\n\r\nmodule.exports=formatNumbers\r\n","'use strict'\r\n\r\nmodule.exports=function(inStrings){\r\n\tconst strings={}\r\n\tconst expandRegexp=/^([^{]*)\\{([^}]*)\\}(.*)$/\r\n\tfunction expandIdAndString(id,string) {\r\n\t\tlet match\r\n\t\tif (match=expandRegexp.exec(id)) {\r\n\t\t\tconst idStart=match[1]\r\n\t\t\tconst idMids=match[2].split(',')\r\n\t\t\tconst idEnd=match[3]\r\n\t\t\tif (match=expandRegexp.exec(string)) {\r\n\t\t\t\tconst stringStart=match[1]\r\n\t\t\t\tconst stringMidsStr=match[2]\r\n\t\t\t\tconst stringMids=stringMidsStr.split(',')\r\n\t\t\t\tconst stringEnd=match[3]\r\n\t\t\t\tidMids.forEach((idMid,i)=>{\r\n\t\t\t\t\tconst stringMid=stringMids[i]\r\n\t\t\t\t\tif (stringMidsStr!='') {\r\n\t\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+stringMid+stringEnd)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,stringStart+idMid+stringEnd)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tidMids.forEach(idMid=>{\r\n\t\t\t\t\texpandIdAndString(idStart+idMid+idEnd,string)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tstrings[id]=string\r\n\t\t}\r\n\t}\r\n\tfor (let id in inStrings) {\r\n\t\texpandIdAndString(id,inStrings[id])\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\n\r\nmodule.exports=langStrings=>lang=>{\r\n\tconst defaultLang='en'\r\n\tlang=lang||defaultLang\r\n\tlang=lang.split('-')[0]  // get primary language subtag\r\n\tlet strings=langStrings[lang]\r\n\tif (strings===undefined) {\r\n\t\tlang=defaultLang\r\n\t\tstrings=langStrings[lang]\r\n\t}\r\n\tconst i18n=function(id){\r\n\t\tif (strings[id]!==undefined) {\r\n\t\t\treturn strings[id]\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"undefined string \"+id)\r\n\t\t}\r\n\t}\r\n\ti18n.lang=lang\r\n\ti18n.has=id=>strings[id]!==undefined\r\n\tif (lang=='en') {\r\n\t\ti18n.number=function(n){\r\n\t\t\treturn String(n).replace('-','−')\r\n\t\t}\r\n\t\ti18n.pluralSuffix=function(n){\r\n\t\t\tconst ns=String(n)\r\n\t\t\tif (ns.indexOf('.')<0) {\r\n\t\t\t\tconst nn=Number(n)\r\n\t\t\t\tif (Math.abs(nn)==1) {\r\n\t\t\t\t\treturn '1'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '2'\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn '2'\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (lang=='ru') {\r\n\t\ti18n.number=function(n){\r\n\t\t\treturn String(n).replace('-','−').replace('.',',')\r\n\t\t}\r\n\t\ti18n.pluralSuffix=function(n){\r\n\t\t\tconst ns=String(n)\r\n\t\t\tif (ns.indexOf('.')<0) {\r\n\t\t\t\tconst teen=ns.slice(-2,-1)==='1'\r\n\t\t\t\tif (ns.slice(-1)==='1' && !teen) {\r\n\t\t\t\t\treturn '1'\r\n\t\t\t\t} else if ('234'.indexOf(ns.slice(-1))>=0 && !teen) {\r\n\t\t\t\t\treturn '2'\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '5'\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn '2'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\ti18n.plural=function(n,id){\r\n\t\treturn this(id+'.'+this.pluralSuffix(n))\r\n\t}\r\n\ti18n.numberWithUnits=function(n,unit,abbrFn){\r\n\t\tif (abbrFn===undefined) { // codegen needs its own fn\r\n\t\t\tabbrFn=(abbr,expansion)=>\"<abbr title='\"+escape(expansion)+\"'>\"+abbr+\"</abbr>\" // expansion is html for stuff like s^(-1)\r\n\t\t}\r\n\t\tlet s=this.number(n)\r\n\t\tif (unit!==undefined) {\r\n\t\t\tif (unit.length==1 && /^\\W/.test(unit)) {\r\n\t\t\t\ts+=unit\r\n\t\t\t} else {\r\n\t\t\t\ts+=' ' // nbsp\r\n\t\t\t\tlet abbr\r\n\t\t\t\tif (unit=='1/second') {\r\n\t\t\t\t\tabbr=i18n('units.second.a')+\"<sup>−1</sup>\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\tabbr=i18n('units.'+unit+'.a')\r\n\t\t\t\t}\r\n\t\t\t\tconst expansion=this.plural(n,'units.'+unit)\r\n\t\t\t\ts+=abbrFn(abbr,expansion)\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn s\r\n\t}\r\n\treturn i18n\r\n}\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass InterleaveLines extends Lines {\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet first=true\r\n\t\tconst fp=()=>{\r\n\t\t\tif (first) {\r\n\t\t\t\tfirst=false\r\n\t\t\t} else {\r\n\t\t\t\tout.push('')\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (subOut.length>0) {\r\n\t\t\t\t\tfp()\r\n\t\t\t\t\tout.push(...subOut)\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tfp()\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=InterleaveLines\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\n\r\nclass JsLines extends Lines {\r\n\tprocessStringInGet(s,formatting) {\r\n\t\tif (formatting.jsSemicolons) {\r\n\t\t\treturn s.replace(/^;/,'')\r\n\t\t} else {\r\n\t\t\treturn s.replace(/;$/,'')\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=JsLines\r\n","'use strict'\r\n\r\n/*\r\nCreate lines - short version:\r\n\treturn Lines.bae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\n\treturn SubclassOfLines.b(\r\n\t\tctorArgs\r\n\t).ae(\r\n\t\tline1,\r\n\t\tline2,\r\n\t\t...\r\n\t)\r\n\r\nCreate lines - long version:\r\n\tconst a=Lines.b()\r\n\ta( // shorthand for a.a()\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.a(\r\n\t\tlineAddedAfterLastLine\r\n\t)\r\n\ta.t(\r\n\t\tlineAppendedToLastLine\r\n\t)\r\n\treturn a.e()\r\n\r\nRead lines:\r\n\tformatting={indent:...,refs:...} // optional arg for some code formatting/annotation things\r\n\tlines.get(formatting) // get array of plaintext lines - need array to possibly put it line by line inside an <ol>\r\n\tlines.getHtml(formatting) // get array of html lines\r\n*/\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst repeat=require('./fake-lodash/repeat')\r\n\r\nconst TO={} // TODO Symbol\r\n\r\nclass Lines {\r\n\t// lines private interface:\r\n\tconstructor(data) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError(\"attempted to construct Lines with non-array data argument\")\r\n\t\t}\r\n\t\tthis.data=data\r\n\t}\r\n\tisDataEmpty() {\r\n\t\tfor (let i=0;i<this.data.length;i++) {\r\n\t\t\tconst item=this.data[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tif (!item.isEmpty()) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\tprocessStringInGet(s,formatting) {\r\n\t\treturn s\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tconst out=[]\r\n\t\tlet addTo=false\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item===TO) {\r\n\t\t\t\taddTo=true\r\n\t\t\t} else if (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tif (addTo && subOut.length>0) {\r\n\t\t\t\t\tout.push(out.pop()+subOut.shift())\r\n\t\t\t\t}\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t\taddTo=false\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tlet s=this.processStringInGet(item,formatting)\r\n\t\t\t\tif (formatting.indent!==undefined && formatting.indent!='\\t') {\r\n\t\t\t\t\ts=s.replace(/^(\\t)+/,match=>repeat(formatting.indent,match.length))\r\n\t\t\t\t}\r\n\t\t\t\ts=(html ? escape(s) : s)\r\n\t\t\t\tif (addTo) {\r\n\t\t\t\t\tout.push(out.pop()+s)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tout.push(s)\r\n\t\t\t\t}\r\n\t\t\t\taddTo=false\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn out\r\n\t}\r\n\r\n\t// lines public interface:\r\n\tstatic b() {\r\n\t\tconst data=[]\r\n\t\tconst makeLines=()=>new this(data,...arguments)\r\n\t\tconst a=function(){\r\n\t\t\treturn a.a(...arguments)\r\n\t\t}\r\n\t\ta.a=function(){\r\n\t\t\tdata.push(...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.t=function(){\r\n\t\t\tdata.push(TO,...arguments)\r\n\t\t\treturn this\r\n\t\t}\r\n\t\ta.e=makeLines\r\n\t\ta.ae=function(){\r\n\t\t\treturn this.a(...arguments).e()\r\n\t\t}\r\n\t\treturn a\r\n\t}\r\n\tstatic ba() {\r\n\t\treturn this.b().a(...arguments)\r\n\t}\r\n\tstatic be() {\r\n\t\treturn this.b().e()\r\n\t}\r\n\tstatic bae() {\r\n\t\treturn this.b().a(...arguments).e()\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tget(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,false)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\tif (formatting===undefined) formatting={}\r\n\t\treturn this.doGet(formatting,true)\r\n\t}\r\n\tcount() {\r\n\t\treturn this.doGet({},false).length // can be faster b/c don't need to output stuff\r\n\t}\r\n\r\n\t// TODO make HtmlLines\r\n\tstatic html(strings/*,...values*/) {\r\n\t\t// html template tag\r\n\t\t// usage example for attributes: Lines.html`<input type=text value=${value}>`\r\n\t\t// usage example for elements: Lines.html`<option>${option}</option>`\r\n\t\treturn strings.reduce((r,s,i)=>{\r\n\t\t\tlet v=arguments[i]\r\n\t\t\tswitch (r.slice(-1)) {\r\n\t\t\tcase '=':\r\n\t\t\t\tif (v===false) {\r\n\t\t\t\t\treturn r.replace(/\\s+[a-zA-Z0-9-]+=$/,'')+s // TODO more permitting attr name regexp\r\n\t\t\t\t} else if (v===true) {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t}\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;')\r\n\t\t\t\tif (v=='') {\r\n\t\t\t\t\treturn r.replace(/=$/,'')+s\r\n\t\t\t\t} else if (!/[\\s\"'=<>`]/.test(v)) {\r\n\t\t\t\t\treturn r+v+s\r\n\t\t\t\t} else if (!/'/.test(v)) {\r\n\t\t\t\t\treturn r+\"'\"+v+\"'\"+s\r\n\t\t\t\t} else {\r\n\t\t\t\t\tv=v.replace(/\"/g,'&quot;')\r\n\t\t\t\t\treturn r+'\"'+v+'\"'+s\r\n\t\t\t\t}\r\n\t\t\tcase '>':\r\n\t\t\t\tv=String(v).replace(/&/g,'&amp;').replace(/</g,'&lt;')\r\n\t\t\t\treturn r+v+s\r\n\t\t\t}\r\n\t\t\tthrow new Error(\"invalid character before substitution\")\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=Lines\r\n","'use strict'\r\n\r\nconst WrapLines=require('./wrap-lines')\r\n\r\nclass NoseWrapLines extends WrapLines {\r\n\tisEmpty() {\r\n\t\treturn this.isDataEmpty()\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tif (this.isEmpty()) {\r\n\t\t\treturn []\r\n\t\t} else {\r\n\t\t\treturn super.doGet(formatting,html)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=NoseWrapLines\r\n","'use strict'\r\n\r\n/*\r\nuse Option.<Class>.make(<description w/o className>)(data) to create Option object\r\n\tTHIS WON'T WORK WITH Arrays/Groups!\r\n\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\r\n\r\nconst Option={}\r\n\r\n// abstract classes\r\n\r\nOption.Base = class {\r\n\tstatic make(name) {\r\n\t\tlet nScalars=0, nArrays=0, nObjects=0\r\n\t\tlet scalarArg, arrayArg=[], objectArg={}\r\n\t\tfor (let i=1;i<arguments.length;i++) {\r\n\t\t\tlet arg=arguments[i]\r\n\t\t\tif (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\r\n\t\t\t\tif (nScalars++==0) scalarArg=arg\r\n\t\t\t} else if (Array.isArray(arg)) {\r\n\t\t\t\tif (nArrays++==0) arrayArg=arg\r\n\t\t\t} else if (arg instanceof Object) {\r\n\t\t\t\tif (nObjects++==0) objectArg=arg\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst optionClass=this\r\n\t\tconst settings=this.collectArgs(scalarArg,arrayArg,objectArg)\r\n\t\treturn function(){\r\n\t\t\treturn new optionClass(name,settings,...arguments)\r\n\t\t}\r\n\t}\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn settings\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tthis.name=name\r\n\t\tthis.updateCallback=updateCallback\r\n\t\tthis.fullName=fullName\r\n\t\tthis._$=null\r\n\t\tthis.isVisible=()=>true\r\n\t\tthis.fullNamesAffectingVisibility=[]\r\n\t\tif (settings.visibilityData!==undefined) {\r\n\t\t\tthis.isVisible=()=>{\r\n\t\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\t\tconst value=optionByFullName[testName].value\r\n\t\t\t\t\tif (settings.visibilityData[testName].indexOf(value)<0) {\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\tfor (let testName in settings.visibilityData) {\r\n\t\t\t\tthis.fullNamesAffectingVisibility.push(testName)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget $() {\r\n\t\treturn this._$\r\n\t}\r\n\tset $($) {\r\n\t\tthis._$=$\r\n\t\tthis.updateVisibility()\r\n\t}\r\n\tupdateVisibility() {\r\n\t\tif (this.$) this.$.toggle(this.isVisible())\r\n\t}\r\n\tshortenExport(data) { // used by parent\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\treturn data.value\r\n\t\t} else {\r\n\t\t\treturn data\r\n\t\t}\r\n\t}\r\n\tshortenExportAssign(data,parentData,name) {\r\n\t\tconst dataKeys=Object.keys(data)\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\tparentData[name]=data.value\r\n\t\t} else if (dataKeys.length>0) {\r\n\t\t\tparentData[name]=data\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Input = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.defaultValue===undefined) settings.defaultValue=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.defaultValue=settings.defaultValue\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdata=data.value\r\n\t\t}\r\n\t\tif (data!==undefined) {\r\n\t\t\tthis._value=data\r\n\t\t} else {\r\n\t\t\tthis._value=this.defaultValue\r\n\t\t}\r\n\t}\r\n\tget value() {\r\n\t\treturn this._value\r\n\t}\r\n\tset value(value) {\r\n\t\tthis._value=value\r\n\t\tthis.updateCallback()\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value\r\n\t\treturn data\r\n\t}\r\n}\r\n\r\nOption.Boolean = class extends Option.Input {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\treturn super.collectArgs(!!scalarArg,arrayArg,settings)\r\n\t}\r\n\tfix() {\r\n\t\treturn this.value\r\n\t}\r\n}\r\n\r\nOption.NonBoolean = class extends Option.Input {\r\n\tfix() {\r\n\t\tconst value=this.value\r\n\t\treturn { // can't use fixed value in boolean context\r\n\t\t\tname: this.name,\r\n\t\t\tvalue,\r\n\t\t\tvalueOf() { return value },\r\n\t\t\ttoString() { return String(value) },\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Factor = class extends Option.NonBoolean {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableValues===undefined) settings.availableValues=arrayArg\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableValues[0]\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableValues=settings.availableValues\r\n\t}\r\n}\r\n\r\nOption.Number = class extends Option.NonBoolean { // requires precision, gives step = Math.pow(0.1,precision).toFixed(precision)\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.availableMin===undefined) settings.availableMin=arrayArg[0]\r\n\t\tif (settings.availableMax===undefined) settings.availableMax=arrayArg[1]\r\n\t\tif (scalarArg===undefined) scalarArg=settings.availableMin\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableMin=settings.availableMin\r\n\t\tthis.availableMax=settings.availableMax\r\n\t\tthis.unit=settings.unit\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tfixed.precision=this.precision\r\n\t\tfixed.unit=this.unit\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.Collection = class extends Option.Base {\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.entries=settings.descriptions.map(x=>{\r\n\t\t\tconst subName=x[1]\r\n\t\t\tlet subData\r\n\t\t\tif (typeof data == 'object') subData=data[subName]\r\n\t\t\treturn makeEntry(x,fullName,subData,isInsideArray) // nested option\r\n\t\t})\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tentry.shortenExportAssign(entry.export(),data,entry.name)\r\n\t\t})\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\tconst fixedEntries=[]\r\n\t\tconst fixed={\r\n\t\t\tname: this.name,\r\n\t\t\tentries: fixedEntries,\r\n\t\t}\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tfixedEntries.push(fixed[entry.name]=entry.fix())\r\n\t\t})\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\n// concrete classes\r\n\r\nOption.Void = class extends Option.Base { // useful as array entry w/o settings\r\n\texport() {\r\n\t\treturn {}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Checkbox = class extends Option.Boolean {}\r\n\r\nOption.Select = class extends Option.Factor {}\r\n\r\nOption.Text = class extends Option.Factor {}\r\n\r\nOption.Int = class extends Option.Number {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n}\r\n\r\nOption.Float = class extends Option.Number {\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tif (settings.precision!==undefined) {\r\n\t\t\tthis.precision=settings.precision\r\n\t\t} else {\r\n\t\t\tif (this.availableMax>=100) {\r\n\t\t\t\tthis.precision=1\r\n\t\t\t} else if (this.availableMax>=10) {\r\n\t\t\t\tthis.precision=2\r\n\t\t\t} else {\r\n\t\t\t\tthis.precision=3\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nOption.Root = class extends Option.Collection {}\r\n\r\nOption.Group = class extends Option.Collection {}\r\n\r\nOption.Array = class extends Option.Base { // TODO consider extending Collection\r\n\tstatic collectArgs(scalarArg,arrayArg,settings) {\r\n\t\tsettings=Object.create(settings)\r\n\t\tif (settings.descriptions===undefined) settings.descriptions=arrayArg\r\n\t\tif (settings.typePropertyName===undefined) settings.typePropertyName=scalarArg\r\n\t\treturn super.collectArgs(scalarArg,arrayArg,settings)\r\n\t}\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tsuper(...arguments)\r\n\t\tthis.availableConstructors=new Map\r\n\t\tsettings.descriptions.forEach(x=>{ // TODO test array inside array\r\n\t\t\tconst type=x[1]\r\n\t\t\tconst ctor=subData=>makeEntry(x,fullName,subData,true)\r\n\t\t\tthis.availableConstructors.set(type,ctor)\r\n\t\t})\r\n\t\tif (settings.typePropertyName!==undefined) {\r\n\t\t\tthis.typePropertyName=settings.typePropertyName\r\n\t\t} else {\r\n\t\t\tthis.typePropertyName='type'\r\n\t\t}\r\n\t\t// populate array entries from data:\r\n\t\tthis._entries=[]\r\n\t\tlet subDatas=[]\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tsubDatas=data\r\n\t\t} else if (typeof data == 'object') {\r\n\t\t\tsubDatas=data.value\r\n\t\t}\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\tfor (let i=0;i<subDatas.length;i++) {\r\n\t\t\tconst subData=subDatas[i]\r\n\t\t\tlet subType=defaultType\r\n\t\t\tif (typeof subData == 'object' && subData[this.typePropertyName]!==undefined) {\r\n\t\t\t\tsubType=subData[this.typePropertyName]\r\n\t\t\t}\r\n\t\t\tlet subCtor=this.availableConstructors.get(subType)\r\n\t\t\tif (subCtor) {\r\n\t\t\t\tthis._entries.push(subCtor(subData))\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget availableTypes() {\r\n\t\tconst types=[]\r\n\t\tthis.availableConstructors.forEach((_,type)=>{\r\n\t\t\ttypes.push(type)\r\n\t\t})\r\n\t\treturn types\r\n\t}\r\n\tget entries() {\r\n\t\treturn this._entries\r\n\t}\r\n\tset entries(entries) {\r\n\t\tthis._entries=entries\r\n\t\tthis.updateCallback()\r\n\t}\r\n\taddEntry(type) {\r\n\t\tconst entry=this.availableConstructors.get(type)()\r\n\t\tthis._entries.push(entry)\r\n\t\tthis.updateCallback()\r\n\t\treturn entry\r\n\t}\r\n\texport() {\r\n\t\tlet defaultType=this.availableTypes[0]\r\n\t\treturn {\r\n\t\t\tvalue: this._entries.map(entry=>{\r\n\t\t\t\tconst subData=entry.export()\r\n\t\t\t\tconst subType=entry.name\r\n\t\t\t\tif (subType!=defaultType) subData[this.typePropertyName]=subType\r\n\t\t\t\treturn entry.shortenExport(subData)\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t\tentries: this._entries.map(entry=>{\r\n\t\t\t\tconst subFixed=entry.fix()\r\n\t\t\t\tif (typeof subFixed == 'object') subFixed[this.typePropertyName]=entry.name\r\n\t\t\t\treturn subFixed\r\n\t\t\t}),\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nmodule.exports=lang=>strings=>{\r\n\tconst additionalStringsPrefix='options-output'\r\n\tconst additionalStrings={\r\n\t\ten: {\r\n\t\t\t'reset': \"Reset\",\r\n\t\t\t'drag': \"Drag or press ↑/↓ while in focus to reorder\",\r\n\t\t\t'delete': \"Delete\",\r\n\t\t},\r\n\t\tru: {\r\n\t\t\t'reset': \"Сбросить\",\r\n\t\t\t'drag': \"Перетаскивайте или нажимайте ↑/↓, пока элемент в фокусе, чтобы изменить порядок\",\r\n\t\t\t'delete': \"Удалить\",\r\n\t\t}\r\n\t}\r\n\tfor (let id in additionalStrings[lang]) {\r\n\t\tstrings[additionalStringsPrefix+'.'+id]=additionalStrings[lang][id]\r\n\t}\r\n\treturn strings\r\n}\r\n","'use strict'\r\n\r\nconst formatNumbers=require('./format-numbers')\r\nconst Option=require('./option-classes')\r\n\r\nclass OptionsOutput {\r\n\tconstructor(options,generateId,i18n) {\r\n\t\tconst optionClassWriters=new Map\r\n\t\tthis.setOptionClassWriters(optionClassWriters)\r\n\t\tfunction write(option) {\r\n\t\t\tlet optionProto=option\r\n\t\t\twhile (optionProto=Object.getPrototypeOf(optionProto)) {\r\n\t\t\t\tconst optionClassWriter=optionClassWriters.get(optionProto.constructor)\r\n\t\t\t\tif (optionClassWriter) {\r\n\t\t\t\t\treturn optionClassWriter(option,write,i18n,generateId)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// public prop:\r\n\t\tthis.$output=write(options.root)\r\n\t}\r\n\t// override this fn for custom writers\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\toptionClassWriters.set(Option.Root,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='options-output'>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Group,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Void,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\")\r\n\t\t\t\t.html(i18n('options.'+option.fullName))\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Checkbox,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option no-lead'>\").append(\r\n\t\t\t\t$(\"<input type='checkbox' id='\"+id+\"'>\")\r\n\t\t\t\t\t.prop('checked',option.value)\r\n\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\toption.value=$(this).prop('checked')\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" <label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\"</label>\"\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Select,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst valueId=value=>'options.'+option.fullName+'.'+value\r\n\t\t\tconst valueInfoId=value=>'options-info.'+option.fullName+'.'+value\r\n\t\t\tconst id=generateId()\r\n\t\t\tlet $select\r\n\t\t\toption.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label> \",\r\n\t\t\t\t$select=$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>\r\n\t\t\t\t\t\t$(\"<option>\").val(availableValue).html(i18n(valueId(availableValue)))\r\n\t\t\t\t\t)\r\n\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\toption.value=this.value\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\tif (option.availableValues.some(availableValue=>i18n.has(valueInfoId(availableValue)))) {\r\n\t\t\t\tlet $tip,$tipContent\r\n\t\t\t\toption.$.append(\r\n\t\t\t\t\t\" \",\r\n\t\t\t\t\t$tip=$(\"<span class='tip-info'>\").append(\r\n\t\t\t\t\t\t$tipContent=$(\"<span class='tip-content'>\")\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\tconst handler=function(){\r\n\t\t\t\t\tif (i18n.has(valueInfoId(this.value))) {\r\n\t\t\t\t\t\t$tipContent.html(i18n(valueInfoId(this.value)))\r\n\t\t\t\t\t\t$tip.show()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$tip.hide()\r\n\t\t\t\t\t\t$tipContent.empty()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\thandler.call($select[0])\r\n\t\t\t\t$select.change(handler)\r\n\t\t\t}\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Text,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\tconst listId=generateId()\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label> \",\r\n\t\t\t\t$(\"<input type='text' id='\"+id+\"' list='\"+listId+\"' />\")\r\n\t\t\t\t\t.val(option.value)\r\n\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\toption.value=this.value\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<datalist id='\"+listId+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(availableValue=>$(\"<option>\").text(availableValue))\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Number,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst p=option.precision\r\n\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\tconst setInputAttrsAndListeners=($input,getOtherInput)=>setInputAttrs($input)\r\n\t\t\t\t.val(option.value)\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\tconst $that=getOtherInput()\r\n\t\t\t\t\t\t$that.val(this.value)\r\n\t\t\t\t\t\toption.value=parseFloat(this.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\tconst id=generateId()\r\n\t\t\tlet $sliderInput,$numberInput\r\n\t\t\tlet $rangeMinInput,$rangeMaxInput\r\n\t\t\tconst fmt=formatNumbers({\r\n\t\t\t\tmin: option.availableMin,\r\n\t\t\t\tmax: option.availableMax\r\n\t\t\t},option.precision)\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\",\r\n\t\t\t\t\" <span class='min'>\"+i18n.numberWithUnits(fmt.min,option.unit)+\"</span> \",\r\n\t\t\t\t$sliderInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='range' id='\"+id+\"'>\"),\r\n\t\t\t\t\t()=>$numberInput\r\n\t\t\t\t),\r\n\t\t\t\t\" <span class='max'>\"+i18n.numberWithUnits(fmt.max,option.unit)+\"</span> \",\r\n\t\t\t\t$numberInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='number' required>\"),\r\n\t\t\t\t\t()=>$sliderInput\r\n\t\t\t\t),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t$sliderInput.val(option.defaultValue).change()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.Array,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tlet $dragged=null\r\n\t\t\tlet $entries\r\n\t\t\tconst updateArrayEntries=()=>{\r\n\t\t\t\toption.entries=$entries.children().map(function(){\r\n\t\t\t\t\treturn $(this).data('option')\r\n\t\t\t\t}).get()\r\n\t\t\t}\r\n\t\t\tconst writeDraggableOption=option=>{\r\n\t\t\t\t// have to make drag handler 'draggable', not the whole item\r\n\t\t\t\t// because inputs and labels don't like to be inside 'draggable'\r\n\t\t\t\t// http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\r\n\t\t\t\tconst moveUp=$moved=>{\r\n\t\t\t\t\t$moved.prev().before($moved)\r\n\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t}\r\n\t\t\t\tconst moveDown=$moved=>{\r\n\t\t\t\t\t$moved.next().after($moved)\r\n\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t}\r\n\t\t\t\treturn $(\"<div class='draggable-with-handle'>\").data('option',option).append(\r\n\t\t\t\t\t$(\"<div draggable='true' tabindex='0' title='\"+i18n('options-output.drag')+\"'>\")\r\n\t\t\t\t\t\t.on('dragstart',function(ev){\r\n\t\t\t\t\t\t\t$dragged=$(this).parent()\r\n\t\t\t\t\t\t\tev.originalEvent.dataTransfer.effectAllowed='move'\r\n\t\t\t\t\t\t\tev.originalEvent.dataTransfer.setData('Text',name)\r\n\t\t\t\t\t\t\tif (ev.originalEvent.dataTransfer.setDragImage) { // doesn't work in IE\r\n\t\t\t\t\t\t\t\tev.originalEvent.dataTransfer.setDragImage($dragged[0],0,0)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t$dragged.addClass('ghost')\r\n\t\t\t\t\t\t\t},0)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.keydown(function(ev){\r\n\t\t\t\t\t\t\tconst $handle=$(this)\r\n\t\t\t\t\t\t\tconst $sorted=$handle.parent()\r\n\t\t\t\t\t\t\tif (ev.keyCode==38) {\r\n\t\t\t\t\t\t\t\tmoveUp($sorted)\r\n\t\t\t\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t} else if (ev.keyCode==40) {\r\n\t\t\t\t\t\t\t\tmoveDown($sorted)\r\n\t\t\t\t\t\t\t\t$handle.focus()\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\twriteOption(option),\r\n\t\t\t\t\t$(\"<div tabindex='0' class='delete' title='\"+i18n('options-output.delete')+\"'>\").click(function(){\r\n\t\t\t\t\t\t$(this).parent().remove()\r\n\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t}).keydown(function(ev){\r\n\t\t\t\t\t\tif (ev.keyCode==13 || ev.keyCode==32) {\r\n\t\t\t\t\t\t\t$(this).parent().remove()\r\n\t\t\t\t\t\t\tupdateArrayEntries()\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t).on('dragover',function(ev){\r\n\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t\tev.originalEvent.dataTransfer.dropEffect='move'\r\n\t\t\t\t\tconst $target=$(this)\r\n\t\t\t\t\tif ($dragged) {\r\n\t\t\t\t\t\tif ($target.next().is($dragged)) {\r\n\t\t\t\t\t\t\tconst dh=$dragged.height()\r\n\t\t\t\t\t\t\tconst y=ev.pageY-$target.offset().top\r\n\t\t\t\t\t\t\tif (y<dh) {\r\n\t\t\t\t\t\t\t\tmoveUp($dragged)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if ($target.nextAll().is($dragged)) {\r\n\t\t\t\t\t\t\tmoveUp($dragged)\r\n\t\t\t\t\t\t} else if ($target.prev().is($dragged)) {\r\n\t\t\t\t\t\t\tconst th=$target.height()\r\n\t\t\t\t\t\t\tconst dh=$dragged.height()\r\n\t\t\t\t\t\t\tconst y=ev.pageY-$target.offset().top\r\n\t\t\t\t\t\t\tif (y>th-dh) {\r\n\t\t\t\t\t\t\t\tmoveDown($dragged)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if ($target.prevAll().is($dragged)) {\r\n\t\t\t\t\t\t\tmoveDown($dragged)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).on('drop',function(ev){\r\n\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t}).on('dragend',function(ev){\r\n\t\t\t\t\tev.preventDefault()\r\n\t\t\t\t\tif ($dragged) {\r\n\t\t\t\t\t\t$dragged.removeClass('ghost')\r\n\t\t\t\t\t\t$dragged=null\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\toption.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\").append(\r\n\t\t\t\t$entries=$(\"<div>\").append(option.entries.map(writeDraggableOption))\r\n\t\t\t)\r\n\t\t\tconst $buttons=$(\"<div>\")\r\n\t\t\toption.availableTypes.forEach((type,i)=>{\r\n\t\t\t\tif (i) $buttons.append(\" \")\r\n\t\t\t\t$buttons.append(\r\n\t\t\t\t\t$(\"<button type='button'>\").html(\r\n\t\t\t\t\t\ti18n('options.'+option.fullName+'.'+type+'.add')\r\n\t\t\t\t\t).click(function(){\r\n\t\t\t\t\t\tconst entry=option.addEntry(type)\r\n\t\t\t\t\t\t$entries.append(writeDraggableOption(entry))\r\n\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t})\r\n\t\t\toption.$.append($buttons)\r\n\t\t\treturn option.$\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nclass Options {\r\n\tconstructor(data) { // data = imported values, import is done in ctor to avoid calling updateCallback later\r\n\t\tthis.updateCallback=undefined // general update callback for stuff like regenerating the code\r\n\t\tconst simpleUpdateCallback=()=>{\r\n\t\t\tif (this.updateCallback) this.updateCallback()\r\n\t\t}\r\n\t\tconst Option=this.optionClasses\r\n\t\tconst optionByFullName={}\r\n\t\tconst optionsWithVisibilityAffectedByFullName={}\r\n\t\tconst makeEntry=(description,parentfullName,data,isInsideArray)=>{\r\n\t\t\tconst className=description[0]\r\n\t\t\tif (Option[className]===undefined) {\r\n\t\t\t\tthrow new Error(`invalid option type '${className}'`)\r\n\t\t\t}\r\n\t\t\tconst name=description[1]\r\n\t\t\tlet fullName=name\r\n\t\t\tif (parentfullName!==null) {\r\n\t\t\t\tfullName=parentfullName+'.'+name\r\n\t\t\t}\r\n\t\t\tconst makeArgs=description.slice(1)\r\n\t\t\tlet updateCallback\r\n\t\t\tif (isInsideArray) {\r\n\t\t\t\tupdateCallback=simpleUpdateCallback\r\n\t\t\t} else {\r\n\t\t\t\tupdateCallback=()=>{\r\n\t\t\t\t\tif (optionsWithVisibilityAffectedByFullName[fullName]!==undefined) {\r\n\t\t\t\t\t\toptionsWithVisibilityAffectedByFullName[fullName].forEach(option=>{\r\n\t\t\t\t\t\t\toption.updateVisibility()\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.updateCallback) this.updateCallback()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst option=Option[className].make(...makeArgs)(\r\n\t\t\t\tdata,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray\r\n\t\t\t)\r\n\t\t\tif (!isInsideArray) {\r\n\t\t\t\toptionByFullName[fullName]=option\r\n\t\t\t\toption.fullNamesAffectingVisibility.forEach(testName=>{\r\n\t\t\t\t\tif (optionsWithVisibilityAffectedByFullName[testName]===undefined) {\r\n\t\t\t\t\t\toptionsWithVisibilityAffectedByFullName[testName]=[]\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptionsWithVisibilityAffectedByFullName[testName].push(option)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\treturn option\r\n\t\t}\r\n\t\tthis.root=Option.Root.make(null,this.entriesDescription)(\r\n\t\t\tdata,null,optionByFullName,simpleUpdateCallback,makeEntry,false\r\n\t\t)\r\n\t}\r\n\t// methods to be redefined by subclasses\r\n\t// TODO make them static?\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn []\r\n\t}\r\n\t// public methods\r\n\texport() {\r\n\t\treturn this.root.shortenExport(this.root.export())\r\n\t}\r\n\tfix() {\r\n\t\treturn this.root.fix()\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass RefLines extends Lines {\r\n\tconstructor(data,ref) {\r\n\t\tsuper(data)\r\n\t\tthis.ref=ref\r\n\t}\r\n\tstatic parse(s) {\r\n\t\tconst a=Lines.ba(\"\")\r\n\t\tconst re=/^(.*?)\\[([^\\]]+)\\]\\[([^\\]]+)\\]/\r\n\t\tfor (;s.length>0;) {\r\n\t\t\tconst match=re.exec(s)\r\n\t\t\tif (match) {\r\n\t\t\t\ta.t(match[1])\r\n\t\t\t\ta.t(this.b(match[3]).ae(match[2]))\r\n\t\t\t\ts=s.substr(match[0].length)\r\n\t\t\t} else {\r\n\t\t\t\ta.t(s)\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tconst plainOut=super.doGet(formatting,html)\r\n\t\tlet href\r\n\t\tif (html && typeof formatting.refs == 'object') {\r\n\t\t\thref=formatting.refs[this.ref]\r\n\t\t}\r\n\t\tif (href!==undefined) {\r\n\t\t\treturn plainOut.map(s=>\"<a href='\"+escape(href)+\"'>\"+s+\"</a>\")\r\n\t\t} else {\r\n\t\t\treturn plainOut\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=RefLines\r\n","'use strict'\r\n\r\nconst Lines=require('./lines')\r\nconst NoseWrapLines=require('./nose-wrap-lines')\r\nconst CodeSection=require('./code-section')\r\n\r\nclass WebCode {\r\n\t// public:\r\n\tget filename() {\r\n\t\treturn this.basename+'.html'\r\n\t}\r\n\tget mimeType() {\r\n\t\treturn 'text/html'\r\n\t}\r\n\tget(formatting) {\r\n\t\treturn this.getLines().get(formatting)\r\n\t}\r\n\tgetHtml(formatting) {\r\n\t\treturn this.getLines().getHtml(formatting)\r\n\t}\r\n\textractSections(sectionModes) {\r\n\t\tif (sectionModes===undefined) {\r\n\t\t\tsectionModes={}\r\n\t\t}\r\n\t\tlet stylePlaceLines=NoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines)\r\n\t\tlet styleExtractLines=Lines.be()\r\n\t\tif (sectionModes.css=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tstylePlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tstylePlaceLines=Lines.bae(\"<!-- <style> \"+this.getSectionPasteComment('css')+\" </style> -->\")\r\n\t\t\t}\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t} else if (sectionModes.css=='file') {\r\n\t\t\tstylePlaceLines=Lines.bae(Lines.html`<link rel=stylesheet href=${this.basename+'.css'}>`)\r\n\t\t\tstyleExtractLines=this.cachedStyleLines\r\n\t\t}\r\n\t\tlet scriptPlaceLines=NoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\tlet scriptExtractLines=Lines.be()\r\n\t\tif (sectionModes.js=='paste') {\r\n\t\t\tif (sectionModes.html=='body') {\r\n\t\t\t\tscriptPlaceLines=Lines.be()\r\n\t\t\t} else {\r\n\t\t\t\tscriptPlaceLines=Lines.bae(\"<!-- <script> \"+this.getSectionPasteComment('js')+\" </script> -->\")\r\n\t\t\t}\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t} else if (sectionModes.js=='file') {\r\n\t\t\tscriptPlaceLines=Lines.bae(Lines.html`<script src=${this.basename+'.js'}></script>`)\r\n\t\t\tscriptExtractLines=this.cachedScriptLines\r\n\t\t}\r\n\t\tlet htmlExtractLines\r\n\t\tif (sectionModes.html=='body') {\r\n\t\t\thtmlExtractLines=this.getBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t} else {\r\n\t\t\thtmlExtractLines=this.getFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines)\r\n\t\t}\r\n\t\tconst type=sectionName=>'text/'+(sectionName=='js'?'javascript':sectionName)\r\n\t\treturn {\r\n\t\t\thtml: new CodeSection(this.filename,type('html'),htmlExtractLines),\r\n\t\t\tcss:  new CodeSection(this.basename+'.css',type('css'),styleExtractLines),\r\n\t\t\tjs:   new CodeSection(this.basename+'.js',type('js'),scriptExtractLines),\r\n\t\t}\r\n\t}\r\n\t// get title()\r\n\r\n\t// private:\r\n\tgetLines() {\r\n\t\treturn this.getFullHtmlSectionLines(\r\n\t\t\tNoseWrapLines.b(\"<style>\",\"</style>\").ae(this.cachedStyleLines),\r\n\t\t\tNoseWrapLines.b(\"<script>\",\"</script>\").ae(this.cachedScriptLines)\r\n\t\t)\r\n\t}\r\n\tgetFullHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\tconst a=Lines.b()\r\n\t\ta(\"<!DOCTYPE html>\")\r\n\t\tif (this.lang!==null) {\r\n\t\t\ta(Lines.html`<html lang=${this.lang}>`)\r\n\t\t} else {\r\n\t\t\ta(\"<html>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\t\"<head>\",\r\n\t\t\t\"<meta charset=utf-8>\"\r\n\t\t)\r\n\t\tif (this.title!==null) {\r\n\t\t\ta(\"<title>\"+this.title+\"</title>\")\r\n\t\t}\r\n\t\ta(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\t\"</head>\",\r\n\t\t\t\"<body>\",\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines,\r\n\t\t\t\"</body>\",\r\n\t\t\t\"</html>\"\r\n\t\t)\r\n\t\treturn a.e()\r\n\t}\r\n\tgetBodyHtmlSectionLines(stylePlaceLines,scriptPlaceLines) {\r\n\t\treturn Lines.bae(\r\n\t\t\tstylePlaceLines,\r\n\t\t\tthis.cachedHeadLines,\r\n\t\t\tthis.cachedBodyLines,\r\n\t\t\tscriptPlaceLines\r\n\t\t)\r\n\t}\r\n\tget cachedStyleLines()  { if (!this._styleLines)  this._styleLines =this.styleLines;  return this._styleLines  }\r\n\tget cachedHeadLines()   { if (!this._headLines)   this._headLines  =this.headLines;   return this._headLines   }\r\n\tget cachedBodyLines()   { if (!this._bodyLines)   this._bodyLines  =this.bodyLines;   return this._bodyLines   }\r\n\tget cachedScriptLines() { if (!this._scriptLines) this._scriptLines=this.scriptLines; return this._scriptLines }\r\n\r\n\t// to be redefined in subclasses:\r\n\tget basename() { // filename base\r\n\t\treturn 'source'\r\n\t}\r\n\tget lang() { // language tag for <html lang=xx> or null to skip it - likely read from i18n\r\n\t\treturn null\r\n\t}\r\n\tget title() { // page title or null to skip it\r\n\t\treturn null\r\n\t}\r\n\tget styleLines() { // contents of <style>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget headLines() { // contents of <head> following <style>, goes to <body> in html body mode\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget bodyLines() { // contents of <body> preceding <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tget scriptLines() { // contents of <script>\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetSectionPasteComment(sectionName) { // section placeholder comment in paste mode - likely to be overridden with i18n\r\n\t\treturn sectionName+\" goes here\"\r\n\t}\r\n}\r\n\r\nmodule.exports=WebCode\r\n","'use strict'\r\n\r\nconst escape=require('./fake-lodash/escape')\r\nconst Lines=require('./lines')\r\n\r\nclass WrapLines extends Lines {\r\n\tconstructor(data) {\r\n\t\tsuper(data)\r\n\t\tthis.wrappers=[]\r\n\t\tfor (let i=1;i<arguments.length;i++) {\r\n\t\t\tthis.wrappers.push(arguments[i])\r\n\t\t}\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn false\r\n\t}\r\n\tdoGet(formatting,html) {\r\n\t\tlet indent='\\t'\r\n\t\tif (formatting.indent!==undefined) {\r\n\t\t\tindent=formatting.indent\r\n\t\t}\r\n\t\tconst out=[]\r\n\t\tlet i=0\r\n\t\tconst pushWrapper=()=>{\r\n\t\t\tconst item=this.wrappers[i]\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut)\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(s)\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t\tpushWrapper()\r\n\t\tthis.data.forEach(item=>{\r\n\t\t\tif (item instanceof Lines) {\r\n\t\t\t\tconst subOut=item.doGet(formatting,html)\r\n\t\t\t\tout.push(...subOut.map(s=>indent+s))\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof item == 'string') {\r\n\t\t\t\tconst s=(html ? escape(item) : item)\r\n\t\t\t\tout.push(indent+s)\r\n\t\t\t\tif (this.wrappers.length!=2) {\r\n\t\t\t\t\tpushWrapper()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (this.wrappers.length==2) {\r\n\t\t\tpushWrapper()\r\n\t\t}\r\n\t\treturn out\r\n\t}\r\n}\r\n\r\nmodule.exports=WrapLines\r\n","'use strict'\r\n\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst RefLines=require('crnx-base/ref-lines')\r\nconst Feature=require('./feature')\r\n\r\nclass AudioContext extends Feature {\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\ta(\r\n\t\t\t\tRefLines.parse(\"// \"+i18n('comment.context')),\r\n\t\t\t\t\"var ctx=new (AudioContext || webkitAudioContext);\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=AudioContext\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst Feature=require('./feature')\r\n\r\nclass Canvas extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tconst a=Lines.b()\r\n\t\tif (featureContext.canvas) {\r\n\t\t\ta(\r\n\t\t\t\t\"<div>\",\r\n\t\t\t\tLines.html`\t<canvas id=my.canvas width=${this.options.width} height=${this.options.height}></canvas>`,\r\n\t\t\t\t\"</div>\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (featureContext.canvas) {\r\n\t\t\ta(\r\n\t\t\t\t\"var canvas=document.getElementById('my.canvas');\",\r\n\t\t\t\t\"var canvasContext=canvas.getContext('2d');\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopPreLines(featureContext,i18n) {\r\n\t\tconst a=JsLines.b()\r\n\t\tconst writeStyle=(canvasContextProperty,colorOption)=>{\r\n\t\t\tconst cs=['r','g','b']\r\n\t\t\tconst color=cs.map(c=>colorOption[c]+\"%\").join()\r\n\t\t\tconst isBlack=cs.every(c=>colorOption[c]==0)\r\n\t\t\tif (colorOption.a==100) {\r\n\t\t\t\tif (!isBlack) {\r\n\t\t\t\t\ta(\"canvasContext.\"+canvasContextProperty+\"='rgb(\"+color+\")';\")\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ta(\"canvasContext.\"+canvasContextProperty+\"='rgba(\"+color+\",\"+(colorOption.a/100).toFixed(2)+\")';\")\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (featureContext.canvas) {\r\n\t\t\tif (this.options.background.type=='clear') {\r\n\t\t\t\ta(\"canvasContext.clearRect(0,0,canvas.width,canvas.height);\")\r\n\t\t\t} else {\r\n\t\t\t\twriteStyle('fillStyle',this.options.background.color)\r\n\t\t\t\ta(\"canvasContext.fillRect(0,0,canvas.width,canvas.height);\")\r\n\t\t\t}\r\n\t\t\tif (this.options.line.width!=1.0) {\r\n\t\t\t\ta(\"canvasContext.lineWidth=\"+this.options.line.width+\";\")\r\n\t\t\t}\r\n\t\t\twriteStyle('strokeStyle',this.options.line.color)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n}\r\n\r\nmodule.exports=Canvas\r\n","'use strict'\r\n\r\nconst BaseCodeOutput=require('crnx-base/code-output')\r\n\r\nclass CodeOutput extends BaseCodeOutput {\r\n\tget refs() {\r\n\t\treturn {\r\n\t\t\tcontext:     'https://www.w3.org/TR/webaudio/#AudioContext',\r\n\t\t\tsource:      'https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode',\r\n\t\t\tgain:        'https://www.w3.org/TR/webaudio/#GainNode',\r\n\t\t\tpanner:      'https://www.w3.org/TR/webaudio/#the-stereopannernode-interface',\r\n\t\t\tbiquad:      'https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface',\r\n\t\t\tconvolver:   'https://www.w3.org/TR/webaudio/#ConvolverNode',\r\n\t\t\tpeaking:     'https://www.w3.org/TR/webaudio/#idl-def-BiquadFilterType.peaking',\r\n\t\t\tdestination: 'https://www.w3.org/TR/webaudio/#AudioDestinationNode',\r\n\t\t\tcompressor:  'https://www.w3.org/TR/webaudio/#the-dynamicscompressornode-interface',\r\n\t\t\tanalyser:    'https://www.w3.org/TR/webaudio/#the-analysernode-interface',\r\n\t\t}\r\n\t}\r\n\twriteButtons(getCode,getFormatting,i18n) {\r\n\t\treturn super.writeButtons(getCode,getFormatting,i18n).append(\r\n\t\t\t\" <span class='tip-warn'><span class='tip-content'>\"+i18n('code-output.warning.jsfiddle-run')+\"</span></span>\"\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeOutput\r\n","'use strict'\r\n\r\nconst AudioContext=require('./audio-context')\r\nconst SourceSet=require('./source-set')\r\nconst FilterSequence=require('./filter-sequence')\r\nconst Destination=require('./destination')\r\nconst Canvas=require('./canvas')\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst InterleaveLines=require('crnx-base/interleave-lines')\r\nconst NoseWrapLines=require('crnx-base/nose-wrap-lines')\r\nconst BaseWebCode=require('crnx-base/web-code')\r\n\r\nclass Code extends BaseWebCode {\r\n\tconstructor(options,i18n) {\r\n\t\tsuper()\r\n\t\tthis.i18n=i18n\r\n\t\tthis.featureContext={}\r\n\t\tthis.features=[\r\n\t\t\tnew AudioContext,\r\n\t\t\tnew SourceSet(options.sources),\r\n\t\t\tnew FilterSequence(options.filters),\r\n\t\t\tnew Destination(options.destination),\r\n\t\t\tnew Canvas(options.canvas),\r\n\t\t]\r\n\t\tthis.features.forEach(feature=>{\r\n\t\t\tfeature.requestFeatureContext(this.featureContext)\r\n\t\t})\r\n\t}\r\n\tget basename() {\r\n\t\treturn 'webaudio'\r\n\t}\r\n\tget lang() {\r\n\t\treturn this.i18n.lang\r\n\t}\r\n\tget title() {\r\n\t\treturn this.i18n('code.title')\r\n\t}\r\n\tget styleLines() {\r\n\t\tconst a=Lines.b()\r\n\t\tif (this.featureContext.alignedInputs) {\r\n\t\t\ta(\r\n\t\t\t\t\"label {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 15em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"\tline-height: 0.8em;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".min {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 5em;\",\r\n\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\".max {\",\r\n\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\"\twidth: 5em;\",\r\n\t\t\t\t\"\ttext-align: left;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\tif (this.featureContext.canvas) {\r\n\t\t\ta(\r\n\t\t\t\t\"canvas {\",\r\n\t\t\t\t\"\tborder: 1px solid;\",\r\n\t\t\t\t\"}\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tget bodyLines() {\r\n\t\treturn Lines.bae(\r\n\t\t\t...this.features.map(feature=>feature.getHtmlLines(this.featureContext,this.i18n))\r\n\t\t)\r\n\t}\r\n\tget scriptLines() {\r\n\t\tlet prevNodeJsNames\r\n\t\treturn InterleaveLines.bae(\r\n\t\t\t...this.features.map(feature=>{\r\n\t\t\t\tconst lines=feature.getJsInitLines(this.featureContext,this.i18n,prevNodeJsNames)\r\n\t\t\t\tprevNodeJsNames=feature.getNodeJsNames(this.featureContext,prevNodeJsNames)\r\n\t\t\t\treturn lines\r\n\t\t\t}),\r\n\t\t\tNoseWrapLines.b(\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"function visualize() {\"\r\n\t\t\t\t),\r\n\t\t\t\tJsLines.bae(\r\n\t\t\t\t\t\"\trequestAnimationFrame(visualize);\",\r\n\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\"requestAnimationFrame(visualize);\"\r\n\t\t\t\t)\r\n\t\t\t).ae(\r\n\t\t\t\t...this.features.map(feature=>feature.getJsLoopPreLines(this.featureContext,this.i18n)),\r\n\t\t\t\t...this.features.map(feature=>feature.getJsLoopVisLines(this.featureContext,this.i18n))\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n}\r\n\r\nmodule.exports=Code\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst Feature=require('./feature')\r\n\r\nclass CollectionFeature extends Feature {\r\n\tconstructor(entryOptions) {\r\n\t\tsuper()\r\n\t\tconst entryCounts=new Map\r\n\t\tentryOptions.entries.forEach(entryOption=>{\r\n\t\t\tconst entryClass=this.getEntryClass(entryOption)\r\n\t\t\tentryCounts.set(entryClass,entryCounts.get(entryClass)+1||1)\r\n\t\t})\r\n\t\tconst entryCounts2=new Map\r\n\t\tthis.entries=entryOptions.entries.map(entryOption=>{\r\n\t\t\tconst entryClass=this.getEntryClass(entryOption)\r\n\t\t\tif (entryCounts.get(entryClass)>1) {\r\n\t\t\t\tconst n=entryCounts2.get(entryClass)||0\r\n\t\t\t\tentryCounts2.set(entryClass,n+1)\r\n\t\t\t\treturn new entryClass(entryOption,n)\r\n\t\t\t} else {\r\n\t\t\t\treturn new entryClass(entryOption)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn Lines.bae(...this.entries.map(entry=>entry.getHtmlLines(featureContext,i18n)))\r\n\t}\r\n\t// abstract:\r\n\t// getEntryClass(entryOption) {}\r\n}\r\n\r\nmodule.exports=CollectionFeature\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst NoseWrapLines=require('crnx-base/nose-wrap-lines')\r\nconst RefLines=require('crnx-base/ref-lines')\r\nconst Feature=require('./feature')\r\n\r\nclass Destination extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper()\r\n\t\tthis.options=options\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tif (!featureContext.audioProcessing) return\r\n\t\tif (this.options.compressor || this.options.waveform) {\r\n\t\t\tfeatureContext.audioContext=true\r\n\t\t}\r\n\t\tif (this.options.waveform) {\r\n\t\t\tfeatureContext.canvas=true\r\n\t\t}\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tconst a=NoseWrapLines.b(\"<div>\",\"</div>\")\r\n\t\tif (featureContext.audioProcessing && this.options.compressor) {\r\n\t\t\ta(\r\n\t\t\t\t\"<input id=my.compressor type=checkbox checked>\",\r\n\t\t\t\tLines.html`<label for=my.compressor>${i18n('options.destination.compressor.enable')}</label>`\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (featureContext.audioProcessing && featureContext.audioContext) {\r\n\t\t\tif (this.options.compressor) {\r\n\t\t\t\tlet nextNodeJsName=(this.options.waveform ? 'analyserNode' : 'ctx.destination')\r\n\t\t\t\ta(\r\n\t\t\t\t\tRefLines.parse(\"// \"+i18n('comment.destination.compressor')),\r\n\t\t\t\t\t\"var compressorNode=ctx.createDynamicsCompressor();\",\r\n\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>prevNodeJsName+\".connect(compressorNode);\")\r\n\t\t\t\t)\r\n\t\t\t\tif (prevNodeJsNames.length>0) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"document.getElementById('my.compressor').onchange=function(){\",\r\n\t\t\t\t\t\t\"\tif (this.checked) {\",\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".disconnect(\"+nextNodeJsName+\");\"),\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".connect(compressorNode);\"),\r\n\t\t\t\t\t\t\"\t} else {\",\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".disconnect(compressorNode);\"),\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".connect(\"+nextNodeJsName+\");\"),\r\n\t\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\t\"};\",\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\tprevNodeJsNames=['compressorNode']\r\n\t\t\t}\r\n\t\t\tif (this.options.waveform) {\r\n\t\t\t\ta(\r\n\t\t\t\t\tRefLines.parse(\"// \"+i18n('comment.destination.waveform')),\r\n\t\t\t\t\t\"var analyserNode=ctx.createAnalyser();\",\r\n\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>prevNodeJsName+\".connect(analyserNode);\"),\r\n\t\t\t\t\t\"analyserNode.fftSize=1024;\",\r\n\t\t\t\t\t\"var analyserData=new Uint8Array(analyserNode.frequencyBinCount);\",\r\n\t\t\t\t\t\"\"\r\n\t\t\t\t)\r\n\t\t\t\tprevNodeJsNames=['analyserNode']\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\tRefLines.parse(\"// \"+i18n('comment.destination')),\r\n\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>prevNodeJsName+\".connect(ctx.destination);\")\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetJsLoopVisLines(featureContext,i18n) {\r\n\t\tconst a=JsLines.b()\r\n\t\tif (featureContext.audioProcessing && this.options.waveform) {\r\n\t\t\ta(\r\n\t\t\t\t\"analyserNode.getByteTimeDomainData(analyserData);\",\r\n\t\t\t\t\"canvasContext.beginPath();\",\r\n\t\t\t\t\"for (var i=0;i<analyserData.length;i++) {\",\r\n\t\t\t\t\"\tvar x=i*canvas.width/analyserData.length;\",\r\n\t\t\t\t\"\tvar y=analyserData[i]*canvas.height/255;\",\r\n\t\t\t\t\"\tif (i==0) {\",\r\n\t\t\t\t\"\t\tcanvasContext.moveTo(x,y);\",\r\n\t\t\t\t\"\t} else {\",\r\n\t\t\t\t\"\t\tcanvasContext.lineTo(x,y);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"canvasContext.stroke();\"\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return prevNodeJsNames\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\treturn [\"ctx.destination\"]\r\n\t\t} else {\r\n\t\t\treturn prevNodeJsNames\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Destination\r\n","'use strict'\r\n\r\nconst Lines=require('crnx-base/lines')\r\n\r\nclass Feature {\r\n\trequestFeatureContext(featureContext) {\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetJsLoopPreLines(featureContext,i18n) {\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetJsLoopVisLines(featureContext,i18n) {\r\n\t\treturn Lines.be()\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\treturn prevNodeJsNames\r\n\t}\r\n}\r\n\r\nmodule.exports=Feature\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\nconst formatNumbers=require('crnx-base/format-numbers')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst NoseWrapLines=require('crnx-base/nose-wrap-lines')\r\nconst InterleaveLines=require('crnx-base/interleave-lines')\r\nconst RefLines=require('crnx-base/ref-lines')\r\nconst CollectionFeature=require('./collection-feature')\r\n\r\nclass Filter {\r\n\tconstructor(options,n) {\r\n\t\tthis.options=options\r\n\t\tthis.n=n\r\n\t}\r\n\tget nSuffix() {\r\n\t\tif (this.n!==undefined) {\r\n\t\t\treturn '.'+this.n\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t}\r\n\tgetPropertyOptionName(property) {\r\n\t\treturn 'options.filters.'+this.type+'.'+property.name\r\n\t}\r\n\tget nodeJsName() {\r\n\t\treturn camelCase(this.type+this.nSuffix+'.node')\r\n\t}\r\n\tgetPropertyInputHtmlName(propertyName) {\r\n\t\treturn 'my.'+this.type+this.nSuffix+'.'+propertyName\r\n\t}\r\n\tgetPropertyInputJsName(propertyName) {\r\n\t\treturn camelCase(this.type+this.nSuffix+'.'+propertyName+'.input')\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tconst hasRangeInputs=this.nodeProperties.some(property=>{\r\n\t\t\tif (property.type=='range') {\r\n\t\t\t\tconst option=this.options[property.name]\r\n\t\t\t\treturn option.input\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (hasRangeInputs) {\r\n\t\t\tfeatureContext.alignedInputs=true\r\n\t\t}\r\n\t}\r\n\tgetHtmlPropertyLines(i18n,property) {\r\n\t\tconst option=this.options[property.name]\r\n\t\tconst inputHtmlName=this.getPropertyInputHtmlName(property.name)\r\n\t\tconst a=Lines.b()\r\n\t\tif (property.type=='range' && option.input) {\r\n\t\t\tconst p=option.precision\r\n\t\t\tconst fmtAttrs=formatNumbers.html({ min:option.min, max:option.max, value:option.value },p)\r\n\t\t\tconst fmtLabels=formatNumbers({ min:option.min, max:option.max },p)\r\n\t\t\tconst minMax=n=>i18n.numberWithUnits(n,option.unit,(a,e)=>Lines.html`<abbr title=${e}>`+a+`</abbr>`)\r\n\t\t\ta(\r\n\t\t\t\tLines.html`<label for=${inputHtmlName}>${i18n(this.getPropertyOptionName(property))}:</label>`,\r\n\t\t\t\t\"<span class=min>\"+minMax(fmtLabels.min)+\"</span>\",\r\n\t\t\t\tLines.html`<input id=${inputHtmlName} type=range value=${fmtAttrs.value} min=${fmtAttrs.min} max=${fmtAttrs.max} step=${p?Math.pow(0.1,p).toFixed(p):false}>`,\r\n\t\t\t\t\"<span class=max>\"+minMax(fmtLabels.max)+\"</span>\"\r\n\t\t\t)\r\n\t\t} else if (property.type=='select' && option.input) {\r\n\t\t\ta(\r\n\t\t\t\tLines.html`<label for=${inputHtmlName}>${i18n(this.getPropertyOptionName(property))}:</label>`,\r\n\t\t\t\tWrapLines.b(\r\n\t\t\t\t\tLines.html`<select id=${inputHtmlName}>`,`</select>`\r\n\t\t\t\t).ae(\r\n\t\t\t\t\t...option.availableValues.map(value=>{\r\n\t\t\t\t\t\tconst title=i18n(this.getPropertyOptionName(property)+'.'+value)\r\n\t\t\t\t\t\treturn Lines.html`<option selected=${option.value==value} value=${value!=title && value}>${title}</option>`\r\n\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else if (property.type=='xhr') {\r\n\t\t\ta(\r\n\t\t\t\tLines.html`<span id=${inputHtmlName}>${i18n(this.getPropertyOptionName(property)+'.loading')}</span>`\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tget skipNode() {\r\n\t\treturn false\r\n\t}\r\n\t// { not called if skipNode is set\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn Lines.bae(\r\n\t\t\t...this.nodeProperties.map(\r\n\t\t\t\tproperty=>NoseWrapLines.b(\r\n\t\t\t\t\t\"<div>\",\"</div>\"\r\n\t\t\t\t).ae(\r\n\t\t\t\t\tthis.getHtmlPropertyLines(i18n,property)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\treturn JsLines.bae(\r\n\t\t\tRefLines.parse(\"// \"+i18n('comment.filters.'+this.type)),\r\n\t\t\t\"var \"+this.nodeJsName+\"=ctx.\"+this.ctxCreateMethodName+\"();\",\r\n\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+this.nodeJsName+\");\"\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n\tget nodeJsNames() {\r\n\t\treturn [this.nodeJsName]\r\n\t}\r\n\t// }\r\n\t// abstract:\r\n\t// get type()\r\n\t// get ctxCreateMethodName()\r\n\t// get nodeProperties()\r\n}\r\n\r\nclass SinglePathFilter extends Filter {\r\n\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\treturn Lines.bae(\r\n\t\t\tsuper.getJsInitLines(i18n,prevNodeJsNames),\r\n\t\t\t...this.nodeProperties.map(property=>{\r\n\t\t\t\tconst option=this.options[property.name]\r\n\t\t\t\tconst nodePropertyJsName=this.nodeJsName+\".\"+property.name+(property.type=='range'?\".value\":\"\")\r\n\t\t\t\tconst a=JsLines.b()\r\n\t\t\t\tif (option.input) {\r\n\t\t\t\t\tconst inputJsName=this.getPropertyInputJsName(property.name)\r\n\t\t\t\t\tconst inputHtmlName=this.getPropertyInputHtmlName(property.name)\r\n\t\t\t\t\tlet value=inputJsName+\".value\"\r\n\t\t\t\t\tif (property.fn) {\r\n\t\t\t\t\t\tvalue=property.fn(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst eventProp=(property.type=='range'?'oninput':'onchange')\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"var \"+inputJsName+\"=document.getElementById('\"+inputHtmlName+\"');\",\r\n\t\t\t\t\t\t// was for IE11 compat (but IE11 has no Web Audio): (property.type=='range'?inputJsName+\".oninput=\":\"\")+inputJsName+\".onchange=function(){\",\r\n\t\t\t\t\t\t\";(\"+inputJsName+\".\"+eventProp+\"=function(){\",\r\n\t\t\t\t\t\t\"\t\"+nodePropertyJsName+\"=\"+value+\";\",\r\n\t\t\t\t\t\t\"})();\"\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (option.value!=option.defaultValue) {\r\n\t\t\t\t\tlet value=option.value\r\n\t\t\t\t\tif (property.type=='select') {\r\n\t\t\t\t\t\tvalue=\"'\"+value+\"'\"\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (property.fn) {\r\n\t\t\t\t\t\tvalue=property.fn(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\tnodePropertyJsName+\"=\"+value+\";\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\treturn a.e()\r\n\t\t\t})\r\n\t\t)\r\n\t}\r\n}\r\n\r\nclass PassiveByDefaultSinglePathFilter extends SinglePathFilter {\r\n\tget skipNode() {\r\n\t\treturn this.nodeProperties.every(property=>{\r\n\t\t\tconst option=this.options[property.name]\r\n\t\t\treturn option.value==option.defaultValue && !option.input\r\n\t\t})\r\n\t}\r\n}\r\n\r\nconst filterClasses={\r\n\tgain: class extends PassiveByDefaultSinglePathFilter {\r\n\t\tget type()                { return 'gain' }\r\n\t\tget ctxCreateMethodName() { return 'createGain' }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'gain',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t},\r\n\tpanner: class extends PassiveByDefaultSinglePathFilter {\r\n\t\tget type()                { return 'panner' }\r\n\t\tget ctxCreateMethodName() { return 'createStereoPanner' }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'pan',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t},\r\n\tbiquad: class extends SinglePathFilter {\r\n\t\tget type()                { return 'biquad' }\r\n\t\tget ctxCreateMethodName() { return 'createBiquadFilter' }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'type',\r\n\t\t\t\t\ttype:'select',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'frequency',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'Q',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t\tfn:x=>`Math.pow(10,${x})`,\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'gain',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'detune',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t\tget skipNode() {\r\n\t\t\t// lowshelf, highshelf and peaking are passive when gain==0\r\n\t\t\treturn (\r\n\t\t\t\t!this.options.type.input && ['lowshelf','highshelf','peaking'].indexOf(this.options.type.value)>=0 &&\r\n\t\t\t\t!this.options.gain.input && this.options.gain==0\r\n\t\t\t)\r\n\t\t}\r\n\t},\r\n\tconvolver: class extends Filter {\r\n\t\tget type()                { return 'convolver' }\r\n\t\tget ctxCreateMethodName() { return 'createConvolver' }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'reverb',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'buffer',\r\n\t\t\t\t\ttype:'xhr',\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t\tget dryGainNodeJsName() {\r\n\t\t\treturn camelCase(this.type+this.nSuffix+'.dry.gain.node')\r\n\t\t}\r\n\t\tget wetGainNodeJsName() {\r\n\t\t\treturn camelCase(this.type+this.nSuffix+'.wet.gain.node')\r\n\t\t}\r\n\t\tget skipNode() {\r\n\t\t\treturn this.options.reverb==0 && !this.options.reverb.input\r\n\t\t}\r\n\t\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\t\tconst messageHtmlName=this.getPropertyInputHtmlName('buffer')\r\n\t\t\tconst a=JsLines.b()\r\n\t\t\tif (this.options.reverb.input || this.options.reverb!=1) {\r\n\t\t\t\ta(RefLines.parse(\"// \"+i18n('comment.filters.'+this.type)))\r\n\t\t\t} else {\r\n\t\t\t\ta(RefLines.parse(\"// \"+i18n('comment.filters.'+this.type+'.single')))\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var \"+this.nodeJsName+\"=ctx.\"+this.ctxCreateMethodName+\"();\",\r\n\t\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+this.nodeJsName+\");\"\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t\tif (this.options.reverb.input || this.options.reverb!=1) {\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var \"+this.wetGainNodeJsName+\"=ctx.createGain();\",\r\n\t\t\t\t\tthis.nodeJsName+\".connect(\"+this.wetGainNodeJsName+\");\",\r\n\t\t\t\t\t\"var \"+this.dryGainNodeJsName+\"=ctx.createGain();\",\r\n\t\t\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+this.dryGainNodeJsName+\");\"\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\tif (this.options.reverb.input) {\r\n\t\t\t\t\tconst inputHtmlName=this.getPropertyInputHtmlName('reverb')\r\n\t\t\t\t\tconst inputJsName=this.getPropertyInputJsName('reverb')\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t\"var \"+inputJsName+\"=document.getElementById('\"+inputHtmlName+\"');\",\r\n\t\t\t\t\t\t\";(\"+inputJsName+\".oninput=function(){\",\r\n\t\t\t\t\t\t\"\t\"+this.wetGainNodeJsName+\".gain.value=\"+inputJsName+\".value;\",\r\n\t\t\t\t\t\t\"\t\"+this.dryGainNodeJsName+\".gain.value=1-\"+inputJsName+\".value;\",\r\n\t\t\t\t\t\t\"})();\"\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ta(\r\n\t\t\t\t\"var xhr=new XMLHttpRequest();\",\r\n\t\t\t\t\"xhr.open('GET','\"+this.options.url+\"');\", // TODO html escape\r\n\t\t\t\t\"xhr.responseType='arraybuffer';\",\r\n\t\t\t\t\"xhr.onload=function(){\",\r\n\t\t\t\t\"\tif (this.status==200) {\", // TODO we are checking status here, but what if <audio>'s status is an error?\r\n\t\t\t\t\"\t\tctx.decodeAudioData(this.response,function(buffer){\",\r\n\t\t\t\t\"\t\t\t\"+this.nodeJsName+\".buffer=buffer;\",\r\n\t\t\t\t\"\t\t\tdocument.getElementById('\"+messageHtmlName+\"').textContent='';\",\r\n\t\t\t\t\"\t\t});\",\r\n\t\t\t\t\"\t} else {\",\r\n\t\t\t\t\"\t\tthis.onerror();\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"};\",\r\n\t\t\t\t\"xhr.onerror=function(){\",\r\n\t\t\t\t\"\tdocument.getElementById('\"+messageHtmlName+\"').textContent='\"+i18n('options.filters.convolver.buffer.error')+\"';\",\r\n\t\t\t\t\"};\",\r\n\t\t\t\t\"xhr.send();\"\r\n\t\t\t)\r\n\t\t\treturn a.e()\r\n\t\t}\r\n\t\tget nodeJsNames() {\r\n\t\t\tif (this.options.reverb.input || this.options.reverb!=1) {\r\n\t\t\t\treturn [this.wetGainNodeJsName,this.dryGainNodeJsName]\r\n\t\t\t} else {\r\n\t\t\t\treturn [this.nodeJsName]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tequalizer: class extends Filter {\r\n\t\tget type()                { return 'equalizer' }\r\n\t\tget ctxCreateMethodName() { return 'createBiquadFilter' }\r\n\t\tget frequencies()         { return [60,170,350,1000,3500,10000] }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn this.frequencies.map(freq=>({\r\n\t\t\t\tname:'gain'+freq,\r\n\t\t\t\ttype:'range',\r\n\t\t\t}))\r\n\t\t}\r\n\t\tgetFrequencyOption(i) {\r\n\t\t\treturn this.options[this.nodeProperties[i].name]\r\n\t\t}\r\n\t\tget affectedFreqsAndOptions() {\r\n\t\t\treturn this.frequencies.map((freq,i)=>{\r\n\t\t\t\tconst option=this.getFrequencyOption(i)\r\n\t\t\t\treturn {freq,option}\r\n\t\t\t}).filter(fo=>(fo.option.input!=false || fo.option.value!=0))\r\n\t\t}\r\n\t\trequestFeatureContext(featureContext) {\r\n\t\t\tif (!this.allGainsConstant) {\r\n\t\t\t\tfeatureContext.alignedInputs=true\r\n\t\t\t}\r\n\t\t}\r\n\t\tget skipNode() {\r\n\t\t\treturn this.affectedFreqsAndOptions.length==0\r\n\t\t}\r\n\t\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\t\tconst singleFreq=this.affectedFreqsAndOptions.length==1\r\n\t\t\tconst allGainsConstant=this.affectedFreqsAndOptions.every(fo=>fo.option.input==false)\r\n\t\t\tconst noGainsConstant=this.affectedFreqsAndOptions.every(fo=>fo.option.input==true)\r\n\t\t\tconst getJsData=()=>{\r\n\t\t\t\treturn this.affectedFreqsAndOptions.map(fo=>{\r\n\t\t\t\t\tif (noGainsConstant) {\r\n\t\t\t\t\t\treturn fo.freq\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"[\"+fo.freq+\",\"+(fo.option.input ? 'null' : fo.option.value)+\"]\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}).join()\r\n\t\t\t}\r\n\t\t\tconst getJsDataItem=()=>{\r\n\t\t\t\tif (noGainsConstant) {\r\n\t\t\t\t\treturn \"freq\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"freqData\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst getJsLoopLines=()=>{\r\n\t\t\t\tconst freq=(singleFreq ? this.affectedFreqsAndOptions[0].freq : 'freq')\r\n\t\t\t\tconst gain=(singleFreq ? this.affectedFreqsAndOptions[0].option.value : 'gain')\r\n\t\t\t\tconst nodeJsName=((allGainsConstant || singleFreq) ? this.nodeJsName : 'node')\r\n\t\t\t\tconst inputJsName=(singleFreq\r\n\t\t\t\t\t? this.getPropertyInputJsName('gain'+freq)\r\n\t\t\t\t\t: 'input'\r\n\t\t\t\t)\r\n\t\t\t\tconst inputHtmlNameExpr=(singleFreq\r\n\t\t\t\t\t? \"'\"+this.getPropertyInputHtmlName('gain'+freq)+\"'\"\r\n\t\t\t\t\t: \"'\"+this.getPropertyInputHtmlName('gain')+\"'+freq\"\r\n\t\t\t\t)\r\n\t\t\t\tconst a=JsLines.b()\r\n\t\t\t\tif (!(noGainsConstant || singleFreq)) {\r\n\t\t\t\t\ta(\"var freq=freqData[0], gain=freqData[1];\")\r\n\t\t\t\t}\r\n\t\t\t\tif (allGainsConstant && !singleFreq) {\r\n\t\t\t\t\ta(\"\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"var \")\r\n\t\t\t\t}\r\n\t\t\t\ta.t(nodeJsName+\"=ctx.\"+this.ctxCreateMethodName+\"();\")\r\n\t\t\t\tif (singleFreq) {\r\n\t\t\t\t\ta(\r\n\t\t\t\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+nodeJsName+\");\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (prevNodeJsNames.length==1) {\r\n\t\t\t\t\t\ta(\"prevNode.connect(\"+nodeJsName+\");\")\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ta(\r\n\t\t\t\t\t\t\t\"prevNodes.forEach(function(prevNode){\",\r\n\t\t\t\t\t\t\t\"\tprevNode.connect(\"+nodeJsName+\");\",\r\n\t\t\t\t\t\t\t\"});\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\tnodeJsName+\".type='peaking';\",\r\n\t\t\t\t\tnodeJsName+\".frequency.value=\"+freq+\";\"\r\n\t\t\t\t)\r\n\t\t\t\tconst constLines=JsLines.bae(\r\n\t\t\t\t\tnodeJsName+\".gain.value=\"+gain+\";\"\r\n\t\t\t\t)\r\n\t\t\t\tconst varLines=JsLines.bae(\r\n\t\t\t\t\t\"var \"+inputJsName+\"=document.getElementById(\"+inputHtmlNameExpr+\");\",\r\n\t\t\t\t\t\";(\"+inputJsName+\".oninput=function(){\",\r\n\t\t\t\t\t\"\t\"+nodeJsName+\".gain.value=\"+inputJsName+\".value;\",\r\n\t\t\t\t\t\"})();\"\r\n\t\t\t\t)\r\n\t\t\t\tif (!noGainsConstant && allGainsConstant) {\r\n\t\t\t\t\ta(constLines)\r\n\t\t\t\t} else if (noGainsConstant && !allGainsConstant) {\r\n\t\t\t\t\ta(varLines)\r\n\t\t\t\t} else if (!noGainsConstant && !allGainsConstant) {\r\n\t\t\t\t\ta(WrapLines.b(\"if (gain!==null) {\",\"} else {\",\"}\").ae(constLines,varLines))\r\n\t\t\t\t}\r\n\t\t\t\tif (!singleFreq) {\r\n\t\t\t\t\tconst outerNodeJsName=(allGainsConstant ? nodeJsName : this.nodeJsName+\"=\"+nodeJsName)\r\n\t\t\t\t\tif (prevNodeJsNames.length==1) {\r\n\t\t\t\t\t\ta(\"prevNode=\"+outerNodeJsName+\";\")\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ta(\"prevNodes=[\"+outerNodeJsName+\"];\")\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn a.e()\r\n\t\t\t}\r\n\t\t\tif (singleFreq) {\r\n\t\t\t\treturn JsLines.bae(\r\n\t\t\t\t\tRefLines.parse(\"// \"+i18n('comment.filters.'+this.type+'.single')),\r\n\t\t\t\t\tgetJsLoopLines()\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\tconst a=JsLines.b()\r\n\t\t\t\ta(\r\n\t\t\t\t\tRefLines.parse(\"// \"+i18n('comment.filters.'+this.type))\r\n\t\t\t\t)\r\n\t\t\t\tif (prevNodeJsNames.length==1) {\r\n\t\t\t\t\ta(\"var prevNode=\"+prevNodeJsNames[0]+\";\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\ta(\"var prevNodes=[\"+prevNodeJsNames.join()+\"];\")\r\n\t\t\t\t}\r\n\t\t\t\ta(\r\n\t\t\t\t\t\"var \"+this.nodeJsName+\";\",\r\n\t\t\t\t\tWrapLines.b(\r\n\t\t\t\t\t\tJsLines.bae(\";[\"+getJsData()+\"].forEach(function(\"+getJsDataItem()+\"){\"),JsLines.bae(\"});\")\r\n\t\t\t\t\t).ae(\r\n\t\t\t\t\t\tgetJsLoopLines()\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\treturn a.e()\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n}\r\n\r\nclass FilterSequence extends CollectionFeature {\r\n\tgetEntryClass(entryOption) {\r\n\t\treturn filterClasses[entryOption.filter]\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tif (!featureContext.audioProcessing) return\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tif (!entry.skipNode) {\r\n\t\t\t\tfeatureContext.audioContext=true\r\n\t\t\t\tentry.requestFeatureContext(featureContext)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tif (!featureContext.audioProcessing) return Lines.be()\r\n\t\treturn Lines.bae(...this.entries.filter(entry=>!entry.skipNode).map(entry=>entry.getHtmlLines(featureContext,i18n)))\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return Lines.be()\r\n\t\treturn InterleaveLines.bae(...this.entries.filter(entry=>!entry.skipNode).map(entry=>{\r\n\t\t\tconst lines=entry.getJsInitLines(i18n,prevNodeJsNames)\r\n\t\t\tprevNodeJsNames=entry.nodeJsNames\r\n\t\t\treturn lines\r\n\t\t}))\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return prevNodeJsNames\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tif (!entry.skipNode) {\r\n\t\t\t\tprevNodeJsNames=entry.nodeJsNames\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn prevNodeJsNames\r\n\t}\r\n}\r\n\r\nmodule.exports=FilterSequence\r\n","'use strict'\r\n\r\nconst langStrings={\r\n\ten:{\r\n\t\t'options.sources': \"Sources\",\r\n\t\t'options.sources.{audio,video}': \"{Audio,Video} element\",\r\n\t\t'options.sources.{audio,video}.add': \"Add {} element\",\r\n\t\t'options.sources.{audio,video}.url': \"Source URL\",\r\n\t\t'options.sources.video.{width,height}': \"Player {}\",\r\n\r\n\t\t'options.filters': \"Filters\",\r\n\t\t'options.filters.gain': \"Gain\",\r\n\t\t'options.filters.gain.add': \"Add gain\",\r\n\t\t'options.filters.gain.gain': \"Gain\",\r\n\t\t'options.filters.panner': \"Stereo panner\",\r\n\t\t'options.filters.panner.add': \"Add stereo panner\",\r\n\t\t'options.filters.panner.pan': \"Pan\",\r\n\t\t'options.filters.biquad': \"Biquad filter\", // [[Digital biquad filter]]\r\n\t\t'options.filters.biquad.add': \"Add biquad filter\",\r\n\t\t'options.filters.biquad.type': \"Filter type\",\r\n\t\t'options.filters.biquad.type.{lowpass,highpass,bandpass,lowshelf,highshelf,peaking,notch,allpass}': \"{}\",\r\n\t\t'options.filters.biquad.frequency': \"Frequency\",\r\n\t\t'options.filters.biquad.Q': \"log(Q)\",\r\n\t\t'options.filters.biquad.detune': \"Detune\",\r\n\t\t'options.filters.biquad.gain': \"Gain\",\r\n\t\t'options.filters.convolver': \"Convolver\",\r\n\t\t'options.filters.convolver.add': \"Add convolver\",\r\n\t\t'options.filters.convolver.url': \"Impulse responce URL\",\r\n\t\t'options.filters.convolver.reverb': \"Reverb (dry/wet)\",\r\n\t\t'options.filters.convolver.buffer.loading': \"Loading and decoding the impulse response\",\r\n\t\t'options.filters.convolver.buffer.error': \"Error while loading the impulse response\",\r\n\t\t'options.filters.equalizer': \"Equalizer\",\r\n\t\t'options.filters.equalizer.add': \"Add equalizer\",\r\n\t\t'options.filters.equalizer.gain{60,170,350,1000,3500,10000}': \"{} Hz gain\",\r\n\r\n\t\t'options.destination': \"Destination\",\r\n\t\t'options.destination.compressor': \"Add dynamics compressor before the destination\",\r\n\t\t'options.destination.compressor.enable': \"Enable dynamics compressor\",\r\n\t\t'options.destination.waveform': \"Add waveform visualization\",\r\n\r\n\t\t'options.canvas': \"Canvas\",\r\n\t\t'options.canvas.{width,height}': \"Canvas {}\",\r\n\t\t'options.canvas.line': \"Waveform line\",\r\n\t\t'options.canvas.line.width': \"Waveform line width\",\r\n\t\t'options.canvas.line.color': \"Waveform line color\",\r\n\t\t'options.canvas.line.color.{r,g,b,a}': \"Waveform line {red,green,blue,opacity}\",\r\n\t\t'options.canvas.background': \"Background\",\r\n\t\t'options.canvas.background.type': \"Background type\",\r\n\t\t'options.canvas.background.type.{clear,filled}': \"{}\",\r\n\t\t'options.canvas.background.color': \"Background fill color\",\r\n\t\t'options.canvas.background.color.{r,g,b,a}': \"Background fill {red,green,blue,opacity (blur)}\",\r\n\r\n\t\t'options-output.input': \"Editable\",\r\n\t\t'options-output.range': \"with range\",\r\n\r\n\t\t'code-output.warning.jsfiddle-run': \"You may have to click <kbd>Run</kbd> in JSFiddle to get sound output working\",\r\n\r\n\t\t'code.title': \"Web Audio API example — generated code\",\r\n\r\n\t\t'comment.context': \"create [audio context][context]\",\r\n\t\t'comment.sources.audio': \"create [audio source node][source]\",\r\n\t\t'comment.sources.video': \"create [video source node][source]\",\r\n\t\t'comment.filters.gain': \"create [gain node][gain]\",\r\n\t\t'comment.filters.panner': \"create [stereo panner node][panner]\",\r\n\t\t'comment.filters.biquad': \"create [biquad filter node][biquad]\",\r\n\t\t'comment.filters.convolver': \"create dry and wet routes with [convolver node][convolver]\",\r\n\t\t'comment.filters.convolver.single': \"create [convolver node][convolver]\",\r\n\t\t'comment.filters.equalizer': \"create equalizer as a sequence of [peaking][peaking] [biquad filter nodes][biquad]\",\r\n\t\t'comment.filters.equalizer.single': \"create equalizer as a [peaking][peaking] [biquad filter node][biquad]\",\r\n\t\t'comment.destination': \"connect last node to [destination][destination]\",\r\n\t\t'comment.destination.compressor': \"create [dynamics compressor node][compressor]\",\r\n\t\t'comment.destination.waveform': \"create [analyser node][analyser] for waveform visualization\",\r\n\r\n\t\t'units.pixel.a': \"px\",\r\n\t\t'units.pixel.{1,2}': \"pixel{,s}\",\r\n\t\t'units.hertz.a': \"Hz\",\r\n\t\t'units.hertz.{1,2}': \"Hertz\",\r\n\t\t'units.decibel.a': \"dB\",\r\n\t\t'units.decibel.{1,2}': \"decibel{,s}\",\r\n\t},\r\n\tru:{\r\n\t\t'options.sources': \"Источники\",\r\n\t\t'options.sources.{audio,video}': \"Элемент <code>{}</code>\",\r\n\t\t'options.sources.{audio,video}.add': \"Добавить элемент <code>{}</code>\",\r\n\t\t'options.sources.{audio,video}.url': \"URL источника\",\r\n\t\t'options.sources.video.{width,height}': \"{Ширина,Высота} проигрывателя\",\r\n\r\n\t\t'options.filters': \"Фильтры\",\r\n\t\t'options.filters.gain': \"Усилитель\",\r\n\t\t'options.filters.gain.add': \"Добавить усилитель\",\r\n\t\t'options.filters.gain.gain': \"Коэффициент усиления\",\r\n\t\t'options.filters.panner': \"Панорамирование\",\r\n\t\t'options.filters.panner.add': \"Добавить панорамирование\",\r\n\t\t'options.filters.panner.pan': \"Баланс\",\r\n\t\t'options.filters.biquad': \"Биквадратный фильтр\",\r\n\t\t'options.filters.biquad.add': \"Добавить биквадратный фильтр\",\r\n\t\t'options.filters.biquad.type': \"Тип фильтра\",\r\n\t\t'options.filters.biquad.type.lowpass': \"нижних частот\",\r\n\t\t'options.filters.biquad.type.highpass': \"верхних частот\",\r\n\t\t'options.filters.biquad.type.bandpass': \"полосовой\",\r\n\t\t'options.filters.biquad.type.{lowshelf,highshelf,peaking}': \"{}\", // TODO\r\n\t\t'options.filters.biquad.type.notch': \"полосно-заграждающий\",\r\n\t\t'options.filters.biquad.type.allpass': \"всепропускающий\", // http://www.dsplib.ru/content/allpass/allpass.html\r\n\t\t'options.filters.biquad.frequency': \"Частота\",\r\n\t\t'options.filters.biquad.Q': \"Логарифм добротности\",\r\n\t\t'options.filters.biquad.detune': \"Detune\",\r\n\t\t'options.filters.biquad.gain': \"Усиление\",\r\n\t\t'options.filters.convolver': \"Свёртка\",\r\n\t\t'options.filters.convolver.add': \"Добавить свёртку\",\r\n\t\t'options.filters.convolver.url': \"URL импульсной характеристики\",\r\n\t\t'options.filters.convolver.reverb': \"Соотношение прямого/обработанного звука\", // http://www.ixbt.com/proaudio/theory-of-reverb.shtml\r\n\t\t'options.filters.convolver.buffer.loading': \"Идёт загрузка и декодирование импульсной характеристики\",\r\n\t\t'options.filters.convolver.buffer.error': \"Ошибка загрузки импульсной характеристики\",\r\n\t\t'options.filters.equalizer': \"Эквалайзер\",\r\n\t\t'options.filters.equalizer.add': \"Добавить эквалайзер\",\r\n\t\t'options.filters.equalizer.gain{60,170,350,1000,3500,10000}': \"Усиление частоты {} Гц\",\r\n\r\n\t\t'options.destination': \"Выход\",\r\n\t\t'options.destination.compressor': \"Добавить компрессор перед выходом\",\r\n\t\t'options.destination.compressor.enable': \"Включить компрессор\",\r\n\t\t'options.destination.waveform': \"Добавить визуализацию формы волны\",\r\n\r\n\t\t'options.canvas': \"Элемент <code>canvas</code>\",\r\n\t\t'options.canvas.{width,height}': \"{Ширина,Высота} элемента <code>canvas</code>\",\r\n\t\t'options.canvas.line': \"Линия волны\",\r\n\t\t'options.canvas.line.width': \"Ширина линии волны\",\r\n\t\t'options.canvas.line.color': \"Цвет линии волны\",\r\n\t\t'options.canvas.line.color.{r,g,b,a}': \"{Красный ,Зелёный ,Синий ,Альфа-}канал линии волны\",\r\n\t\t'options.canvas.background': \"Фон\",\r\n\t\t'options.canvas.background.type': \"Тип фона\",\r\n\t\t'options.canvas.background.type.{clear,filled}': \"{прозрачный,закрашенный}\",\r\n\t\t'options.canvas.background.color': \"Цвет фона\",\r\n\t\t'options.canvas.background.color.{r,g,b,a}': \"{Красный ,Зелёный ,Синий ,Альфа-}канал фона\",\r\n\r\n\t\t'options-output.input': \"Значение изменяемо\",\r\n\t\t'options-output.range': \"в диапазоне\",\r\n\r\n\t\t'code-output.warning.jsfiddle-run': \"Для корректного вывода звука в JSFiddle может потребоваться нажатие кнопки <kbd>Run</kbd>\",\r\n\r\n\t\t'code.title': \"Пример использования Web Audio API — сгенерированный код\",\r\n\r\n\t\t'comment.context': \"создаём [аудио-контекст][context]\",\r\n\t\t'comment.sources.audio': \"создаём [узел источника аудио][source]\",\r\n\t\t'comment.sources.video': \"создаём [узел источника видео][source]\",\r\n\t\t'comment.filters.gain': \"создаём [узел усилителя][gain]\",\r\n\t\t'comment.filters.panner': \"создаём [узел панорамирования][panner]\",\r\n\t\t'comment.filters.biquad': \"создаём [узел биквадратичного фильтра][biquad]\",\r\n\t\t'comment.filters.convolver': \"создаём прямой путь и путь через [узел свёртки][convolver]\",\r\n\t\t'comment.filters.convolver.single': \"создаём [узел свёртки][convolver]\",\r\n\t\t'comment.filters.equalizer': \"создаём эквалайзер в виде последовательности [peaking][peaking] [биквадратичных фильтров][biquad]\",\r\n\t\t'comment.filters.equalizer.single': \"создаём эквалайзер в виде [peaking][peaking] [биквадратичного фильтра][biquad]\",\r\n\t\t'comment.destination': \"соединяем последний узел с [выходом][destination]\",\r\n\t\t'comment.destination.compressor': \"создаём [узел компрессора][compressor]\",\r\n\t\t'comment.destination.waveform': \"создаём [узел анализатора][analyser] для визуализации формы волны\",\r\n\r\n\t\t'units.pixel.a': \"px\",\r\n\t\t'units.pixel.{1,2,5}': \"пиксел{ь,я,ей}\",\r\n\t\t'units.hertz.a': \"Гц\",\r\n\t\t'units.hertz.{1,2,5}': \"Герц{,а,}\",\r\n\t\t'units.decibel.a': \"дБ\",\r\n\t\t'units.decibel.{1,2,5}': \"децибел{,а,ов}\",\r\n\t},\r\n}\r\n\r\n/*\r\nfunction i18nLinkFilter(inStrings) {\r\n\tconst linkRegexp=/\\[(\\S+)\\s+([^\\]]+)]/g\r\n\tconst outStrings={}\r\n\tfor (let id in inStrings) {\r\n\t\toutStrings[id]=inStrings[id].replace(linkRegexp,(match,url,text)=>\"<a href='\"+url+\"'>\"+text+\"</a>\")\r\n\t}\r\n\treturn outStrings\r\n}\r\nstrings=i18nLinkFilter(strings)\r\n*/\r\n\r\nfor (let lang in langStrings) {\r\n\tlet strings=langStrings[lang]\r\n\tstrings=require('crnx-base/i18n-expand-curly')(strings)\r\n\t//strings=require('crnx-base/i18n-link-wikipedia')(lang)(strings)\r\n\tstrings=require('crnx-base/options-output-i18n')(lang)(strings)\r\n\tstrings=require('crnx-base/code-output-i18n')(lang)(strings)\r\n\tlangStrings[lang]=strings\r\n}\r\n\r\nmodule.exports=require('crnx-base/i18n')(langStrings)\r\n","'use strict'\r\n\r\nlet idCounter=0\r\nfunction generateId() {\r\n\treturn 'webaudio-starter-id-'+(idCounter++)\r\n}\r\n\r\nconst i18ns=require('./i18n')\r\nconst Options=require('./options')\r\nconst Code=require('./code')\r\nconst OptionsOutput=require('./options-output')\r\nconst CodeOutput=require('./code-output')\r\n\r\n$(function(){\r\n\t$('.webaudio-starter').each(function(){\r\n\t\tconst $container=$(this)\r\n\t\tconst lang=$container.closest('[lang]').attr('lang')\r\n\t\tconst i18n=i18ns(lang)\r\n\t\tconst options=new Options()\r\n\t\tconst codeOutput=new CodeOutput(()=>new Code(options.fix(),i18n),i18n)\r\n\t\toptions.updateCallback=codeOutput.update\r\n\t\tconst optionsOutput=new OptionsOutput(options,generateId,i18n)\r\n\t\t$container.empty().append(\r\n\t\t\toptionsOutput.$output,\r\n\t\t\tcodeOutput.$output\r\n\t\t)\r\n\t})\r\n})\r\n","'use strict'\r\n\r\nconst Option=Object.create(require('crnx-base/option-classes'))\r\n\r\n// differs from webgl-starter:\r\n//\tinput is a boolean\r\n// \tfloat subclasses have a fixed precision of 2\r\n//\tno speed\r\n//\tcan specify defaultMin, defaultMax\r\n//\tfixed has defaultValue - although it's potentially confusing: user input default vs Web Audio Node property default - they are currently the same\r\nOption.LiveNumber = class extends Option.Number {\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tlet dataValue,dataMin,dataMax,dataInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value\r\n\t\t\tdataMin  =data.min\r\n\t\t\tdataMax  =data.max\r\n\t\t\tdataInput=data.input\r\n\t\t} else {\r\n\t\t\tdataValue=data\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tif (settings.defaultMin!==undefined) {\r\n\t\t\tthis.defaultMin=settings.defaultMin\r\n\t\t} else {\r\n\t\t\tthis.defaultMin=this.availableMin\r\n\t\t}\r\n\t\tif (settings.defaultMax!==undefined) {\r\n\t\t\tthis.defaultMax=settings.defaultMax\r\n\t\t} else {\r\n\t\t\tthis.defaultMax=this.availableMax\r\n\t\t}\r\n\t\tthis._min=(dataMin!==undefined)?dataMin:this.defaultMin\r\n\t\tthis._max=(dataMax!==undefined)?dataMax:this.defaultMax\r\n\t\tthis._input=!!dataInput\r\n\t\tthis._$range=null\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tif (this._$range) this._$range.toggle(this._input)\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input\r\n\t\tthis.updateInternalVisibility()\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget min() {\r\n\t\treturn this._min\r\n\t}\r\n\tset min(min) {\r\n\t\tthis._min=min\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget max() {\r\n\t\treturn this._max\r\n\t}\r\n\tset max(max) {\r\n\t\tthis._max=max\r\n\t\tthis.updateCallback()\r\n\t}\r\n\tget $range() {\r\n\t\treturn this._$range\r\n\t}\r\n\tset $range($range) {\r\n\t\tthis._$range=$range\r\n\t\tthis.updateInternalVisibility()\r\n\t}\r\n\texportHelper(src) {\r\n\t\tconst data={}\r\n\t\tif (src.value!=src.defaultValue) data.value=src.value\r\n\t\tif (src.min!=src.availableMin) data.min=src.min\r\n\t\tif (src.max!=src.availableMax) data.max=src.max\r\n\t\tif (src.input) data.input=src.input\r\n\t\treturn data\r\n\t}\r\n\texport() {\r\n\t\treturn this.exportHelper(this)\r\n\t}\r\n\tfix() {\r\n\t\tconst fixed=super.fix()\r\n\t\tfixed.min=this.min\r\n\t\tfixed.max=this.max\r\n\t\tfixed.input=this.input\r\n\t\tfixed.defaultValue=this.defaultValue\r\n\t\treturn fixed\r\n\t}\r\n}\r\n\r\nOption.LiveInt = class extends Option.LiveNumber {\r\n\tget precision() {\r\n\t\treturn 0\r\n\t}\r\n}\r\n\r\nOption.LiveFloat = class extends Option.LiveNumber {\r\n\tget precision() {\r\n\t\treturn 2\r\n\t}\r\n}\r\n\r\nclass FixedLiveSelect {\r\n\tconstructor(src) {\r\n\t\tthis.value=src.value\r\n\t\tthis.input=src.input\r\n\t\tthis.defaultValue=src.defaultValue\r\n\t\tthis.availableValues=src.availableValues\r\n\t\tthis.name=src.name\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this.value\r\n\t}\r\n\ttoString() {\r\n\t\treturn this.value\r\n\t}\r\n}\r\n\r\nOption.LiveSelect = class extends Option.Select {\r\n\tconstructor(name,settings,data,fullName,optionByFullName,updateCallback,makeEntry,isInsideArray) {\r\n\t\tlet dataValue,dataInput\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value\r\n\t\t\tdataInput=data.input\r\n\t\t} else {\r\n\t\t\tdataValue=data\r\n\t\t}\r\n\t\tsuper(...arguments)\r\n\t\tthis._input=!!dataInput\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input\r\n\t\tthis.updateCallback()\r\n\t}\r\n\texport() {\r\n\t\tconst data={}\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value\r\n\t\tif (this.input) data.input=this.input\r\n\t\treturn data\r\n\t}\r\n\tfix() {\r\n\t\treturn new FixedLiveSelect(this)\r\n\t}\r\n}\r\n\r\nmodule.exports=Option\r\n","'use strict'\r\n\r\nconst Option=require('./option-classes')\r\nconst BaseOptionsOutput=require('crnx-base/options-output')\r\n\r\nclass OptionsOutput extends BaseOptionsOutput {\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\tsuper.setOptionClassWriters(optionClassWriters)\r\n\t\toptionClassWriters.set(Option.LiveNumber,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst p=option.precision\r\n\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t.attr('step',Math.pow(0.1,p).toFixed(p))\r\n\t\t\tconst writeMinMaxInput=minOrMax=>setInputAttrs($(\"<input type='number' required>\"))\r\n\t\t\t\t.val(option[minOrMax])\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\toption[minOrMax]=parseFloat(this.value)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\tconst inputCheckboxId=generateId()\r\n\t\t\tlet $inputCheckbox,$rangeMinInput,$rangeMaxInput\r\n\t\t\tconst $output=optionClassWriters.get(Option.Number)(option,writeOption,i18n,generateId)\r\n\t\t\t$output.find('button').before(\r\n\t\t\t\t$inputCheckbox=$(\"<input type='checkbox' id='\"+inputCheckboxId+\"'>\")\r\n\t\t\t\t\t.prop('checked',option.input)\r\n\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\toption.input=$(this).prop('checked')\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" <label for='\"+inputCheckboxId+\"'>\"+i18n('options-output.input')+\"</label> \",\r\n\t\t\t\toption.$range=$(\"<span class='range'>\").append(\r\n\t\t\t\t\ti18n('options-output.range')+\" \",\r\n\t\t\t\t\t$rangeMinInput=writeMinMaxInput('min'),\r\n\t\t\t\t\t\" .. \",\r\n\t\t\t\t\t$rangeMaxInput=writeMinMaxInput('max')\r\n\t\t\t\t),\r\n\t\t\t\t\" \"\r\n\t\t\t).click(function(){\r\n\t\t\t\t$inputCheckbox.prop('checked',false).change()\r\n\t\t\t\t$rangeMinInput.val(option.defaultMin).change()\r\n\t\t\t\t$rangeMaxInput.val(option.defaultMax).change()\r\n\t\t\t})\r\n\t\t\treturn $output\r\n\t\t})\r\n\t\toptionClassWriters.set(Option.LiveSelect,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId()\r\n\t\t\tconst inputCheckboxId=generateId()\r\n\t\t\tlet $select,$inputCheckbox\r\n\t\t\treturn option.$=$(\"<div class='option'>\").append(\r\n\t\t\t\t\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label> \",\r\n\t\t\t\t$select=$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\toption.availableValues.map(function(availableValue){\r\n\t\t\t\t\t\treturn $(\"<option>\").val(availableValue).html(i18n('options.'+option.fullName+'.'+availableValue))\r\n\t\t\t\t\t})\r\n\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\toption.value=this.value\r\n\t\t\t\t}),\r\n\t\t\t\t\" \",\r\n\t\t\t\t$inputCheckbox=$(\"<input type='checkbox' id='\"+inputCheckboxId+\"'>\")\r\n\t\t\t\t\t.prop('checked',option.input)\r\n\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\toption.input=$(this).prop('checked')\r\n\t\t\t\t\t}),\r\n\t\t\t\t\" <label for='\"+inputCheckboxId+\"'>\"+i18n('options-output.input')+\"</label> \",\r\n\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t$select.val(option.defaultValue).change()\r\n\t\t\t\t\t$inputCheckbox.prop('checked',false).change()\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t})\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput\r\n","'use strict'\r\n\r\nconst BaseOptions=require('crnx-base/options')\r\n\r\nclass Options extends BaseOptions {\r\n\tget entriesDescription() {\r\n\t\treturn [\r\n\t\t\t['Array','sources',[ // urls are from w3c mooc\r\n\t\t\t\t['Group','audio',[\r\n\t\t\t\t\t['Text','url',[\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/guitarRiff1.mp3',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/drums.mp3',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/LaSueur.mp3',\r\n\t\t\t\t\t]],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','video',[\r\n\t\t\t\t\t['Text','url',[\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.webm',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.mp4',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/sintel.webm',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/sintel.mp4',\r\n\t\t\t\t\t]],\r\n\t\t\t\t\t['Int','width',[1,1920],320,{ unit: 'pixel' }],\r\n\t\t\t\t\t['Int','height',[1,1080],240,{ unit: 'pixel' }],\r\n\t\t\t\t]],\r\n\t\t\t],'source'],\r\n\t\t\t['Array','filters',[\r\n\t\t\t\t['Group','gain',[\r\n\t\t\t\t\t['LiveFloat','gain',[0,10],1,{\r\n\t\t\t\t\t\tdefaultMax: 1,\r\n\t\t\t\t\t}],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','panner',[\r\n\t\t\t\t\t['LiveFloat','pan',[-1,1],0],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','biquad',[\r\n\t\t\t\t\t['LiveSelect','type',[\r\n\t\t\t\t\t\t'lowpass','highpass','bandpass','lowshelf','highshelf','peaking','notch','allpass'\r\n\t\t\t\t\t]],\r\n\t\t\t\t\t['LiveInt','frequency',[0,22050],350,{ unit: 'hertz' }],\r\n\t\t\t\t\t['LiveFloat','Q',[-4,4],0], // log Q\r\n\t\t\t\t\t['LiveInt','gain',[-30,30],0,{ unit: 'decibel' }],\r\n\t\t\t\t\t['LiveInt','detune',[0,100],{ unit: '¢' }],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','convolver',[\r\n\t\t\t\t\t['LiveFloat','reverb',[0,1]],\r\n\t\t\t\t\t['Text','url',[\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/Scala-Milan-Opera-Hall.wav',\r\n\t\t\t\t\t]],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','equalizer',[60,170,350,1000,3500,10000].map(\r\n\t\t\t\t\tfreq=>['LiveInt','gain'+freq,[-30,30],0,{ unit: 'decibel' }]\r\n\t\t\t\t)],\r\n\t\t\t],'filter'],\r\n\t\t\t['Group','destination',[\r\n\t\t\t\t['Checkbox','compressor'], // Firefox compresses automatically?\r\n\t\t\t\t['Checkbox','waveform'],\r\n\t\t\t]],\r\n\t\t\t['Group','canvas',[\r\n\t\t\t\t['Int','width',[1,1920],300,{ unit: 'pixel' }],\r\n\t\t\t\t['Int','height',[1,1080],100,{ unit: 'pixel' }],\r\n\t\t\t\t['Group','line',[\r\n\t\t\t\t\t['Float','width',[0,10],1,{ unit: 'pixel' }],\r\n\t\t\t\t\t['Group','color',[\r\n\t\t\t\t\t\t['Int','r',[0,100],0,{ unit: '%' }],\r\n\t\t\t\t\t\t['Int','g',[0,100],0,{ unit: '%' }],\r\n\t\t\t\t\t\t['Int','b',[0,100],0,{ unit: '%' }],\r\n\t\t\t\t\t\t['Int','a',[0,100],100,{ unit: '%' }],\r\n\t\t\t\t\t]],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','background',[\r\n\t\t\t\t\t['Select','type',['clear','filled']],\r\n\t\t\t\t\t['Group','color',[\r\n\t\t\t\t\t\t['Int','r',[0,100],100,{ unit: '%' }],\r\n\t\t\t\t\t\t['Int','g',[0,100],100,{ unit: '%' }],\r\n\t\t\t\t\t\t['Int','b',[0,100],100,{ unit: '%' }],\r\n\t\t\t\t\t\t['Int','a',[0,100],100,{ unit: '%' }],\r\n\t\t\t\t\t],{\r\n\t\t\t\t\t\tvisibilityData: {'canvas.background.type':['filled']}\r\n\t\t\t\t\t}],\r\n\t\t\t\t]],\r\n\t\t\t],{\r\n\t\t\t\tvisibilityData: {'destination.waveform':[true]}\r\n\t\t\t}],\r\n\t\t]\r\n\t}\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes')\r\n\t}\r\n}\r\n\r\nmodule.exports=Options\r\n","'use strict'\r\n\r\nconst camelCase=require('crnx-base/fake-lodash/camelcase')\r\nconst Lines=require('crnx-base/lines')\r\nconst JsLines=require('crnx-base/js-lines')\r\nconst WrapLines=require('crnx-base/wrap-lines')\r\nconst InterleaveLines=require('crnx-base/interleave-lines')\r\nconst RefLines=require('crnx-base/ref-lines')\r\nconst CollectionFeature=require('./collection-feature')\r\n\r\nclass Source {\r\n\tconstructor(options,n) {\r\n\t\tthis.options=options\r\n\t\tthis.n=n\r\n\t}\r\n\tget nSuffix() {\r\n\t\tif (this.n!==undefined) {\r\n\t\t\treturn '.'+this.n\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t}\r\n\tget elementHtmlName() {\r\n\t\treturn 'my.'+this.type+this.nSuffix\r\n\t}\r\n\tget nodeJsName() {\r\n\t\treturn camelCase(this.type+this.nSuffix+'.node')\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn WrapLines.b(\"<div>\",\"</div>\").ae(\r\n\t\t\tthis.getElementHtmlLines(featureContext,i18n)\r\n\t\t)\r\n\t}\r\n\tgetJsInitLines(i18n) {\r\n\t\treturn JsLines.bae(\r\n\t\t\tRefLines.parse(\"// \"+i18n('comment.sources.'+this.type)),\r\n\t\t\t\"var \"+this.nodeJsName+\"=ctx.createMediaElementSource(document.getElementById('\"+this.elementHtmlName+\"'));\"\r\n\t\t)\r\n\t}\r\n\t// abstract:\r\n\t// get type()\r\n\t// getElementHtmlLines(featureContext,i18n)\r\n}\r\n\r\nconst sourceClasses={\r\n\taudio: class extends Source {\r\n\t\tget type() { return 'audio' }\r\n\t\tgetElementHtmlLines(featureContext,i18n) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\tLines.html`<audio src=${this.options.url} id=${this.elementHtmlName} controls loop crossorigin=${featureContext.audioContext?'anonymous':false}></audio>`\r\n\t\t\t)\r\n\t\t}\r\n\t},\r\n\tvideo: class extends Source {\r\n\t\tget type() { return 'video' }\r\n\t\tgetElementHtmlLines(featureContext,i18n) {\r\n\t\t\treturn Lines.bae(\r\n\t\t\t\tLines.html`<video src=${this.options.url} id=${this.elementHtmlName} width=${this.options.width} height=${this.options.height} controls loop crossorigin=${featureContext.audioContext?'anonymous':false}></video>`\r\n\t\t\t)\r\n\t\t}\r\n\t},\r\n}\r\n\r\nclass SourceSet extends CollectionFeature {\r\n\tgetEntryClass(entryOption) {\r\n\t\treturn sourceClasses[entryOption.source]\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tif (this.entries.length>0) {\r\n\t\t\tfeatureContext.audioProcessing=true\r\n\t\t}\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst a=InterleaveLines.b()\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\ta(...this.entries.map(entry=>entry.getJsInitLines(i18n)))\r\n\t\t}\r\n\t\treturn a.e()\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\treturn this.entries.map(entry=>entry.nodeJsName)\r\n\t\t} else {\r\n\t\t\treturn prevNodeJsNames\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=SourceSet\r\n"],"sourceRoot":"."}