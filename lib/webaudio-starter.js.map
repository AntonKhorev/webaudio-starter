{"version":3,"sources":["webaudio-starter.js","node_modules/browser-pack/_prelude.js","node_modules/crnx-base/lines.js","node_modules/crnx-base/option-classes.js","node_modules/crnx-base/options-output.js","node_modules/crnx-base/options.js","src/audio-context.js","src/canvas.js","src/code-output.js","src/code.js","src/collection-feature.js","src/destination.js","src/feature.js","src/filter-sequence.js","src/html-lines.js","src/i18n.js","src/main.js","src/option-classes.js","src/options-output.js","src/options.js","src/source-set.js"],"names":["babelHelpers","typeof","obj","Symbol","constructor","createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","classCallCheck","instance","TypeError","possibleConstructorReturn","self","call","ReferenceError","inherits","subClass","superClass","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","undefined","create","e","t","n","r","s","o","u","a","require","f","Error","code","l","exports",1,"module","Lines","this","data","flattenArgs","arguments","preprocessString","str","_this","push","Array","isArray","apply","map","_data","_data2","lastLine","pop","indent","level","line","join","isEmpty","interleave","first","_data3","wrap","begin","end","unshift","wrapIfNotEmpty","replace","match",2,"Option","Base","_class","name","_1","_2","_3","fullName","isVisible","updateCallback","_$","updateVisibility","$","toggle","shortenExport","dataKeys","shortenExportAssign","parentData","get","set","Input","_Option$Base","_class2","availableValues","defaultValue","_value","BooleanInput","_Option$Input","_class3","fix","NonBooleanInput","_Option$Input2","_class4","valueOf","toString","String","FactorInput","_Option$NonBooleanInp","_class5","_this4","RangeInput","_Option$NonBooleanInp2","_class6","availableRange","_this5","availableMin","availableMax","Collection","_Option$Base2","_class7","entries","_this6","forEach","entry","fixedEntries","fixed","Void","_Option$Base3","_class8","Checkbox","_Option$BooleanInput","_class9","_","Select","_Option$FactorInput","_class10","Text","_Option$FactorInput2","_class11","Int","_Option$RangeInput","_class12","Root","_Option$Collection","_class13","Group","_Option$Collection2","_class14","_Option$Base4","_class15","availableConstructors","typePropertyName","_this14","_entries","subDatas","defaultType","availableTypes","subData","subType","subCtor","addEntry","type","_this15","_this16","subFixed","types",3,"OptionsOutput","options","generateId","i18n","write","option","optionProto","getPrototypeOf","optionClassWriter","optionClassWriters","Map","setOptionClassWriters","$output","root","writeOption","append","html","id","prop","change","availableValue","val","listId","on","text","attr","step","checkValidity","$dragged","$entries","updateArrayEntries","children","writeDraggableOption","ev","parent","originalEvent","dataTransfer","effectAllowed","setData","setDragImage","setTimeout","addClass","keydown","$handle","$sorted","keyCode","prev","before","focus","next","after","click","remove","preventDefault","dropEffect","$target","nextAll","is","prevAll","removeClass","$buttons","./option-classes.js",4,"Options","simpleUpdateCallback","optionClasses","optionByFullName","optionsWithVisibilityAffectedByFullName","makeEntry","description","fullNamePath","isInsideArray","className","ctorArgsDescription","slice","contents","visibilityData","nScalars","nArrays","nObjects","arg","x","subName","ctor","testName","indexOf","entriesDescription",5,"UnescapedLines","Feature","AudioContext","_Feature","getJsInitLines","featureContext","prevNodeJsNames","_Feature$prototype$ge","lines","concat","audioContext","./feature.js","./html-lines.js","crnx-base/lines",6,"Canvas","getHtmlLines","canvas","_Feature$prototype$ge2",7,"CodeOutput","generateCodeFn","$code","getHtmlDataUri","encodeURIComponent","writeControls","window","open","hljs","highlightBlock","delay","timeoutId","update","clearTimeout",8,"SourceSet","FilterSequence","Destination","features","sources","filters","destination","feature","requestFeatureContext","alignedInputs","jsTopLineSets","getNodeJsNames","Function","bind","getJsLoopLines","./audio-context.js","./canvas.js","./destination.js","./filter-sequence.js","./source-set.js",9,"CollectionFeature","entryOptions","entryCounts","entryOption","entryClass","getEntryClass","entryCounts2",10,"audioProcessing","compressor","waveform","_this2","nextNodeJsName","prevNodeJsName",11,12,"capitalize","charAt","toUpperCase","toCamelCase","split","w","Filter","getPropertyOptionName","property","getPropertyInputHtmlName","propertyName","nSuffix","getPropertyInputJsName","getHtmlPropertyLines","inputHtmlName","input","min","max","nodeProperties","nodeJsName","ctxCreateMethodName","SinglePathFilter","_Filter","nodePropertyJsName","inputJsName","fn","eventProp","PassiveByDefaultSinglePathFilter","_SinglePathFilter","every","filterClasses","gain","_PassiveByDefaultSing","panner","_PassiveByDefaultSing2","biquad","_SinglePathFilter2","convolver","_Filter2","_this11","messageHtmlName","reverb","wetGainNodeJsName","dryGainNodeJsName","url","equalizer","_Filter3","getFrequencyOption","allGainsConstant","_this13","singleFreq","affectedFreqsAndOptions","fo","noGainsConstant","getJsData","freq","getJsDataItem","gainLines","inputHtmlNameExpr","listenerLines","outerNodeJsName","frequencies","filter","_CollectionFeature","skipNode","_CollectionFeature$pr","nodeJsNames","./collection-feature.js",13,"HtmlLines","_Lines",14,"i18nLinkFilter","inStrings","linkRegexp","outStrings","strings","options.sources","options.sources.audio","options.sources.audio.add","options.sources.audio.url","options.sources.video","options.sources.video.add","options.sources.video.url","options.sources.video.width","options.sources.video.height","options.filters","options.filters.gain","options.filters.gain.add","options.filters.gain.gain","options.filters.panner","options.filters.panner.add","options.filters.panner.pan","options.filters.biquad","options.filters.biquad.add","options.filters.biquad.type","options.filters.biquad.type.lowpass","options.filters.biquad.type.highpass","options.filters.biquad.type.bandpass","options.filters.biquad.type.lowshelf","options.filters.biquad.type.highshelf","options.filters.biquad.type.peaking","options.filters.biquad.type.notch","options.filters.biquad.type.allpass","options.filters.biquad.frequency","options.filters.biquad.Q","options.filters.biquad.detune","options.filters.biquad.gain","options.filters.convolver","options.filters.convolver.add","options.filters.convolver.url","options.filters.convolver.reverb","options.filters.convolver.buffer.loading","options.filters.convolver.buffer.error","options.filters.equalizer","options.filters.equalizer.add","options.filters.equalizer.gain60","options.filters.equalizer.gain170","options.filters.equalizer.gain350","options.filters.equalizer.gain1000","options.filters.equalizer.gain3500","options.filters.equalizer.gain10000","options.destination","options.destination.compressor","options.destination.compressor.enable","options.destination.waveform","options-output.drag","options-output.delete","options-output.input","options-output.range","options-output.reset","comment.context","comment.sources.audio","comment.sources.video","comment.filters.gain","comment.filters.panner","comment.filters.biquad","comment.filters.convolver","comment.filters.convolver.single","comment.filters.equalizer","comment.filters.equalizer.single","comment.destination","comment.destination.compressor","comment.destination.waveform","lang",15,"idCounter","generateCode","each","$container","codeOutput","optionsOutput","empty","./code-output","./code.js","./i18n.js","./options-output","./options.js",16,"FixedLiveNumber","src","LiveNumber","dataValue","dataMin","dataMax","dataInput","defaultMin","defaultMax","_min","_max","_input","_$range","updateInternalVisibility","exportHelper","$range","LiveInt","_Option$LiveNumber","LiveFloat","_Option$LiveNumber2","FixedLiveSelect","LiveSelect","_Option$Select","crnx-base/option-classes",17,"BaseOptionsOutput","_BaseOptionsOutput","setInputAttrs","$input","setInputAttrsAndListeners","getOtherInput","$that","parseFloat","writeMinMaxInput","minOrMax","inputCheckboxId","$sliderInput","$numberInput","$inputCheckbox","$rangeMinInput","$rangeMaxInput","$select","crnx-base/options-output",18,"BaseOptions","_BaseOptions","crnx-base/options",19,"Source","getElementHtmlLines","elementHtmlName","sourceClasses","audio","_Source","video","_Source2","width","height","source"],"mappings":"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","file":"webaudio-starter.js","sourcesContent":["(function () {\n    var babelHelpers = {\n        typeof: function (obj) {\n            return obj && typeof Symbol !== 'undefined' && obj.constructor === Symbol ? 'symbol' : typeof obj;\n        },\n        createClass: function () {\n            function defineProperties(target, props) {\n                for (var i = 0; i < props.length; i++) {\n                    var descriptor = props[i];\n                    descriptor.enumerable = descriptor.enumerable || false;\n                    descriptor.configurable = true;\n                    if ('value' in descriptor)\n                        descriptor.writable = true;\n                    Object.defineProperty(target, descriptor.key, descriptor);\n                }\n            }\n            return function (Constructor, protoProps, staticProps) {\n                if (protoProps)\n                    defineProperties(Constructor.prototype, protoProps);\n                if (staticProps)\n                    defineProperties(Constructor, staticProps);\n                return Constructor;\n            };\n        }(),\n        classCallCheck: function (instance, Constructor) {\n            if (!(instance instanceof Constructor)) {\n                throw new TypeError('Cannot call a class as a function');\n            }\n        },\n        possibleConstructorReturn: function (self, call) {\n            if (!self) {\n                throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called');\n            }\n            return call && (typeof call === 'object' || typeof call === 'function') ? call : self;\n        },\n        inherits: function (subClass, superClass) {\n            function defaults(obj, defaults) {\n                var keys = Object.getOwnPropertyNames(defaults);\n                for (var i = 0; i < keys.length; i++) {\n                    var key = keys[i];\n                    var value = Object.getOwnPropertyDescriptor(defaults, key);\n                    if (value && value.configurable && obj[key] === undefined) {\n                        Object.defineProperty(obj, key, value);\n                    }\n                }\n                return obj;\n            }\n            ;\n            if (typeof superClass !== 'function' && superClass !== null) {\n                throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);\n            }\n            subClass.prototype = Object.create(superClass && superClass.prototype, {\n                constructor: {\n                    value: subClass,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true\n                }\n            });\n            if (superClass)\n                defaults(subClass, superClass);\n        }\n    };\n    (function e(t, n, r) {\n        function s(o, u) {\n            if (!n[o]) {\n                if (!t[o]) {\n                    var a = typeof require == 'function' && require;\n                    if (!u && a)\n                        return a(o, !0);\n                    if (i)\n                        return i(o, !0);\n                    var f = new Error('Cannot find module \\'' + o + '\\'');\n                    throw f.code = 'MODULE_NOT_FOUND', f;\n                }\n                var l = n[o] = { exports: {} };\n                t[o][0].call(l.exports, function (e) {\n                    var n = t[o][1][e];\n                    return s(n ? n : e);\n                }, l, l.exports, e, t, n, r);\n            }\n            return n[o].exports;\n        }\n        var i = typeof require == 'function' && require;\n        for (var o = 0; o < r.length; o++)\n            s(r[o]);\n        return s;\n    }({\n        1: [\n            function (require, module, exports) {\n                'use strict';\n                /*\r\n.a = add AFTER last line\r\n.t = add TO last line\r\n*/\n                var Lines = function () {\n                    function Lines() {\n                        babelHelpers.classCallCheck(this, Lines);\n                        this.data = this.flattenArgs(arguments);\n                    }\n                    // private:\n                    Lines.prototype.preprocessString = function preprocessString(str) {\n                        return str;\n                    };\n                    Lines.prototype.flattenArgs = function flattenArgs(s) {\n                        var _this = this;\n                        var r = [];\n                        for (var i = 0; i < s.length; i++) {\n                            if (typeof s[i] == 'string') {\n                                r.push(this.preprocessString(s[i]));\n                            } else if (Array.isArray(s[i])) {\n                                // TODO remove and use lines.a(...array) instead\n                                r.push.apply(r, s[i].map(function (str) {\n                                    return _this.preprocessString(str);\n                                }));\n                            } else if (s[i] instanceof Lines) {\n                                r.push.apply(r, s[i].data);\n                            }\n                        }\n                        return r;\n                    };\n                    // public:\n                    Lines.prototype.a = function a() {\n                        var _data;\n                        (_data = this.data).push.apply(_data, this.flattenArgs(arguments));\n                        return this;\n                    };\n                    Lines.prototype.t = function t() {\n                        var _data2;\n                        var lastLine = this.data.pop();\n                        var s = this.flattenArgs(arguments);\n                        s[0] = lastLine + s[0];\n                        (_data2 = this.data).push.apply(_data2, s);\n                        return this;\n                    };\n                    Lines.prototype.indent = function indent(level) {\n                        if (level === undefined) {\n                            level = 1;\n                        }\n                        this.data = this.data.map(function (line) {\n                            return Array(level + 1).join('\\t') + line;\n                        });\n                        return this;\n                    };\n                    Lines.prototype.isEmpty = function isEmpty() {\n                        return this.data.length <= 0;\n                    };\n                    Lines.prototype.interleave = function interleave() {\n                        var first = true;\n                        for (var i = 0; i < arguments.length; i++) {\n                            var r = this.flattenArgs([arguments[i]]);\n                            if (r.length > 0) {\n                                var _data3;\n                                if (first) {\n                                    first = false;\n                                } else {\n                                    this.data.push('');\n                                }\n                                (_data3 = this.data).push.apply(_data3, r);\n                            }\n                        }\n                        return this;\n                    };\n                    Lines.prototype.wrap = function wrap(begin, end) {\n                        this.indent();\n                        this.data.unshift(this.preprocessString(begin));\n                        this.data.push(this.preprocessString(end));\n                        return this;\n                    };\n                    Lines.prototype.wrapIfNotEmpty = function wrapIfNotEmpty(begin, end) {\n                        if (!this.isEmpty()) {\n                            this.wrap(begin, end);\n                        }\n                        return this;\n                    };\n                    /*\r\n \twrapEachLine(begin,end) {\r\n \t\tthis.data=this.data.map(function(line){\r\n \t\t\treturn begin+line+end;\r\n \t\t});\r\n \t\treturn this;\r\n \t}\r\n \tmap(fn) {\r\n \t\tthis.data=this.data.map(fn);\r\n \t\treturn this;\r\n \t}\r\n */\n                    Lines.prototype.join = function join(indent) {\n                        return this.data.map(function (line) {\n                            return line.replace(/^(\\t)+/, function (match) {\n                                return Array(match.length + 1).join(indent);\n                            });\n                        }).join('\\n');\n                    };\n                    return Lines;\n                }();\n                module.exports = Lines;\n            },\n            {}\n        ],\n        2: [\n            function (require, module, exports) {\n                'use strict';\n                // constructors typically called from Options class\n                // to call them manually, use the following args:\n                //\tname,contents/availableValues,defaultValue,data - similar to entriesDescription()\n                // the rest of arguments' order is not settled, don't use them\n                // \t+ TODO not sure about data\n                /*\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\n                var Option = {};\n                // abstract classes\n                Option.Base = function () {\n                    function _class(name, _1, _2, _3, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class);\n                        this.name = name;\n                        this.isVisible = isVisible;\n                        this.updateCallback = updateCallback;\n                        this.fullName = fullName;\n                        this._$ = null;\n                    }\n                    _class.prototype.updateVisibility = function updateVisibility() {\n                        if (this.$)\n                            this.$.toggle(this.isVisible());\n                    };\n                    _class.prototype.shortenExport = function shortenExport(data) {\n                        // used by parent\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            return data.value;\n                        } else {\n                            return data;\n                        }\n                    };\n                    _class.prototype.shortenExportAssign = function shortenExportAssign(data, parentData, name) {\n                        var dataKeys = Object.keys(data);\n                        if (dataKeys.length == 1 && dataKeys[0] == 'value') {\n                            parentData[name] = data.value;\n                        } else if (dataKeys.length > 0) {\n                            parentData[name] = data;\n                        }\n                    };\n                    babelHelpers.createClass(_class, [{\n                            key: '$',\n                            get: function () {\n                                return this._$;\n                            },\n                            set: function ($) {\n                                this._$ = $;\n                                this.updateVisibility();\n                            }\n                        }]);\n                    return _class;\n                }();\n                Option.Input = function (_Option$Base) {\n                    babelHelpers.inherits(_class2, _Option$Base);\n                    function _class2(name, availableValues, defaultValue, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class2);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$Base.apply(this, arguments));\n                        if (defaultValue !== undefined) {\n                            _this.defaultValue = defaultValue;\n                        } else {\n                            _this.defaultValue = availableValues[0];\n                        }\n                        if (typeof data == 'object') {\n                            data = data.value;\n                        }\n                        if (data !== undefined) {\n                            _this._value = data;\n                        } else {\n                            _this._value = _this.defaultValue;\n                        }\n                        return _this;\n                    }\n                    _class2.prototype.export = function _export() {\n                        var data = {};\n                        if (this.value != this.defaultValue)\n                            data.value = this.value;\n                        return data;\n                    };\n                    babelHelpers.createClass(_class2, [{\n                            key: 'value',\n                            get: function () {\n                                return this._value;\n                            },\n                            set: function (value) {\n                                this._value = value;\n                                this.updateCallback();\n                            }\n                        }]);\n                    return _class2;\n                }(Option.Base);\n                Option.BooleanInput = function (_Option$Input) {\n                    babelHelpers.inherits(_class3, _Option$Input);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input.apply(this, arguments));\n                    }\n                    _class3.prototype.fix = function fix() {\n                        return this.value;\n                    };\n                    return _class3;\n                }(Option.Input);\n                Option.NonBooleanInput = function (_Option$Input2) {\n                    babelHelpers.inherits(_class4, _Option$Input2);\n                    function _class4() {\n                        babelHelpers.classCallCheck(this, _class4);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Input2.apply(this, arguments));\n                    }\n                    _class4.prototype.fix = function fix() {\n                        var value = this.value;\n                        return {\n                            // can't use fixed value in boolean context\n                            name: this.name,\n                            value: value,\n                            valueOf: function () {\n                                return value;\n                            },\n                            toString: function () {\n                                return String(value);\n                            }\n                        };\n                    };\n                    return _class4;\n                }(Option.Input);\n                Option.FactorInput = function (_Option$NonBooleanInp) {\n                    babelHelpers.inherits(_class5, _Option$NonBooleanInp);\n                    function _class5(name, availableValues, defaultValue, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class5);\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$NonBooleanInp.apply(this, arguments));\n                        _this4.availableValues = availableValues;\n                        return _this4;\n                    }\n                    return _class5;\n                }(Option.NonBooleanInput);\n                Option.RangeInput = function (_Option$NonBooleanInp2) {\n                    babelHelpers.inherits(_class6, _Option$NonBooleanInp2);\n                    function _class6(name, availableRange, defaultValue, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class6);\n                        var _this5 = babelHelpers.possibleConstructorReturn(this, _Option$NonBooleanInp2.apply(this, arguments));\n                        _this5.availableMin = availableRange[0];\n                        _this5.availableMax = availableRange[1];\n                        return _this5;\n                    }\n                    return _class6;\n                }(Option.NonBooleanInput);\n                Option.Collection = function (_Option$Base2) {\n                    babelHelpers.inherits(_class7, _Option$Base2);\n                    function _class7(name, entries, _1, _2, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class7);\n                        var _this6 = babelHelpers.possibleConstructorReturn(this, _Option$Base2.apply(this, arguments));\n                        _this6.entries = entries;\n                        return _this6;\n                    }\n                    _class7.prototype.export = function _export() {\n                        var data = {};\n                        this.entries.forEach(function (entry) {\n                            entry.shortenExportAssign(entry.export(), data, entry.name);\n                        });\n                        return data;\n                    };\n                    _class7.prototype.fix = function fix() {\n                        var fixedEntries = [];\n                        var fixed = {\n                            name: this.name,\n                            entries: fixedEntries\n                        };\n                        this.entries.forEach(function (entry) {\n                            fixedEntries.push(fixed[entry.name] = entry.fix());\n                        });\n                        return fixed;\n                    };\n                    return _class7;\n                }(Option.Base);\n                // concrete classes\n                Option.Void = function (_Option$Base3) {\n                    babelHelpers.inherits(_class8, _Option$Base3);\n                    function _class8() {\n                        babelHelpers.classCallCheck(this, _class8);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Base3.apply(this, arguments));\n                    }\n                    // useful as array entry w/o settings\n                    _class8.prototype.export = function _export() {\n                        return {};\n                    };\n                    _class8.prototype.fix = function fix() {\n                        return { name: this.name };\n                    };\n                    return _class8;\n                }(Option.Base);\n                Option.Checkbox = function (_Option$BooleanInput) {\n                    babelHelpers.inherits(_class9, _Option$BooleanInput);\n                    function _class9(name, _, defaultValue, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class9);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$BooleanInput.call(this, name, undefined, !!defaultValue, data, fullName, isVisible, updateCallback));\n                    }\n                    return _class9;\n                }(Option.BooleanInput);\n                Option.Select = function (_Option$FactorInput) {\n                    babelHelpers.inherits(_class10, _Option$FactorInput);\n                    function _class10() {\n                        babelHelpers.classCallCheck(this, _class10);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$FactorInput.apply(this, arguments));\n                    }\n                    return _class10;\n                }(Option.FactorInput);\n                Option.Text = function (_Option$FactorInput2) {\n                    babelHelpers.inherits(_class11, _Option$FactorInput2);\n                    function _class11() {\n                        babelHelpers.classCallCheck(this, _class11);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$FactorInput2.apply(this, arguments));\n                    }\n                    return _class11;\n                }(Option.FactorInput);\n                Option.Int = function (_Option$RangeInput) {\n                    babelHelpers.inherits(_class12, _Option$RangeInput);\n                    function _class12() {\n                        babelHelpers.classCallCheck(this, _class12);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$RangeInput.apply(this, arguments));\n                    }\n                    return _class12;\n                }(Option.RangeInput);\n                Option.Root = function (_Option$Collection) {\n                    babelHelpers.inherits(_class13, _Option$Collection);\n                    function _class13() {\n                        babelHelpers.classCallCheck(this, _class13);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection.apply(this, arguments));\n                    }\n                    return _class13;\n                }(Option.Collection);\n                Option.Group = function (_Option$Collection2) {\n                    babelHelpers.inherits(_class14, _Option$Collection2);\n                    function _class14() {\n                        babelHelpers.classCallCheck(this, _class14);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$Collection2.apply(this, arguments));\n                    }\n                    return _class14;\n                }(Option.Collection);\n                Option.Array = function (_Option$Base4) {\n                    babelHelpers.inherits(_class15, _Option$Base4);\n                    function _class15(name, availableConstructors, typePropertyName, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class15);\n                        var _this14 = babelHelpers.possibleConstructorReturn(this, _Option$Base4.call(this, name, undefined, undefined, undefined, fullName, isVisible, updateCallback));\n                        _this14.availableConstructors = availableConstructors;\n                        // Map {type:constructor}\n                        if (typePropertyName === undefined)\n                            typePropertyName = 'type';\n                        _this14.typePropertyName = typePropertyName;\n                        _this14._entries = [];\n                        var subDatas = [];\n                        if (Array.isArray(data)) {\n                            subDatas = data;\n                        } else if (typeof data == 'object') {\n                            subDatas = data.value;\n                        }\n                        var defaultType = _this14.availableTypes[0];\n                        for (var i = 0; i < subDatas.length; i++) {\n                            var subData = subDatas[i];\n                            var subType = defaultType;\n                            if (typeof subData == 'object' && subData[typePropertyName] !== undefined) {\n                                subType = subData[typePropertyName];\n                            }\n                            var subCtor = _this14.availableConstructors.get(subType);\n                            if (subCtor) {\n                                _this14._entries.push(subCtor(subData));\n                            }\n                        }\n                        return _this14;\n                    }\n                    _class15.prototype.addEntry = function addEntry(type) {\n                        var entry = this.availableConstructors.get(type)();\n                        this._entries.push(entry);\n                        this.updateCallback();\n                        return entry;\n                    };\n                    _class15.prototype.export = function _export() {\n                        var _this15 = this;\n                        var defaultType = this.availableTypes[0];\n                        return {\n                            value: this._entries.map(function (entry) {\n                                var subData = entry.export();\n                                var subType = entry.name;\n                                if (subType != defaultType)\n                                    subData[_this15.typePropertyName] = subType;\n                                return entry.shortenExport(subData);\n                            })\n                        };\n                    };\n                    _class15.prototype.fix = function fix() {\n                        var _this16 = this;\n                        return {\n                            name: this.name,\n                            entries: this._entries.map(function (entry) {\n                                var subFixed = entry.fix();\n                                if (typeof subFixed == 'object')\n                                    subFixed[_this16.typePropertyName] = entry.name;\n                                return subFixed;\n                            })\n                        };\n                    };\n                    babelHelpers.createClass(_class15, [\n                        {\n                            key: 'availableTypes',\n                            get: function () {\n                                var types = [];\n                                this.availableConstructors.forEach(function (_, type) {\n                                    types.push(type);\n                                });\n                                return types;\n                            }\n                        },\n                        {\n                            key: 'entries',\n                            get: function () {\n                                return this._entries;\n                            },\n                            set: function (entries) {\n                                this._entries = entries;\n                                this.updateCallback();\n                            }\n                        }\n                    ]);\n                    return _class15;\n                }(Option.Base);\n                module.exports = Option;\n            },\n            {}\n        ],\n        3: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require('./option-classes.js');\n                var OptionsOutput = function () {\n                    function OptionsOutput(options, generateId, i18n) {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        var optionClassWriters = new Map();\n                        this.setOptionClassWriters(optionClassWriters);\n                        function write(option) {\n                            var optionProto = option;\n                            while (optionProto = Object.getPrototypeOf(optionProto)) {\n                                var optionClassWriter = optionClassWriters.get(optionProto.constructor);\n                                if (optionClassWriter) {\n                                    return optionClassWriter(option, write, i18n, generateId);\n                                }\n                            }\n                        }\n                        // public prop:\n                        this.$output = write(options.root);\n                    }\n                    // override this fn for custom writers\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        optionClassWriters.set(Option.Root, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'options-output\\'>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Group, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append(option.entries.map(writeOption));\n                        });\n                        optionClassWriters.set(Option.Void, function (option, writeOption, i18n, generateId) {\n                            return option.$ = $('<div class=\\'option void\\'>').html(i18n('options.' + option.fullName));\n                        });\n                        optionClassWriters.set(Option.Checkbox, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append($('<input type=\\'checkbox\\' id=\\'' + id + '\\'>').prop('checked', option.value).change(function () {\n                                option.value = $(this).prop('checked');\n                            })).append(' <label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + '</label>');\n                        });\n                        optionClassWriters.set(Option.Select, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>').append(' ').append($('<select id=\\'' + id + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').val(availableValue).html(i18n('options.' + option.fullName + '.' + availableValue));\n                            })).val(option.value).change(function () {\n                                option.value = this.value;\n                            }));\n                        });\n                        optionClassWriters.set(Option.Text, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            var listId = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>').append(' ').append($('<input type=\\'text\\' id=\\'' + id + '\\' list=\\'' + listId + '\\' />').val(option.value).on('input change', function () {\n                                option.value = this.value;\n                            })).append(' ').append($('<datalist id=\\'' + listId + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').text(availableValue);\n                            })));\n                        });\n                        optionClassWriters.set(Option.Int, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>').append(' ').append($('<input type=\\'number\\' id=\\'' + id + '\\' required />').val(option.value).attr('min', option.availableMin).attr('max', option.availableMax).attr('step', option.step).on('input change', function () {\n                                if (this.checkValidity()) {\n                                    option.value = this.value;\n                                }\n                            }));\n                        });\n                        optionClassWriters.set(Option.Array, function (option, writeOption, i18n, generateId) {\n                            var $dragged = null;\n                            var $entries = undefined;\n                            var updateArrayEntries = function () {\n                                option.entries = $entries.children().map(function () {\n                                    return $(this).data('option');\n                                }).get();\n                            };\n                            var writeDraggableOption = function (option) {\n                                // have to make drag handler 'draggable', not the whole item\n                                // because inputs and labels don't like to be inside 'draggable'\n                                // http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\n                                return $('<div class=\\'draggable-with-handle\\'>').data('option', option).append($('<div draggable=\\'true\\' tabindex=\\'0\\' title=\\'' + i18n('options-output.drag') + '\\'>').on('dragstart', function (ev) {\n                                    $dragged = $(this).parent();\n                                    ev.originalEvent.dataTransfer.effectAllowed = 'move';\n                                    ev.originalEvent.dataTransfer.setData('Text', name);\n                                    if (ev.originalEvent.dataTransfer.setDragImage) {\n                                        // doesn't work in IE\n                                        ev.originalEvent.dataTransfer.setDragImage($dragged[0], 0, 0);\n                                    }\n                                    setTimeout(function () {\n                                        $dragged.addClass('ghost');\n                                    }, 0);\n                                }).keydown(function (ev) {\n                                    var $handle = $(this);\n                                    var $sorted = $handle.parent();\n                                    if (ev.keyCode == 38) {\n                                        $sorted.prev().before($sorted);\n                                        $handle.focus();\n                                        updateArrayEntries();\n                                        return false;\n                                    } else if (ev.keyCode == 40) {\n                                        $sorted.next().after($sorted);\n                                        $handle.focus();\n                                        updateArrayEntries();\n                                        return false;\n                                    }\n                                })).append(writeOption(option)).append(//$(\"<div tabindex='0' class='delete' title='\"+i18n('options-output.delete')+\"'></div>\")\n                                $('<div tabindex=\\'0\\' class=\\'delete\\' title=\\'' + i18n('options-output.delete') + '\\'>').click(function () {\n                                    $(this).parent().remove();\n                                    updateArrayEntries();\n                                }).keydown(function (ev) {\n                                    if (ev.keyCode == 13 || ev.keyCode == 32) {\n                                        $(this).parent().remove();\n                                        updateArrayEntries();\n                                        return false;\n                                    }\n                                })).on('dragover', function (ev) {\n                                    ev.preventDefault();\n                                    ev.originalEvent.dataTransfer.dropEffect = 'move';\n                                    var $target = $(this);\n                                    if ($dragged) {\n                                        if ($target.nextAll().is($dragged)) {\n                                            $target.before($dragged);\n                                            updateArrayEntries();\n                                        } else if ($target.prevAll().is($dragged)) {\n                                            $target.after($dragged);\n                                            updateArrayEntries();\n                                        }\n                                    }\n                                }).on('drop', function (ev) {\n                                    ev.preventDefault();\n                                }).on('dragend', function (ev) {\n                                    ev.preventDefault();\n                                    if ($dragged) {\n                                        $dragged.removeClass('ghost');\n                                        $dragged = null;\n                                    }\n                                });\n                            };\n                            option.$ = $('<fieldset>').append('<legend>' + i18n('options.' + option.fullName) + '</legend>').append($entries = $('<div>').append(option.entries.map(writeDraggableOption)));\n                            var $buttons = $('<div>');\n                            option.availableTypes.forEach(function (type, i) {\n                                if (i)\n                                    $buttons.append(' ');\n                                $buttons.append($('<button type=\\'button\\'>').html(i18n('options.' + option.fullName + '.' + type + '.add')).click(function () {\n                                    var entry = option.addEntry(type);\n                                    $entries.append(writeDraggableOption(entry));\n                                }));\n                            });\n                            option.$.append($buttons);\n                            return option.$;\n                        });\n                    };\n                    return OptionsOutput;\n                }();\n                module.exports = OptionsOutput;\n            },\n            { './option-classes.js': 2 }\n        ],\n        4: [\n            function (require, module, exports) {\n                'use strict';\n                var Options = function () {\n                    function Options(data) {\n                        var _this = this;\n                        babelHelpers.classCallCheck(this, Options);\n                        // data = imported values, import is done in ctor to avoid calling updateCallback later\n                        this.updateCallback = undefined;\n                        // general update callback for stuff like regenerating the code\n                        var simpleUpdateCallback = function () {\n                            if (_this.updateCallback)\n                                _this.updateCallback();\n                        };\n                        var Option = this.optionClasses;\n                        var optionByFullName = {};\n                        var optionsWithVisibilityAffectedByFullName = {};\n                        var makeEntry = function (description, fullNamePath, data, isInsideArray) {\n                            var className = description[0];\n                            if (Option[className] === undefined) {\n                                throw new Error('invalid option type \\'' + className + '\\'');\n                            }\n                            var name = description[1];\n                            var fullName = fullNamePath + name;\n                            var ctorArgsDescription = description.slice(2);\n                            var contents = [];\n                            var defaultValue = undefined;\n                            var visibilityData = {};\n                            var nScalars = 0;\n                            var nArrays = 0;\n                            var nObjects = 0;\n                            for (var i = 0; i < ctorArgsDescription.length; i++) {\n                                var arg = ctorArgsDescription[i];\n                                if (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\n                                    if (nScalars == 0) {\n                                        defaultValue = arg;\n                                    } else {\n                                        throw new Error('too many scalar arguments');\n                                    }\n                                    nScalars++;\n                                } else if (Array.isArray(arg)) {\n                                    if (nArrays == 0) {\n                                        if (!isInsideArray && className == 'Array') {\n                                            // TODO test array inside array\n                                            contents = new Map();\n                                            arg.forEach(function (x) {\n                                                var type = x[1];\n                                                var ctor = function (subData) {\n                                                    return makeEntry(x, fullName + '.', subData, true);\n                                                };\n                                                contents.set(type, ctor);\n                                            });\n                                        } else {\n                                            contents = arg.map(function (x) {\n                                                if (Array.isArray(x)) {\n                                                    var subName = x[1];\n                                                    var subData = undefined;\n                                                    if (typeof data == 'object')\n                                                        subData = data[subName];\n                                                    return makeEntry(x, fullName + '.', subData, isInsideArray);    // nested option\n                                                } else {\n                                                    return x;    // available value / value range boundary\n                                                }\n                                            });\n                                        }\n                                    } else {\n                                        throw new Error('too many array arguments');\n                                    }\n                                    nArrays++;\n                                } else if (!isInsideArray && arg instanceof Object) {\n                                    if (nObjects == 0) {\n                                        visibilityData = arg;\n                                    } else {\n                                        throw new Error('too many array arguments');\n                                    }\n                                    nObjects++;\n                                } else {\n                                    throw new Error('unknown argument type');\n                                }\n                            }\n                            var isVisible = undefined, updateCallback = undefined;\n                            if (isInsideArray) {\n                                updateCallback = simpleUpdateCallback;\n                                isVisible = function () {\n                                    return true;\n                                };\n                            } else {\n                                isVisible = function () {\n                                    for (var testName in visibilityData) {\n                                        var value = optionByFullName[testName].value;\n                                        if (visibilityData[testName].indexOf(value) < 0) {\n                                            return false;\n                                        }\n                                    }\n                                    return true;\n                                };\n                                updateCallback = function () {\n                                    if (optionsWithVisibilityAffectedByFullName[fullName] !== undefined) {\n                                        optionsWithVisibilityAffectedByFullName[fullName].forEach(function (option) {\n                                            option.updateVisibility();\n                                        });\n                                    }\n                                    if (_this.updateCallback)\n                                        _this.updateCallback();\n                                };\n                            }\n                            var option = new Option[className](name, contents, defaultValue, data, fullName, isVisible, updateCallback);\n                            if (!isInsideArray) {\n                                optionByFullName[fullName] = option;\n                                for (var testName in visibilityData) {\n                                    if (optionsWithVisibilityAffectedByFullName[testName] === undefined) {\n                                        optionsWithVisibilityAffectedByFullName[testName] = [];\n                                    }\n                                    optionsWithVisibilityAffectedByFullName[testName].push(option);\n                                }\n                            }\n                            return option;\n                        };\n                        this.root = new Option.Root(null, this.entriesDescription.map(function (description) {\n                            var subName = description[1];\n                            var subData = undefined;\n                            if (typeof data == 'object')\n                                subData = data[subName];\n                            return makeEntry(description, '', subData, false);\n                        }), undefined, data, null, function () {\n                            return true;\n                        }, simpleUpdateCallback);\n                    }\n                    // methods to be redefined by subclasses\n                    // TODO make them static?\n                    // public methods\n                    Options.prototype.export = function _export() {\n                        return this.root.shortenExport(this.root.export());\n                    };\n                    Options.prototype.fix = function fix() {\n                        return this.root.fix();\n                    };\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require('./option-classes.js');\n                            }\n                        },\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [];\n                            }\n                        }\n                    ]);\n                    return Options;\n                }();\n                module.exports = Options;\n            },\n            { './option-classes.js': 2 }\n        ],\n        5: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var UnescapedLines = require('crnx-base/lines');\n                var Feature = require('./feature.js');\n                var AudioContext = function (_Feature) {\n                    babelHelpers.inherits(AudioContext, _Feature);\n                    function AudioContext() {\n                        babelHelpers.classCallCheck(this, AudioContext);\n                        return babelHelpers.possibleConstructorReturn(this, _Feature.apply(this, arguments));\n                    }\n                    AudioContext.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var _Feature$prototype$ge;\n                        var lines = (_Feature$prototype$ge = _Feature.prototype.getJsInitLines).call.apply(_Feature$prototype$ge, [this].concat(Array.prototype.slice.call(arguments)));\n                        if (featureContext.audioContext) {\n                            lines.a(new UnescapedLines('// ' + i18n('comment.context')), 'var ctx=new (AudioContext || webkitAudioContext);');\n                        }\n                        return lines;\n                    };\n                    return AudioContext;\n                }(Feature);\n                module.exports = AudioContext;\n            },\n            {\n                './feature.js': 11,\n                './html-lines.js': 13,\n                'crnx-base/lines': 1\n            }\n        ],\n        6: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var Feature = require('./feature.js');\n                var Canvas = function (_Feature) {\n                    babelHelpers.inherits(Canvas, _Feature);\n                    function Canvas() {\n                        babelHelpers.classCallCheck(this, Canvas);\n                        return babelHelpers.possibleConstructorReturn(this, _Feature.apply(this, arguments));\n                    }\n                    Canvas.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        var _Feature$prototype$ge;\n                        var lines = (_Feature$prototype$ge = _Feature.prototype.getHtmlLines).call.apply(_Feature$prototype$ge, [this].concat(Array.prototype.slice.call(arguments)));\n                        if (featureContext.canvas) {\n                            lines.a('<div>', '\\t<canvas id=\\'my.canvas\\' width=\\'300\\' height=\\'100\\'></canvas>', '</div>');\n                        }\n                        return lines;\n                    };\n                    Canvas.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var _Feature$prototype$ge2;\n                        var lines = (_Feature$prototype$ge2 = _Feature.prototype.getJsInitLines).call.apply(_Feature$prototype$ge2, [this].concat(Array.prototype.slice.call(arguments)));\n                        if (featureContext.canvas) {\n                            lines.a('var canvas=document.getElementById(\\'my.canvas\\');', 'var canvasContext=canvas.getContext(\\'2d\\');');\n                        }\n                        return lines;\n                    };\n                    return Canvas;\n                }(Feature);\n                module.exports = Canvas;\n            },\n            {\n                './feature.js': 11,\n                './html-lines.js': 13\n            }\n        ],\n        7: [\n            function (require, module, exports) {\n                'use strict';\n                var CodeOutput = function CodeOutput(generateCodeFn) {\n                    babelHelpers.classCallCheck(this, CodeOutput);\n                    var $code = undefined;\n                    var getHtmlDataUri = function (html) {\n                        return 'data:text/html;charset=utf-8,' + encodeURIComponent(html);\n                    };\n                    var writeControls = function () {\n                        return $('<div>').append($('<a download=\\'source.html\\'><button type=\\'button\\'>Save source code</button></a>').click(function () {\n                            // yes I want a button, but download attr is only available for links\n                            $(this).attr('href', getHtmlDataUri($code.text()));\n                        })).append(' ').append($('<button type=\\'button\\'>Run in new window</button>').click(function () {\n                            window.open(getHtmlDataUri($code.text()), 'generatedCode');\n                        })).append(' these buttons don\\'t work in Internet Explorer, copy-paste the code manually');\n                    };\n                    var $output = $('<div class=\\'code-output\\'>').append(writeControls()).append($('<pre>').append($code = $('<code>').html(generateCodeFn())));\n                    if (window.hljs) {\n                        hljs.highlightBlock($code[0]);\n                    } else {\n                    }\n                    $output.append(writeControls());\n                    var delay = 200;\n                    var timeoutId = null;\n                    var update = function () {\n                        clearTimeout(timeoutId);\n                        timeoutId = setTimeout(function () {\n                            $code.html(generateCodeFn());\n                            if (window.hljs)\n                                hljs.highlightBlock($code[0]);\n                        }, delay);\n                    };\n                    // public props:\n                    this.$output = $output;\n                    this.update = update;\n                };\n                module.exports = CodeOutput;\n            },\n            {}\n        ],\n        8: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var AudioContext = require('./audio-context.js');\n                var SourceSet = require('./source-set.js');\n                var FilterSequence = require('./filter-sequence.js');\n                var Destination = require('./destination.js');\n                var Canvas = require('./canvas.js');\n                module.exports = function (options, i18n) {\n                    var featureContext = {};\n                    var features = [\n                        new AudioContext(),\n                        new SourceSet(options.sources),\n                        new FilterSequence(options.filters),\n                        new Destination(options.destination),\n                        new Canvas()\n                    ];\n                    features.forEach(function (feature) {\n                        feature.requestFeatureContext(featureContext);\n                    });\n                    var lines = new Lines('<!DOCTYPE html>', '<html lang=\\'en\\'>', '<head>', '<meta charset=\\'utf-8\\' />', '<title>WebAudio example - Generated code</title>', function () {\n                        var lines = new Lines();\n                        if (featureContext.alignedInputs) {\n                            lines.a('.aligned label {', '\\tdisplay: inline-block;', '\\twidth: 10em;', '\\ttext-align: right;', '}');\n                        }\n                        if (featureContext.canvas) {\n                            lines.a('canvas {', '\\tborder: 1px solid;', '}');\n                        }\n                        return lines.wrapIfNotEmpty('<style>', '</style>');\n                    }(), '</head>', '<body>', function () {\n                        var lines = new Lines();\n                        lines.a.apply(lines, features.map(function (feature) {\n                            return feature.getHtmlLines(featureContext, i18n);\n                        }));\n                        return lines;\n                    }(), function () {\n                        var prevNodeJsNames = undefined;\n                        var jsTopLineSets = features.map(function (feature) {\n                            var lines = feature.getJsInitLines(featureContext, i18n, prevNodeJsNames);\n                            prevNodeJsNames = feature.getNodeJsNames(featureContext, prevNodeJsNames);\n                            return lines;\n                        });\n                        jsTopLineSets.push(function () {\n                            //const lines=new Lines;\n                            //lines.interleave(...features.map(feature=>feature.getJsLoopLines(featureContext,i18n)));\n                            var lines = new (Function.prototype.bind.apply(Lines, [null].concat(features.map(function (feature) {\n                                return feature.getJsLoopLines(featureContext, i18n);\n                            }))))();\n                            //\n                            if (lines.isEmpty()) {\n                                return lines;\n                            } else {\n                                return new Lines('function visualize() {', lines.indent(), //\"\t\",\n                                '\\trequestAnimationFrame(visualize);', '}', 'requestAnimationFrame(visualize);');\n                            }\n                        }());\n                        var lines = new Lines();\n                        lines.interleave.apply(lines, jsTopLineSets);\n                        return lines.wrapIfNotEmpty('<script>', '</script>');\n                    }(), '</body>', '</html>');\n                    return lines.join('\\t');\n                };\n            },\n            {\n                './audio-context.js': 5,\n                './canvas.js': 6,\n                './destination.js': 10,\n                './filter-sequence.js': 12,\n                './html-lines.js': 13,\n                './source-set.js': 19\n            }\n        ],\n        9: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var Feature = require('./feature.js');\n                var CollectionFeature = function (_Feature) {\n                    babelHelpers.inherits(CollectionFeature, _Feature);\n                    function CollectionFeature(entryOptions) {\n                        babelHelpers.classCallCheck(this, CollectionFeature);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        var entryCounts = new Map();\n                        entryOptions.entries.forEach(function (entryOption) {\n                            var entryClass = _this.getEntryClass(entryOption);\n                            entryCounts.set(entryClass, entryCounts.get(entryClass) + 1 || 1);\n                        });\n                        var entryCounts2 = new Map();\n                        _this.entries = entryOptions.entries.map(function (entryOption) {\n                            var entryClass = _this.getEntryClass(entryOption);\n                            if (entryCounts.get(entryClass) > 1) {\n                                var n = entryCounts2.get(entryClass) || 0;\n                                entryCounts2.set(entryClass, n + 1);\n                                return new entryClass(entryOption, n);\n                            } else {\n                                return new entryClass(entryOption);\n                            }\n                        });\n                        return _this;\n                    }\n                    CollectionFeature.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        return new (Function.prototype.bind.apply(Lines, [null].concat(this.entries.map(function (entry) {\n                            return entry.getHtmlLines(featureContext, i18n);\n                        }))))();\n                    };\n                    // abstract:\n                    // getEntryClass(entryOption) {}\n                    return CollectionFeature;\n                }(Feature);\n                module.exports = CollectionFeature;\n            },\n            {\n                './feature.js': 11,\n                './html-lines.js': 13\n            }\n        ],\n        10: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var UnescapedLines = require('crnx-base/lines');\n                var Feature = require('./feature.js');\n                var Destination = function (_Feature) {\n                    babelHelpers.inherits(Destination, _Feature);\n                    function Destination(options) {\n                        babelHelpers.classCallCheck(this, Destination);\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Feature.call(this));\n                        _this.options = options;\n                        return _this;\n                    }\n                    Destination.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        if (!featureContext.audioProcessing)\n                            return;\n                        if (this.options.compressor || this.options.waveform) {\n                            featureContext.audioContext = true;\n                        }\n                        if (this.options.waveform) {\n                            featureContext.canvas = true;\n                        }\n                    };\n                    Destination.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        if (!featureContext.audioProcessing)\n                            return new Lines();\n                        var lines = new Lines();\n                        if (this.options.compressor) {\n                            lines.a('<input id=\\'my.compressor\\' type=\\'checkbox\\' checked />', '<label for=\\'my.compressor\\'>' + i18n('options.destination.compressor.enable') + '</label>');\n                        }\n                        return lines.wrapIfNotEmpty('<div>', '</div>');\n                    };\n                    Destination.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var _Feature$prototype$ge, _this2 = this;\n                        if (!featureContext.audioProcessing)\n                            return new Lines();\n                        var lines = (_Feature$prototype$ge = _Feature.prototype.getJsInitLines).call.apply(_Feature$prototype$ge, [this].concat(Array.prototype.slice.call(arguments)));\n                        if (featureContext.audioContext) {\n                            if (this.options.compressor) {\n                                (function () {\n                                    var nextNodeJsName = _this2.options.waveform ? 'analyserNode' : 'ctx.destination';\n                                    lines.a.apply(lines, [\n                                        new UnescapedLines('// ' + i18n('comment.destination.compressor')),\n                                        'var compressorNode=ctx.createDynamicsCompressor();'\n                                    ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                        return prevNodeJsName + '.connect(compressorNode);';\n                                    })));\n                                    if (prevNodeJsNames.length > 0) {\n                                        lines.a.apply(lines, [\n                                            'document.getElementById(\\'my.compressor\\').onchange=function(){',\n                                            '\\tif (this.checked) {'\n                                        ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.disconnect(' + nextNodeJsName + ');';\n                                        }), prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.connect(compressorNode);';\n                                        }), ['\\t} else {'], prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.disconnect(compressorNode);';\n                                        }), prevNodeJsNames.map(function (prevNodeJsName) {\n                                            return '\\t\\t' + prevNodeJsName + '.connect(' + nextNodeJsName + ');';\n                                        }), [\n                                            '\\t}',\n                                            '};',\n                                            ''\n                                        ]));\n                                    }\n                                    prevNodeJsNames = ['compressorNode'];\n                                }());\n                            }\n                            if (this.options.waveform) {\n                                // TODO need to connect to analyser instead of ctx.destination in event listener above\n                                lines.a.apply(lines, [\n                                    new UnescapedLines('// ' + i18n('comment.destination.waveform')),\n                                    'var analyserNode=ctx.createAnalyser();'\n                                ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                    return prevNodeJsName + '.connect(analyserNode);';\n                                }), [\n                                    'analyserNode.fftSize=1024;',\n                                    'var analyserData=new Uint8Array(analyserNode.frequencyBinCount);',\n                                    ''\n                                ]));\n                                prevNodeJsNames = ['analyserNode'];\n                            }\n                            lines.a.apply(lines, [new UnescapedLines('// ' + i18n('comment.destination'))].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                return prevNodeJsName + '.connect(ctx.destination);';\n                            })));\n                        }\n                        return lines;\n                    };\n                    Destination.prototype.getJsLoopLines = function getJsLoopLines(featureContext, i18n) {\n                        var _Feature$prototype$ge2;\n                        if (!featureContext.audioProcessing)\n                            return new Lines();\n                        var lines = (_Feature$prototype$ge2 = _Feature.prototype.getJsLoopLines).call.apply(_Feature$prototype$ge2, [this].concat(Array.prototype.slice.call(arguments)));\n                        if (this.options.waveform) {\n                            lines.a('analyserNode.getByteTimeDomainData(analyserData);', 'canvasContext.clearRect(0,0,canvas.width,canvas.height);', 'canvasContext.beginPath();', 'for (var i=0;i<analyserData.length;i++) {', '\\tvar x=i*canvas.width/analyserData.length;', '\\tvar y=analyserData[i]*canvas.height/255;', '\\tif (i==0) {', '\\t\\tcanvasContext.moveTo(x,y);', '\\t} else {', '\\t\\tcanvasContext.lineTo(x,y);', '\\t}', '}', 'canvasContext.stroke();');\n                        }\n                        return lines;\n                    };\n                    Destination.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        if (!featureContext.audioProcessing)\n                            return prevNodeJsNames;\n                        if (featureContext.audioContext) {\n                            return ['ctx.destination'];\n                        } else {\n                            return prevNodeJsNames;\n                        }\n                    };\n                    return Destination;\n                }(Feature);\n                module.exports = Destination;\n            },\n            {\n                './feature.js': 11,\n                './html-lines.js': 13,\n                'crnx-base/lines': 1\n            }\n        ],\n        11: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var Feature = function () {\n                    function Feature() {\n                        babelHelpers.classCallCheck(this, Feature);\n                    }\n                    Feature.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                    };\n                    Feature.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        return new Lines();\n                    };\n                    Feature.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        return new Lines();\n                    };\n                    Feature.prototype.getJsLoopLines = function getJsLoopLines(featureContext, i18n) {\n                        return new Lines();\n                    };\n                    Feature.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        return prevNodeJsNames;\n                    };\n                    return Feature;\n                }();\n                module.exports = Feature;\n            },\n            { './html-lines.js': 13 }\n        ],\n        12: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var UnescapedLines = require('crnx-base/lines');\n                var CollectionFeature = require('./collection-feature.js');\n                function capitalize(s) {\n                    return s.charAt(0).toUpperCase() + s.slice(1);\n                }\n                function toCamelCase(s) {\n                    return s.split('.').map(function (w, i) {\n                        return i > 0 ? capitalize(w) : w;\n                    }).join('');\n                }\n                var Filter = function () {\n                    function Filter(options, n) {\n                        babelHelpers.classCallCheck(this, Filter);\n                        this.options = options;\n                        this.n = n;\n                    }\n                    Filter.prototype.getPropertyOptionName = function getPropertyOptionName(property) {\n                        return 'options.filters.' + this.type + '.' + property.name;\n                    };\n                    Filter.prototype.getPropertyInputHtmlName = function getPropertyInputHtmlName(propertyName) {\n                        return 'my.' + this.type + this.nSuffix + '.' + propertyName;\n                    };\n                    Filter.prototype.getPropertyInputJsName = function getPropertyInputJsName(propertyName) {\n                        return toCamelCase(this.type + this.nSuffix + '.' + propertyName + '.input');\n                    };\n                    Filter.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                    };\n                    Filter.prototype.getHtmlPropertyLines = function getHtmlPropertyLines(i18n, property) {\n                        var lines = new Lines();\n                        var option = this.options[property.name];\n                        var inputHtmlName = this.getPropertyInputHtmlName(property.name);\n                        if (property.type == 'range' && option.input) {\n                            lines.a('<label for=\\'' + inputHtmlName + '\\'>' + i18n(this.getPropertyOptionName(property)) + '</label>', '<input id=\\'' + inputHtmlName + '\\' type=\\'range\\' value=\\'' + option + '\\' min=\\'' + option.min + '\\' max=\\'' + option.max + '\\'' + (option.step != 1 ? ' step=\\'' + option.step + '\\'' : '') + ' />');\n                        } else if (property.type == 'select' && option.input) {\n                            lines.a('<label for=\\'' + inputHtmlName + '\\'>' + i18n(this.getPropertyOptionName(property)) + '</label>', new (Function.prototype.bind.apply(Lines, [null].concat(option.availableValues.map(function (value) {\n                                return '<option' + (option.value == value ? ' selected' : '') + '>' + value + '</option>';\n                            }))))().wrap('<select id=\\'' + inputHtmlName + '\\'>', '</select>'));\n                        } else if (property.type == 'xhr') {\n                            lines.a('<span id=\\'' + inputHtmlName + '\\'>' + i18n(this.getPropertyOptionName(property) + '.loading') + '</span>');\n                        }\n                        return lines;\n                    };\n                    // { not called if skipNode is set\n                    Filter.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        var _this = this;\n                        var lines = new (Function.prototype.bind.apply(Lines, [null].concat(this.nodeProperties.map(function (property) {\n                            return _this.getHtmlPropertyLines(i18n, property);\n                        }))))();\n                        return lines.wrapIfNotEmpty('<div>', '</div>');\n                    };\n                    Filter.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                        var _this2 = this;\n                        return new (Function.prototype.bind.apply(Lines, [null].concat([\n                            new UnescapedLines('// ' + i18n('comment.filters.' + this.type)),\n                            'var ' + this.nodeJsName + '=ctx.' + this.ctxCreateMethodName + '();'\n                        ], prevNodeJsNames.map(function (prevNodeJsName) {\n                            return prevNodeJsName + '.connect(' + _this2.nodeJsName + ');';\n                        }))))();\n                    };\n                    babelHelpers.createClass(Filter, [\n                        {\n                            key: 'nSuffix',\n                            get: function () {\n                                if (this.n !== undefined) {\n                                    return '.' + this.n;\n                                } else {\n                                    return '';\n                                }\n                            }\n                        },\n                        {\n                            key: 'nodeJsName',\n                            get: function () {\n                                return toCamelCase(this.type + this.nSuffix + '.node');\n                            }\n                        },\n                        {\n                            key: 'skipNode',\n                            get: function () {\n                                return false;\n                            }\n                        },\n                        {\n                            key: 'nodeJsNames',\n                            get: function () {\n                                return [this.nodeJsName];\n                            }    // }\n                                 // abstract:\n                                 // get type()\n                                 // get ctxCreateMethodName()\n                                 // get nodeProperties()\n                        }\n                    ]);\n                    return Filter;\n                }();\n                var SinglePathFilter = function (_Filter) {\n                    babelHelpers.inherits(SinglePathFilter, _Filter);\n                    function SinglePathFilter() {\n                        babelHelpers.classCallCheck(this, SinglePathFilter);\n                        return babelHelpers.possibleConstructorReturn(this, _Filter.apply(this, arguments));\n                    }\n                    SinglePathFilter.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                        var _this4 = this;\n                        var lines = _Filter.prototype.getJsInitLines.call(this, i18n, prevNodeJsNames);\n                        this.nodeProperties.forEach(function (property) {\n                            var option = _this4.options[property.name];\n                            var nodePropertyJsName = _this4.nodeJsName + '.' + property.name + (property.type == 'range' ? '.value' : '');\n                            if (option.input) {\n                                var inputJsName = _this4.getPropertyInputJsName(property.name);\n                                var inputHtmlName = _this4.getPropertyInputHtmlName(property.name);\n                                var value = inputJsName + '.value';\n                                if (property.fn) {\n                                    value = property.fn(value);\n                                }\n                                var eventProp = property.type == 'range' ? 'oninput' : 'onchange';\n                                lines.a('var ' + inputJsName + '=document.getElementById(\\'' + inputHtmlName + '\\');', // was for IE11 compat (but IE11 has no Web Audio): (property.type=='range'?inputJsName+\".oninput=\":\"\")+inputJsName+\".onchange=function(){\",\n                                '(' + inputJsName + '.' + eventProp + '=function(){', '\\t' + nodePropertyJsName + '=' + value + ';', '})();');\n                            } else {\n                                var value = option.value;\n                                if (property.type == 'select') {\n                                    value = '\\'' + value + '\\'';\n                                }\n                                if (property.fn) {\n                                    value = property.fn(value);\n                                }\n                                if (option.value != option.defaultValue) {\n                                    lines.a(nodePropertyJsName + '=' + value + ';');\n                                }\n                            }\n                        });\n                        return lines;\n                    };\n                    return SinglePathFilter;\n                }(Filter);\n                var PassiveByDefaultSinglePathFilter = function (_SinglePathFilter) {\n                    babelHelpers.inherits(PassiveByDefaultSinglePathFilter, _SinglePathFilter);\n                    function PassiveByDefaultSinglePathFilter() {\n                        babelHelpers.classCallCheck(this, PassiveByDefaultSinglePathFilter);\n                        return babelHelpers.possibleConstructorReturn(this, _SinglePathFilter.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(PassiveByDefaultSinglePathFilter, [{\n                            key: 'skipNode',\n                            get: function () {\n                                var _this6 = this;\n                                return this.nodeProperties.every(function (property) {\n                                    var option = _this6.options[property.name];\n                                    return option.value == option.defaultValue && !option.input;\n                                });\n                            }\n                        }]);\n                    return PassiveByDefaultSinglePathFilter;\n                }(SinglePathFilter);\n                var filterClasses = {\n                    gain: function (_PassiveByDefaultSing) {\n                        babelHelpers.inherits(gain, _PassiveByDefaultSing);\n                        function gain() {\n                            babelHelpers.classCallCheck(this, gain);\n                            return babelHelpers.possibleConstructorReturn(this, _PassiveByDefaultSing.apply(this, arguments));\n                        }\n                        babelHelpers.createClass(gain, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'gain';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createGain';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [{\n                                            name: 'gain',\n                                            type: 'range'\n                                        }];\n                                }\n                            }\n                        ]);\n                        return gain;\n                    }(PassiveByDefaultSinglePathFilter),\n                    panner: function (_PassiveByDefaultSing2) {\n                        babelHelpers.inherits(panner, _PassiveByDefaultSing2);\n                        function panner() {\n                            babelHelpers.classCallCheck(this, panner);\n                            return babelHelpers.possibleConstructorReturn(this, _PassiveByDefaultSing2.apply(this, arguments));\n                        }\n                        babelHelpers.createClass(panner, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'panner';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createStereoPanner';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [{\n                                            name: 'pan',\n                                            type: 'range'\n                                        }];\n                                }\n                            }\n                        ]);\n                        return panner;\n                    }(PassiveByDefaultSinglePathFilter),\n                    biquad: function (_SinglePathFilter2) {\n                        babelHelpers.inherits(biquad, _SinglePathFilter2);\n                        function biquad() {\n                            babelHelpers.classCallCheck(this, biquad);\n                            return babelHelpers.possibleConstructorReturn(this, _SinglePathFilter2.apply(this, arguments));\n                        }\n                        babelHelpers.createClass(biquad, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'biquad';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createBiquadFilter';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [\n                                        {\n                                            name: 'type',\n                                            type: 'select'\n                                        },\n                                        {\n                                            name: 'frequency',\n                                            type: 'range'\n                                        },\n                                        {\n                                            name: 'Q',\n                                            type: 'range',\n                                            fn: function (x) {\n                                                return 'Math.pow(10,' + x + ')';\n                                            }\n                                        },\n                                        {\n                                            name: 'gain',\n                                            type: 'range'\n                                        },\n                                        {\n                                            name: 'detune',\n                                            type: 'range'\n                                        }\n                                    ];\n                                }\n                            },\n                            {\n                                key: 'skipNode',\n                                get: function () {\n                                    // lowshelf, highshelf and peaking are passive when gain==0\n                                    return !this.options.type.input && [\n                                        'lowshelf',\n                                        'highshelf',\n                                        'peaking'\n                                    ].indexOf(this.options.type.value) >= 0 && !this.options.gain.input && this.options.gain == 0;\n                                }\n                            }\n                        ]);\n                        return biquad;\n                    }(SinglePathFilter),\n                    convolver: function (_Filter2) {\n                        babelHelpers.inherits(convolver, _Filter2);\n                        function convolver() {\n                            babelHelpers.classCallCheck(this, convolver);\n                            return babelHelpers.possibleConstructorReturn(this, _Filter2.apply(this, arguments));\n                        }\n                        convolver.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                            var _this11 = this;\n                            var messageHtmlName = this.getPropertyInputHtmlName('buffer');\n                            var lines = new Lines();\n                            if (this.options.reverb.input || this.options.reverb != 1) {\n                                lines.a(new UnescapedLines('// ' + i18n('comment.filters.' + this.type)));\n                            } else {\n                                lines.a(new UnescapedLines('// ' + i18n('comment.filters.' + this.type + '.single')));\n                            }\n                            lines.a.apply(lines, ['var ' + this.nodeJsName + '=ctx.' + this.ctxCreateMethodName + '();'].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                return prevNodeJsName + '.connect(' + _this11.nodeJsName + ');';\n                            })));\n                            if (this.options.reverb.input || this.options.reverb != 1) {\n                                lines.a.apply(lines, [\n                                    'var ' + this.wetGainNodeJsName + '=ctx.createGain();',\n                                    this.nodeJsName + '.connect(' + this.wetGainNodeJsName + ');',\n                                    'var ' + this.dryGainNodeJsName + '=ctx.createGain();'\n                                ].concat(prevNodeJsNames.map(function (prevNodeJsName) {\n                                    return prevNodeJsName + '.connect(' + _this11.dryGainNodeJsName + ');';\n                                })));\n                                if (this.options.reverb.input) {\n                                    var inputHtmlName = this.getPropertyInputHtmlName('reverb');\n                                    var inputJsName = this.getPropertyInputJsName('reverb');\n                                    lines.a('var ' + inputJsName + '=document.getElementById(\\'' + inputHtmlName + '\\');', '(' + inputJsName + '.oninput=function(){', '\\t' + this.wetGainNodeJsName + '.gain.value=' + inputJsName + '.value;', '\\t' + this.dryGainNodeJsName + '.gain.value=1-' + inputJsName + '.value;', '})();');\n                                }\n                            }\n                            lines.a('var xhr=new XMLHttpRequest();', 'xhr.open(\\'GET\\',\\'' + this.options.url + '\\');', // TODO html escape\n                            'xhr.responseType=\\'arraybuffer\\';', 'xhr.onload=function(){', '\\tif (this.status==200) {', // TODO we are checking status here, but what if <audio>'s status is an error?\n                            '\\t\\tctx.decodeAudioData(this.response,function(buffer){', '\\t\\t\\t' + this.nodeJsName + '.buffer=buffer;', '\\t\\t\\tdocument.getElementById(\\'' + messageHtmlName + '\\').textContent=\\'\\';', '\\t\\t});', '\\t} else {', '\\t\\tthis.onerror();', '\\t}', '};', 'xhr.onerror=function(){', '\\tdocument.getElementById(\\'' + messageHtmlName + '\\').textContent=\\'' + i18n('options.filters.convolver.buffer.error') + '\\';', '};', 'xhr.send();');\n                            return lines;\n                        };\n                        babelHelpers.createClass(convolver, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'convolver';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createConvolver';\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return [\n                                        {\n                                            name: 'reverb',\n                                            type: 'range'\n                                        },\n                                        {\n                                            name: 'buffer',\n                                            type: 'xhr'\n                                        }\n                                    ];\n                                }\n                            },\n                            {\n                                key: 'dryGainNodeJsName',\n                                get: function () {\n                                    return toCamelCase(this.type + this.nSuffix + '.dry.gain.node');\n                                }\n                            },\n                            {\n                                key: 'wetGainNodeJsName',\n                                get: function () {\n                                    return toCamelCase(this.type + this.nSuffix + '.wet.gain.node');\n                                }\n                            },\n                            {\n                                key: 'skipNode',\n                                get: function () {\n                                    return this.options.reverb == 0 && !this.options.reverb.input;\n                                }\n                            },\n                            {\n                                key: 'nodeJsNames',\n                                get: function () {\n                                    if (this.options.reverb.input || this.options.reverb != 1) {\n                                        return [\n                                            this.wetGainNodeJsName,\n                                            this.dryGainNodeJsName\n                                        ];\n                                    } else {\n                                        return [this.nodeJsName];\n                                    }\n                                }\n                            }\n                        ]);\n                        return convolver;\n                    }(Filter),\n                    equalizer: function (_Filter3) {\n                        babelHelpers.inherits(equalizer, _Filter3);\n                        function equalizer() {\n                            babelHelpers.classCallCheck(this, equalizer);\n                            return babelHelpers.possibleConstructorReturn(this, _Filter3.apply(this, arguments));\n                        }\n                        equalizer.prototype.getFrequencyOption = function getFrequencyOption(i) {\n                            return this.options[this.nodeProperties[i].name];\n                        };\n                        equalizer.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                            if (!this.allGainsConstant) {\n                                featureContext.alignedInputs = true;\n                            }\n                        };\n                        equalizer.prototype.getHtmlPropertyLines = function getHtmlPropertyLines(i18n, property) {\n                            var lines = _Filter3.prototype.getHtmlPropertyLines.call(this, i18n, property);\n                            return lines.wrapIfNotEmpty('<div class=\\'aligned\\'>', '</div>');\n                        };\n                        equalizer.prototype.getJsInitLines = function getJsInitLines(i18n, prevNodeJsNames) {\n                            var _this13 = this;\n                            var singleFreq = this.affectedFreqsAndOptions.length == 1;\n                            var allGainsConstant = this.affectedFreqsAndOptions.every(function (fo) {\n                                return fo.option.input == false;\n                            });\n                            var noGainsConstant = this.affectedFreqsAndOptions.every(function (fo) {\n                                return fo.option.input == true;\n                            });\n                            var getJsData = function () {\n                                return _this13.affectedFreqsAndOptions.map(function (fo) {\n                                    if (noGainsConstant) {\n                                        return fo.freq;\n                                    } else {\n                                        return '[' + fo.freq + ',' + (fo.option.input ? 'null' : fo.option.value) + ']';\n                                    }\n                                }).join();\n                            };\n                            var getJsDataItem = function () {\n                                if (noGainsConstant) {\n                                    return 'freq';\n                                } else {\n                                    return 'freqData';\n                                }\n                            };\n                            var getJsLoopLines = function () {\n                                var nodeJsName = allGainsConstant || singleFreq ? _this13.nodeJsName : 'node';\n                                var freq = singleFreq ? _this13.affectedFreqsAndOptions[0].freq : 'freq';\n                                var gain = singleFreq ? _this13.affectedFreqsAndOptions[0].option.value : 'gain';\n                                var lines = new Lines();\n                                if (!(noGainsConstant || singleFreq)) {\n                                    lines.a('var freq=freqData[0], gain=freqData[1];');\n                                }\n                                if (allGainsConstant && !singleFreq) {\n                                    lines.a('');\n                                } else {\n                                    lines.a('var ');\n                                }\n                                lines.t(nodeJsName + '=ctx.' + _this13.ctxCreateMethodName + '();');\n                                if (singleFreq) {\n                                    lines.a.apply(lines, prevNodeJsNames.map(function (prevNodeJsName) {\n                                        return prevNodeJsName + '.connect(' + nodeJsName + ');';\n                                    }));\n                                } else {\n                                    if (prevNodeJsNames.length == 1) {\n                                        lines.a('prevNode.connect(' + nodeJsName + ');');\n                                    } else {\n                                        lines.a('prevNodes.forEach(function(prevNode){', '\\tprevNode.connect(' + nodeJsName + ');', '});');\n                                    }\n                                }\n                                lines.a(nodeJsName + '.type=\\'peaking\\';', nodeJsName + '.frequency.value=' + freq + ';');\n                                if (!noGainsConstant) {\n                                    var gainLines = new Lines(nodeJsName + '.gain.value=' + gain + ';');\n                                    if (!allGainsConstant) {\n                                        gainLines.wrap('if (gain!==null) {', '}');\n                                    }\n                                    lines.a(gainLines);\n                                }\n                                if (!allGainsConstant) {\n                                    var inputJsName = singleFreq ? _this13.getPropertyInputJsName('gain' + freq) : 'input';\n                                    var inputHtmlNameExpr = singleFreq ? '\\'' + _this13.getPropertyInputHtmlName('gain' + freq) + '\\'' : '\\'' + _this13.getPropertyInputHtmlName('gain') + '\\'+freq';\n                                    var listenerLines = new Lines('var ' + inputJsName + '=document.getElementById(' + inputHtmlNameExpr + ');', '(' + inputJsName + '.oninput=function(){', '\\t' + nodeJsName + '.gain.value=' + inputJsName + '.value;', '})();');\n                                    if (!noGainsConstant) {\n                                        lines.t(// continues \"if (gain!==null) {...}\"\n                                        listenerLines.wrap(' else {', '}'));\n                                    } else {\n                                        lines.a(listenerLines);\n                                    }\n                                }\n                                if (!singleFreq) {\n                                    var outerNodeJsName = allGainsConstant ? nodeJsName : _this13.nodeJsName + '=' + nodeJsName;\n                                    if (prevNodeJsNames.length == 1) {\n                                        lines.a('prevNode=' + outerNodeJsName + ';');\n                                    } else {\n                                        lines.a('prevNodes=[' + outerNodeJsName + '];');\n                                    }\n                                }\n                                return lines;\n                            };\n                            if (singleFreq) {\n                                return new Lines(new UnescapedLines('// ' + i18n('comment.filters.' + this.type + '.single')), getJsLoopLines());\n                            } else {\n                                var lines = new Lines(new UnescapedLines('// ' + i18n('comment.filters.' + this.type)));\n                                if (prevNodeJsNames.length == 1) {\n                                    lines.a('var prevNode=' + prevNodeJsNames[0] + ';');\n                                } else {\n                                    lines.a('var prevNodes=[' + prevNodeJsNames.join() + '];');\n                                }\n                                lines.a('var ' + this.nodeJsName + ';', '[' + getJsData() + '].forEach(function(' + getJsDataItem() + '){', getJsLoopLines().indent(), '});');\n                                return lines;\n                            }\n                        };\n                        babelHelpers.createClass(equalizer, [\n                            {\n                                key: 'type',\n                                get: function () {\n                                    return 'equalizer';\n                                }\n                            },\n                            {\n                                key: 'ctxCreateMethodName',\n                                get: function () {\n                                    return 'createBiquadFilter';\n                                }\n                            },\n                            {\n                                key: 'frequencies',\n                                get: function () {\n                                    return [\n                                        60,\n                                        170,\n                                        350,\n                                        1000,\n                                        3500,\n                                        10000\n                                    ];\n                                }\n                            },\n                            {\n                                key: 'nodeProperties',\n                                get: function () {\n                                    return this.frequencies.map(function (freq) {\n                                        return {\n                                            name: 'gain' + freq,\n                                            type: 'range'\n                                        };\n                                    });\n                                }\n                            },\n                            {\n                                key: 'affectedFreqsAndOptions',\n                                get: function () {\n                                    var _this14 = this;\n                                    return this.frequencies.map(function (freq, i) {\n                                        var option = _this14.getFrequencyOption(i);\n                                        return {\n                                            freq: freq,\n                                            option: option\n                                        };\n                                    }).filter(function (fo) {\n                                        return fo.option.input != false || fo.option.value != 0;\n                                    });\n                                }\n                            },\n                            {\n                                key: 'skipNode',\n                                get: function () {\n                                    return this.affectedFreqsAndOptions.length == 0;\n                                }\n                            }\n                        ]);\n                        return equalizer;\n                    }(Filter)\n                };\n                var FilterSequence = function (_CollectionFeature) {\n                    babelHelpers.inherits(FilterSequence, _CollectionFeature);\n                    function FilterSequence() {\n                        babelHelpers.classCallCheck(this, FilterSequence);\n                        return babelHelpers.possibleConstructorReturn(this, _CollectionFeature.apply(this, arguments));\n                    }\n                    FilterSequence.prototype.getEntryClass = function getEntryClass(entryOption) {\n                        return filterClasses[entryOption.filter];\n                    };\n                    FilterSequence.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        if (!featureContext.audioProcessing)\n                            return;\n                        this.entries.forEach(function (entry) {\n                            if (!entry.skipNode) {\n                                featureContext.audioContext = true;\n                                entry.requestFeatureContext(featureContext);\n                            }\n                        });\n                    };\n                    FilterSequence.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        if (!featureContext.audioProcessing)\n                            return new Lines();\n                        return new (Function.prototype.bind.apply(Lines, [null].concat(this.entries.filter(function (entry) {\n                            return !entry.skipNode;\n                        }).map(function (entry) {\n                            return entry.getHtmlLines(featureContext, i18n);\n                        }))))();\n                    };\n                    FilterSequence.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var _CollectionFeature$pr;\n                        if (!featureContext.audioProcessing)\n                            return new Lines();\n                        var lines = (_CollectionFeature$pr = _CollectionFeature.prototype.getJsInitLines).call.apply(_CollectionFeature$pr, [this].concat(Array.prototype.slice.call(arguments)));\n                        lines.interleave.apply(lines, this.entries.filter(function (entry) {\n                            return !entry.skipNode;\n                        }).map(function (entry) {\n                            var lines = entry.getJsInitLines(i18n, prevNodeJsNames);\n                            prevNodeJsNames = entry.nodeJsNames;\n                            return lines;\n                        }));\n                        return lines;\n                    };\n                    FilterSequence.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        if (!featureContext.audioProcessing)\n                            return prevNodeJsNames;\n                        this.entries.forEach(function (entry) {\n                            if (!entry.skipNode) {\n                                prevNodeJsNames = entry.nodeJsNames;\n                            }\n                        });\n                        return prevNodeJsNames;\n                    };\n                    return FilterSequence;\n                }(CollectionFeature);\n                module.exports = FilterSequence;\n            },\n            {\n                './collection-feature.js': 9,\n                './html-lines.js': 13,\n                'crnx-base/lines': 1\n            }\n        ],\n        13: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('crnx-base/lines');\n                var HtmlLines = function (_Lines) {\n                    babelHelpers.inherits(HtmlLines, _Lines);\n                    function HtmlLines() {\n                        babelHelpers.classCallCheck(this, HtmlLines);\n                        return babelHelpers.possibleConstructorReturn(this, _Lines.apply(this, arguments));\n                    }\n                    HtmlLines.prototype.preprocessString = function preprocessString(str) {\n                        // http://stackoverflow.com/questions/5499078/fastest-method-to-escape-html-tags-as-html-entities\n                        return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n                    };\n                    return HtmlLines;\n                }(Lines);\n                module.exports = HtmlLines;\n            },\n            { 'crnx-base/lines': 1 }\n        ],\n        14: [\n            function (require, module, exports) {\n                'use strict';\n                var strings = {\n                    'options.sources': 'Sources',\n                    'options.sources.audio': 'Audio element',\n                    'options.sources.audio.add': 'Add audio element',\n                    'options.sources.audio.url': 'Source URL',\n                    'options.sources.video': 'Video element',\n                    'options.sources.video.add': 'Add video element',\n                    'options.sources.video.url': 'Source URL',\n                    'options.sources.video.width': 'Player width',\n                    'options.sources.video.height': 'Player height',\n                    'options.filters': 'Filters',\n                    'options.filters.gain': 'Gain',\n                    'options.filters.gain.add': 'Add gain',\n                    'options.filters.gain.gain': 'Gain',\n                    'options.filters.panner': 'Stereo panner',\n                    'options.filters.panner.add': 'Add stereo panner',\n                    'options.filters.panner.pan': 'Pan',\n                    'options.filters.biquad': 'Biquad filter',\n                    'options.filters.biquad.add': 'Add biquad filter',\n                    'options.filters.biquad.type': 'Filter type',\n                    'options.filters.biquad.type.lowpass': 'lowpass',\n                    'options.filters.biquad.type.highpass': 'highpass',\n                    'options.filters.biquad.type.bandpass': 'bandpass',\n                    'options.filters.biquad.type.lowshelf': 'lowshelf',\n                    'options.filters.biquad.type.highshelf': 'highshelf',\n                    'options.filters.biquad.type.peaking': 'peaking',\n                    'options.filters.biquad.type.notch': 'notch',\n                    'options.filters.biquad.type.allpass': 'allpass',\n                    'options.filters.biquad.frequency': 'Frequency',\n                    'options.filters.biquad.Q': 'Log(Q)',\n                    'options.filters.biquad.detune': 'Detune',\n                    'options.filters.biquad.gain': 'Gain [dB]',\n                    'options.filters.convolver': 'Convolver',\n                    'options.filters.convolver.add': 'Add convolver',\n                    'options.filters.convolver.url': 'Impulse responce URL',\n                    'options.filters.convolver.reverb': 'Reverb (dry/wet)',\n                    'options.filters.convolver.buffer.loading': 'Loading and decoding the impulse response',\n                    'options.filters.convolver.buffer.error': 'Error while loading the impulse response',\n                    'options.filters.equalizer': 'Equalizer',\n                    'options.filters.equalizer.add': 'Add equalizer',\n                    'options.filters.equalizer.gain60': '60 Hz gain',\n                    // TODO {,} expansion\n                    'options.filters.equalizer.gain170': '170 Hz gain',\n                    'options.filters.equalizer.gain350': '350 Hz gain',\n                    'options.filters.equalizer.gain1000': '1000 Hz gain',\n                    'options.filters.equalizer.gain3500': '3500 Hz gain',\n                    'options.filters.equalizer.gain10000': '10000 Hz gain',\n                    'options.destination': 'Destination',\n                    'options.destination.compressor': 'Add dynamics compressor before the destination',\n                    'options.destination.compressor.enable': 'Enable dynamics compressor',\n                    'options.destination.waveform': 'Add waveform visualization',\n                    'options-output.drag': 'Drag or press up/down while in focus to reorder',\n                    'options-output.delete': 'Delete',\n                    'options-output.input': 'Editable',\n                    'options-output.range': 'with range',\n                    'options-output.reset': 'Reset',\n                    'comment.context': 'create [https://www.w3.org/TR/webaudio/#AudioContext audio context]',\n                    'comment.sources.audio': 'create [https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode audio source node]',\n                    'comment.sources.video': 'create [https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode video source node]',\n                    'comment.filters.gain': 'create [https://www.w3.org/TR/webaudio/#GainNode gain node]',\n                    'comment.filters.panner': 'create [https://www.w3.org/TR/webaudio/#the-stereopannernode-interface stereo panner node]',\n                    'comment.filters.biquad': 'create [https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface biquad filter node]',\n                    'comment.filters.convolver': 'create dry and wet routes with [https://www.w3.org/TR/webaudio/#ConvolverNode convolver node]',\n                    'comment.filters.convolver.single': 'create [https://www.w3.org/TR/webaudio/#ConvolverNode convolver node]',\n                    'comment.filters.equalizer': 'create equalizer as a sequence of [https://www.w3.org/TR/webaudio/#idl-def-BiquadFilterType.peaking peaking] [https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface biquad filter nodes]',\n                    'comment.filters.equalizer.single': 'create equalizer as a [https://www.w3.org/TR/webaudio/#idl-def-BiquadFilterType.peaking peaking] [https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface biquad filter node]',\n                    'comment.destination': 'connect last node to [https://www.w3.org/TR/webaudio/#AudioDestinationNode destination]',\n                    'comment.destination.compressor': 'create [https://www.w3.org/TR/webaudio/#the-dynamicscompressornode-interface dynamics compressor node]',\n                    'comment.destination.waveform': 'create [https://www.w3.org/TR/webaudio/#the-analysernode-interface analyser node] for waveform visualization'\n                };\n                function i18nLinkFilter(inStrings) {\n                    var linkRegexp = /\\[(\\S+)\\s+([^\\]]+)]/g;\n                    var outStrings = {};\n                    for (var id in inStrings) {\n                        outStrings[id] = inStrings[id].replace(linkRegexp, function (match, url, text) {\n                            return '<a href=\\'' + url + '\\'>' + text + '</a>';\n                        });\n                    }\n                    return outStrings;\n                }\n                strings = i18nLinkFilter(strings);\n                module.exports = function (lang) {\n                    // TODO use lang to pick strings\n                    var i18n = function (id) {\n                        return strings[id];\n                    };\n                    i18n.lang = lang;\n                    return i18n;\n                };\n            },\n            {}\n        ],\n        15: [\n            function (require, module, exports) {\n                'use strict';\n                var idCounter = 0;\n                function generateId() {\n                    return 'webaudio-starter-id-' + idCounter++;\n                }\n                var i18n = require('./i18n.js')('en');\n                var Options = require('./options.js');\n                var generateCode = require('./code.js');\n                var CodeOutput = require('./code-output');\n                var OptionsOutput = require('./options-output');\n                $(function () {\n                    $('.webaudio-starter').each(function () {\n                        var $container = $(this);\n                        var options = new Options();\n                        var codeOutput = new CodeOutput(function () {\n                            return generateCode(options.fix(), i18n);\n                        });\n                        options.updateCallback = codeOutput.update;\n                        var optionsOutput = new OptionsOutput(options, generateId, i18n);\n                        $container.empty().append(optionsOutput.$output).append(codeOutput.$output);\n                    });\n                });\n            },\n            {\n                './code-output': 7,\n                './code.js': 8,\n                './i18n.js': 14,\n                './options-output': 17,\n                './options.js': 18\n            }\n        ],\n        16: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = Object.create(require('crnx-base/option-classes'));\n                // differs from webgl-starter:\n                //\thas defaultValue - although it's potentially confusing: user input default vs Web Audio Node property default - they are currently the same\n                //\tno setToDefault, which is needed only if speed is present\n                //\tname is set, b/c it wasn't needed only for speed\n                var FixedLiveNumber = function () {\n                    function FixedLiveNumber(src) {\n                        babelHelpers.classCallCheck(this, FixedLiveNumber);\n                        this.value = src.value;\n                        this.min = src.min;\n                        this.max = src.max;\n                        this.input = src.input;\n                        this.defaultValue = src.defaultValue;\n                        this.availableMin = src.availableMin;\n                        this.availableMax = src.availableMax;\n                        this.step = src.step;\n                        this.name = src.name;\n                    }\n                    FixedLiveNumber.prototype.valueOf = function valueOf() {\n                        return this.value;\n                    };\n                    FixedLiveNumber.prototype.toString = function toString() {\n                        return String(this.value);\n                    };\n                    return FixedLiveNumber;\n                }();\n                // differs from webgl-starter:\n                //\tinput is a boolean\n                // \tfloat subclasses have a fixed step of 0.01\n                //\tno speed\n                //\thas range specified as [availableMin,availableMax,defaultMin,defaultMax]\n                Option.LiveNumber = function (_Option$RangeInput) {\n                    babelHelpers.inherits(_class, _Option$RangeInput);\n                    function _class(name, availableRange, defaultValue, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class);\n                        var dataValue = undefined, dataMin = undefined, dataMax = undefined, dataInput = undefined;\n                        if (typeof data == 'object') {\n                            dataValue = data.value;\n                            dataMin = data.min;\n                            dataMax = data.max;\n                            dataInput = data.input;\n                        } else {\n                            dataValue = data;\n                        }\n                        var _this = babelHelpers.possibleConstructorReturn(this, _Option$RangeInput.call(this, name, availableRange, defaultValue, dataValue, fullName, isVisible, updateCallback));\n                        _this.defaultMin = availableRange[2] !== undefined ? availableRange[2] : _this.availableMin;\n                        _this.defaultMax = availableRange[3] !== undefined ? availableRange[3] : _this.availableMax;\n                        _this._min = dataMin !== undefined ? dataMin : _this.defaultMin;\n                        _this._max = dataMax !== undefined ? dataMax : _this.defaultMax;\n                        _this._input = !!dataInput;\n                        _this._$range = null;\n                        return _this;\n                    }\n                    _class.prototype.updateInternalVisibility = function updateInternalVisibility() {\n                        if (this._$range)\n                            this._$range.toggle(this._input);\n                    };\n                    _class.prototype.exportHelper = function exportHelper(src) {\n                        var data = {};\n                        if (src.value != src.defaultValue)\n                            data.value = src.value;\n                        if (src.min != src.availableMin)\n                            data.min = src.min;\n                        if (src.max != src.availableMax)\n                            data.max = src.max;\n                        if (src.input)\n                            data.input = src.input;\n                        return data;\n                    };\n                    _class.prototype.export = function _export() {\n                        return this.exportHelper(this);\n                    };\n                    _class.prototype.fix = function fix() {\n                        return new FixedLiveNumber(this);\n                    };\n                    babelHelpers.createClass(_class, [\n                        {\n                            key: 'input',\n                            get: function () {\n                                return this._input;\n                            },\n                            set: function (input) {\n                                this._input = input;\n                                this.updateInternalVisibility();\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'min',\n                            get: function () {\n                                return this._min;\n                            },\n                            set: function (min) {\n                                this._min = min;\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: 'max',\n                            get: function () {\n                                return this._max;\n                            },\n                            set: function (max) {\n                                this._max = max;\n                                this.updateCallback();\n                            }\n                        },\n                        {\n                            key: '$range',\n                            get: function () {\n                                return this._$range;\n                            },\n                            set: function ($range) {\n                                this._$range = $range;\n                                this.updateInternalVisibility();\n                            }\n                        }\n                    ]);\n                    return _class;\n                }(Option.RangeInput);\n                Option.LiveInt = function (_Option$LiveNumber) {\n                    babelHelpers.inherits(_class2, _Option$LiveNumber);\n                    function _class2() {\n                        babelHelpers.classCallCheck(this, _class2);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class2, [{\n                            key: 'step',\n                            get: function () {\n                                return 1;\n                            }\n                        }]);\n                    return _class2;\n                }(Option.LiveNumber);\n                Option.LiveFloat = function (_Option$LiveNumber2) {\n                    babelHelpers.inherits(_class3, _Option$LiveNumber2);\n                    function _class3() {\n                        babelHelpers.classCallCheck(this, _class3);\n                        return babelHelpers.possibleConstructorReturn(this, _Option$LiveNumber2.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(_class3, [{\n                            key: 'step',\n                            get: function () {\n                                return 0.01;\n                            }\n                        }]);\n                    return _class3;\n                }(Option.LiveNumber);\n                var FixedLiveSelect = function () {\n                    function FixedLiveSelect(src) {\n                        babelHelpers.classCallCheck(this, FixedLiveSelect);\n                        this.value = src.value;\n                        this.input = src.input;\n                        this.defaultValue = src.defaultValue;\n                        this.availableValues = src.availableValues;\n                        this.name = src.name;\n                    }\n                    FixedLiveSelect.prototype.valueOf = function valueOf() {\n                        return this.value;\n                    };\n                    FixedLiveSelect.prototype.toString = function toString() {\n                        return this.value;\n                    };\n                    return FixedLiveSelect;\n                }();\n                Option.LiveSelect = function (_Option$Select) {\n                    babelHelpers.inherits(_class4, _Option$Select);\n                    function _class4(name, availableValues, defaultValue, data, fullName, isVisible, updateCallback) {\n                        babelHelpers.classCallCheck(this, _class4);\n                        var dataValue = undefined, dataInput = undefined;\n                        if (typeof data == 'object') {\n                            dataValue = data.value;\n                            dataInput = data.input;\n                        } else {\n                            dataValue = data;\n                        }\n                        var _this4 = babelHelpers.possibleConstructorReturn(this, _Option$Select.call(this, name, availableValues, defaultValue, dataValue, fullName, isVisible, updateCallback));\n                        _this4._input = !!dataInput;\n                        return _this4;\n                    }\n                    _class4.prototype.export = function _export() {\n                        var data = {};\n                        if (this.value != this.defaultValue)\n                            data.value = this.value;\n                        if (this.input)\n                            data.input = this.input;\n                        return data;\n                    };\n                    _class4.prototype.fix = function fix() {\n                        return new FixedLiveSelect(this);\n                    };\n                    babelHelpers.createClass(_class4, [{\n                            key: 'input',\n                            get: function () {\n                                return this._input;\n                            },\n                            set: function (input) {\n                                this._input = input;\n                                this.updateCallback();\n                            }\n                        }]);\n                    return _class4;\n                }(Option.Select);\n                module.exports = Option;\n            },\n            { 'crnx-base/option-classes': 2 }\n        ],\n        17: [\n            function (require, module, exports) {\n                'use strict';\n                var Option = require('./option-classes.js');\n                var BaseOptionsOutput = require('crnx-base/options-output');\n                var OptionsOutput = function (_BaseOptionsOutput) {\n                    babelHelpers.inherits(OptionsOutput, _BaseOptionsOutput);\n                    function OptionsOutput() {\n                        babelHelpers.classCallCheck(this, OptionsOutput);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptionsOutput.apply(this, arguments));\n                    }\n                    OptionsOutput.prototype.setOptionClassWriters = function setOptionClassWriters(optionClassWriters) {\n                        _BaseOptionsOutput.prototype.setOptionClassWriters.call(this, optionClassWriters);\n                        optionClassWriters.set(Option.LiveNumber, function (option, writeOption, i18n, generateId) {\n                            var setInputAttrs = function ($input) {\n                                return $input.attr('min', option.availableMin).attr('max', option.availableMax).attr('step', option.step);\n                            };\n                            var setInputAttrsAndListeners = function ($input, getOtherInput) {\n                                return setInputAttrs($input).val(option.value).on('input change', function () {\n                                    if (this.checkValidity()) {\n                                        var $that = getOtherInput();\n                                        $that.val(this.value);\n                                        option.value = parseFloat(this.value);\n                                    }\n                                });\n                            };\n                            var writeMinMaxInput = function (minOrMax) {\n                                return setInputAttrs($('<input type=\\'number\\' required>')).val(option[minOrMax]).on('input change', function () {\n                                    if (this.checkValidity()) {\n                                        option[minOrMax] = parseFloat(this.value);\n                                    }\n                                });\n                            };\n                            var id = generateId();\n                            var inputCheckboxId = generateId();\n                            var $sliderInput = undefined, $numberInput = undefined, $inputCheckbox = undefined;\n                            var $rangeMinInput = undefined, $rangeMaxInput = undefined;\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>').append(' <span class=\\'min\\'>' + option.availableMin + '</span> ').append($sliderInput = setInputAttrsAndListeners($('<input type=\\'range\\' id=\\'' + id + '\\'>'), function () {\n                                return $numberInput;\n                            })).append(' <span class=\\'max\\'>' + option.availableMax + '</span> ').append($numberInput = setInputAttrsAndListeners($('<input type=\\'number\\' required>'), function () {\n                                return $sliderInput;\n                            })).append(' ').append($inputCheckbox = $('<input type=\\'checkbox\\' id=\\'' + inputCheckboxId + '\\'>').prop('checked', option.input).change(function () {\n                                option.input = $(this).prop('checked');\n                            })).append(' <label for=\\'' + inputCheckboxId + '\\'>' + i18n('options-output.input') + '</label> ').append(option.$range = $('<span class=\\'range\\'>').append(i18n('options-output.range') + ' ').append($rangeMinInput = writeMinMaxInput('min')).append(' .. ').append($rangeMaxInput = writeMinMaxInput('max'))).append(' ').append($('<button type=\\'button\\'>' + i18n('options-output.reset') + '</button>').click(function () {\n                                $sliderInput.val(option.defaultValue).change();\n                                $inputCheckbox.prop('checked', false).change();\n                                $rangeMinInput.val(option.defaultMin).change();\n                                $rangeMaxInput.val(option.defaultMax).change();\n                            }));\n                        });\n                        optionClassWriters.set(Option.LiveSelect, function (option, writeOption, i18n, generateId) {\n                            var id = generateId();\n                            var inputCheckboxId = generateId();\n                            var $select = undefined, $inputCheckbox = undefined;\n                            return option.$ = $('<div class=\\'option\\'>').append('<label for=\\'' + id + '\\'>' + i18n('options.' + option.fullName) + ':</label>').append(' ').append($select = $('<select id=\\'' + id + '\\'>').append(option.availableValues.map(function (availableValue) {\n                                return $('<option>').val(availableValue).html(i18n('options.' + option.fullName + '.' + availableValue));\n                            })).val(option.value).change(function () {\n                                option.value = this.value;\n                            })).append(' ').append($inputCheckbox = $('<input type=\\'checkbox\\' id=\\'' + inputCheckboxId + '\\'>').prop('checked', option.input).change(function () {\n                                option.input = $(this).prop('checked');\n                            })).append(' <label for=\\'' + inputCheckboxId + '\\'>' + i18n('options-output.input') + '</label> ').append($('<button type=\\'button\\'>' + i18n('options-output.reset') + '</button>').click(function () {\n                                $select.val(option.defaultValue).change();\n                                $inputCheckbox.prop('checked', false).change();\n                            }));\n                        });\n                    };\n                    return OptionsOutput;\n                }(BaseOptionsOutput);\n                module.exports = OptionsOutput;\n            },\n            {\n                './option-classes.js': 16,\n                'crnx-base/options-output': 3\n            }\n        ],\n        18: [\n            function (require, module, exports) {\n                'use strict';\n                var BaseOptions = require('crnx-base/options');\n                var Options = function (_BaseOptions) {\n                    babelHelpers.inherits(Options, _BaseOptions);\n                    function Options() {\n                        babelHelpers.classCallCheck(this, Options);\n                        return babelHelpers.possibleConstructorReturn(this, _BaseOptions.apply(this, arguments));\n                    }\n                    babelHelpers.createClass(Options, [\n                        {\n                            key: 'entriesDescription',\n                            get: function () {\n                                return [\n                                    [\n                                        'Array',\n                                        'sources',\n                                        [\n                                            // urls are from w3c mooc\n                                            [\n                                                'Group',\n                                                'audio',\n                                                [[\n                                                        'Text',\n                                                        'url',\n                                                        [\n                                                            'http://mainline.i3s.unice.fr/mooc/guitarRiff1.mp3',\n                                                            'http://mainline.i3s.unice.fr/mooc/drums.mp3',\n                                                            'http://mainline.i3s.unice.fr/mooc/LaSueur.mp3'\n                                                        ]\n                                                    ]]\n                                            ],\n                                            [\n                                                'Group',\n                                                'video',\n                                                [\n                                                    [\n                                                        'Text',\n                                                        'url',\n                                                        [\n                                                            'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.webm',\n                                                            'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.mp4',\n                                                            'http://mainline.i3s.unice.fr/mooc/sintel.webm',\n                                                            'http://mainline.i3s.unice.fr/mooc/sintel.mp4'\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'Int',\n                                                        'width',\n                                                        [\n                                                            1,\n                                                            1920\n                                                        ],\n                                                        320\n                                                    ],\n                                                    [\n                                                        'Int',\n                                                        'height',\n                                                        [\n                                                            1,\n                                                            1080\n                                                        ],\n                                                        240\n                                                    ]\n                                                ]\n                                            ]\n                                        ],\n                                        'source'\n                                    ],\n                                    [\n                                        'Array',\n                                        'filters',\n                                        [\n                                            [\n                                                'Group',\n                                                'gain',\n                                                [[\n                                                        'LiveFloat',\n                                                        'gain',\n                                                        [\n                                                            0,\n                                                            10,\n                                                            0,\n                                                            1\n                                                        ],\n                                                        1\n                                                    ]]\n                                            ],\n                                            [\n                                                'Group',\n                                                'panner',\n                                                [[\n                                                        'LiveFloat',\n                                                        'pan',\n                                                        [\n                                                            -1,\n                                                            1\n                                                        ],\n                                                        0\n                                                    ]]\n                                            ],\n                                            [\n                                                'Group',\n                                                'biquad',\n                                                [\n                                                    [\n                                                        'LiveSelect',\n                                                        'type',\n                                                        [\n                                                            'lowpass',\n                                                            'highpass',\n                                                            'bandpass',\n                                                            'lowshelf',\n                                                            'highshelf',\n                                                            'peaking',\n                                                            'notch',\n                                                            'allpass'\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'LiveInt',\n                                                        'frequency',\n                                                        [\n                                                            0,\n                                                            22050\n                                                        ],\n                                                        350\n                                                    ],\n                                                    [\n                                                        'LiveFloat',\n                                                        'Q',\n                                                        [\n                                                            -4,\n                                                            4\n                                                        ],\n                                                        0\n                                                    ],\n                                                    // log Q\n                                                    [\n                                                        'LiveInt',\n                                                        'gain',\n                                                        [\n                                                            -30,\n                                                            30\n                                                        ],\n                                                        0\n                                                    ],\n                                                    [\n                                                        'LiveInt',\n                                                        'detune',\n                                                        [\n                                                            0,\n                                                            100\n                                                        ]\n                                                    ]\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'convolver',\n                                                [\n                                                    [\n                                                        'LiveFloat',\n                                                        'reverb',\n                                                        [\n                                                            0,\n                                                            1\n                                                        ]\n                                                    ],\n                                                    [\n                                                        'Text',\n                                                        'url',\n                                                        ['http://mainline.i3s.unice.fr/mooc/Scala-Milan-Opera-Hall.wav']\n                                                    ]\n                                                ]\n                                            ],\n                                            [\n                                                'Group',\n                                                'equalizer',\n                                                [\n                                                    60,\n                                                    170,\n                                                    350,\n                                                    1000,\n                                                    3500,\n                                                    10000\n                                                ].map(function (freq) {\n                                                    return [\n                                                        'LiveInt',\n                                                        'gain' + freq,\n                                                        [\n                                                            -30,\n                                                            30\n                                                        ],\n                                                        0\n                                                    ];\n                                                })\n                                            ]\n                                        ],\n                                        'filter'\n                                    ],\n                                    [\n                                        'Group',\n                                        'destination',\n                                        [\n                                            [\n                                                'Checkbox',\n                                                'compressor'\n                                            ],\n                                            // Firefox compresses automatically?\n                                            [\n                                                'Checkbox',\n                                                'waveform'\n                                            ]\n                                        ]\n                                    ]\n                                ];\n                            }\n                        },\n                        {\n                            key: 'optionClasses',\n                            get: function () {\n                                return require('./option-classes.js');\n                            }\n                        }\n                    ]);\n                    return Options;\n                }(BaseOptions);\n                module.exports = Options;\n            },\n            {\n                './option-classes.js': 16,\n                'crnx-base/options': 4\n            }\n        ],\n        19: [\n            function (require, module, exports) {\n                'use strict';\n                var Lines = require('./html-lines.js');\n                var UnescapedLines = require('crnx-base/lines');\n                var CollectionFeature = require('./collection-feature.js');\n                function capitalize(s) {\n                    return s.charAt(0).toUpperCase() + s.slice(1);\n                }\n                function toCamelCase(s) {\n                    return s.split('.').map(function (w, i) {\n                        return i > 0 ? capitalize(w) : w;\n                    }).join('');\n                }\n                var Source = function () {\n                    function Source(options, n) {\n                        babelHelpers.classCallCheck(this, Source);\n                        this.options = options;\n                        this.n = n;\n                    }\n                    Source.prototype.getHtmlLines = function getHtmlLines(featureContext, i18n) {\n                        return this.getElementHtmlLines(featureContext, i18n).wrap('<div>', '</div>');\n                    };\n                    Source.prototype.getJsInitLines = function getJsInitLines(i18n) {\n                        return new Lines(new UnescapedLines('// ' + i18n('comment.sources.' + this.type)), 'var ' + this.nodeJsName + '=ctx.createMediaElementSource(document.getElementById(\\'' + this.elementHtmlName + '\\'));');\n                    };\n                    // abstract:\n                    // get type()\n                    // getElementHtmlLines(featureContext,i18n) // TODO html escape\n                    babelHelpers.createClass(Source, [\n                        {\n                            key: 'nSuffix',\n                            get: function () {\n                                if (this.n !== undefined) {\n                                    return '.' + this.n;\n                                } else {\n                                    return '';\n                                }\n                            }\n                        },\n                        {\n                            key: 'elementHtmlName',\n                            get: function () {\n                                return 'my.' + this.type + this.nSuffix;\n                            }\n                        },\n                        {\n                            key: 'nodeJsName',\n                            get: function () {\n                                return toCamelCase(this.type + this.nSuffix + '.node');\n                            }\n                        }\n                    ]);\n                    return Source;\n                }();\n                var sourceClasses = {\n                    audio: function (_Source) {\n                        babelHelpers.inherits(audio, _Source);\n                        function audio() {\n                            babelHelpers.classCallCheck(this, audio);\n                            return babelHelpers.possibleConstructorReturn(this, _Source.apply(this, arguments));\n                        }\n                        audio.prototype.getElementHtmlLines = function getElementHtmlLines(featureContext, i18n) {\n                            return new Lines('<audio src=\\'' + this.options.url + '\\' id=\\'' + this.elementHtmlName + '\\' controls loop' + (featureContext.audioContext ? ' crossorigin=\\'anonymous\\'' : '') + '></audio>');\n                        };\n                        babelHelpers.createClass(audio, [{\n                                key: 'type',\n                                get: function () {\n                                    return 'audio';\n                                }\n                            }]);\n                        return audio;\n                    }(Source),\n                    video: function (_Source2) {\n                        babelHelpers.inherits(video, _Source2);\n                        function video() {\n                            babelHelpers.classCallCheck(this, video);\n                            return babelHelpers.possibleConstructorReturn(this, _Source2.apply(this, arguments));\n                        }\n                        video.prototype.getElementHtmlLines = function getElementHtmlLines(featureContext, i18n) {\n                            return new Lines('<video src=\\'' + this.options.url + '\\' id=\\'' + this.elementHtmlName + '\\' width=\\'' + this.options.width + '\\' height=\\'' + this.options.height + '\\' controls loop' + (featureContext.audioContext ? ' crossorigin=\\'anonymous\\'' : '') + '></video>');\n                        };\n                        babelHelpers.createClass(video, [{\n                                key: 'type',\n                                get: function () {\n                                    return 'video';\n                                }\n                            }]);\n                        return video;\n                    }(Source)\n                };\n                var SourceSet = function (_CollectionFeature) {\n                    babelHelpers.inherits(SourceSet, _CollectionFeature);\n                    function SourceSet() {\n                        babelHelpers.classCallCheck(this, SourceSet);\n                        return babelHelpers.possibleConstructorReturn(this, _CollectionFeature.apply(this, arguments));\n                    }\n                    SourceSet.prototype.getEntryClass = function getEntryClass(entryOption) {\n                        return sourceClasses[entryOption.source];\n                    };\n                    SourceSet.prototype.requestFeatureContext = function requestFeatureContext(featureContext) {\n                        if (this.entries.length > 0) {\n                            featureContext.audioProcessing = true;\n                        }\n                    };\n                    SourceSet.prototype.getJsInitLines = function getJsInitLines(featureContext, i18n, prevNodeJsNames) {\n                        var _CollectionFeature$pr;\n                        var lines = (_CollectionFeature$pr = _CollectionFeature.prototype.getJsInitLines).call.apply(_CollectionFeature$pr, [this].concat(Array.prototype.slice.call(arguments)));\n                        if (featureContext.audioContext) {\n                            lines.interleave.apply(lines, this.entries.map(function (entry) {\n                                return entry.getJsInitLines(i18n);\n                            }));\n                        }\n                        return lines;\n                    };\n                    SourceSet.prototype.getNodeJsNames = function getNodeJsNames(featureContext, prevNodeJsNames) {\n                        if (featureContext.audioContext) {\n                            return this.entries.map(function (entry) {\n                                return entry.nodeJsName;\n                            });\n                        } else {\n                            return prevNodeJsNames;\n                        }\n                    };\n                    return SourceSet;\n                }(CollectionFeature);\n                module.exports = SourceSet;\n            },\n            {\n                './collection-feature.js': 9,\n                './html-lines.js': 13,\n                'crnx-base/lines': 1\n            }\n        ]\n    }, {}, [15]));\n}());","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\n\r\n/*\r\n.a = add AFTER last line\r\n.t = add TO last line\r\n*/\r\n\r\nclass Lines {\r\n\tconstructor() {\r\n\t\tthis.data=this.flattenArgs(arguments);\r\n\t}\r\n\r\n\t// private:\r\n\tpreprocessString(str) {\r\n\t\treturn str;\r\n\t}\r\n\tflattenArgs(s) {\r\n\t\tconst r=[];\r\n\t\tfor (let i=0;i<s.length;i++) {\r\n\t\t\tif (typeof s[i] == 'string') {\r\n\t\t\t\tr.push(this.preprocessString(s[i]));\r\n\t\t\t} else if (Array.isArray(s[i])) {\r\n\t\t\t\t// TODO remove and use lines.a(...array) instead\r\n\t\t\t\tr.push(...s[i].map(str=>this.preprocessString(str)));\r\n\t\t\t} else if (s[i] instanceof Lines) {\r\n\t\t\t\tr.push(...s[i].data);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\r\n\t// public:\r\n\ta() {\r\n\t\tthis.data.push(...this.flattenArgs(arguments));\r\n\t\treturn this;\r\n\t}\r\n\tt() {\r\n\t\tconst lastLine=this.data.pop();\r\n\t\tconst s=this.flattenArgs(arguments);\r\n\t\ts[0]=lastLine+s[0];\r\n\t\tthis.data.push(...s);\r\n\t\treturn this;\r\n\t}\r\n\tindent(level) {\r\n\t\tif (level===undefined) {\r\n\t\t\tlevel=1;\r\n\t\t}\r\n\t\tthis.data=this.data.map(line=>Array(level+1).join('\\t')+line);\r\n\t\treturn this;\r\n\t}\r\n\tisEmpty() {\r\n\t\treturn this.data.length<=0;\r\n\t}\r\n\tinterleave() {\r\n\t\tlet first=true;\r\n\t\tfor (let i=0;i<arguments.length;i++) {\r\n\t\t\tconst r=this.flattenArgs([arguments[i]]);\r\n\t\t\tif (r.length>0) {\r\n\t\t\t\tif (first) {\r\n\t\t\t\t\tfirst=false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.data.push('');\r\n\t\t\t\t}\r\n\t\t\t\tthis.data.push(...r);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\twrap(begin,end) {\r\n\t\tthis.indent();\r\n\t\tthis.data.unshift(this.preprocessString(begin));\r\n\t\tthis.data.push(this.preprocessString(end));\r\n\t\treturn this;\r\n\t}\r\n\twrapIfNotEmpty(begin,end) {\r\n\t\tif (!this.isEmpty()) {\r\n\t\t\tthis.wrap(begin,end);\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n/*\r\n\twrapEachLine(begin,end) {\r\n\t\tthis.data=this.data.map(function(line){\r\n\t\t\treturn begin+line+end;\r\n\t\t});\r\n\t\treturn this;\r\n\t}\r\n\tmap(fn) {\r\n\t\tthis.data=this.data.map(fn);\r\n\t\treturn this;\r\n\t}\r\n*/\r\n\tjoin(indent) {\r\n\t\treturn this.data.map(function(line){\r\n\t\t\treturn line.replace(/^(\\t)+/,function(match){\r\n\t\t\t\treturn Array(match.length+1).join(indent);\r\n\t\t\t});\r\n\t\t}).join('\\n');\r\n\t}\r\n}\r\n\r\nmodule.exports=Lines;\r\n","'use strict';\r\n\r\n// constructors typically called from Options class\r\n// to call them manually, use the following args:\r\n//\tname,contents/availableValues,defaultValue,data - similar to entriesDescription()\r\n// the rest of arguments' order is not settled, don't use them\r\n// \t+ TODO not sure about data\r\n\r\n/*\r\nfixed options spec:\r\n\tinput option returns its value in primitive context (possibly with valueOf() method)\r\n\t\tvalue has primitive type\r\n\toptions have the following properties in order of priority (most important first)\r\n\t\ttype property (defaults to 'type') if option is an array member\r\n\t\t\twhy need type property if there's name? - because name is not imported/exported\r\n\t\tsuboption-named properties equal to suboptions for collections\r\n\t\t'entries' array of suboptions for array and collection\r\n\t\t'value' and 'name' properties for non-boolean options\r\n\tTODO decide on: boolean option cannot be an array member (where to store it's type?)\r\n*/\r\n\r\nconst Option={};\r\n\r\n// abstract classes\r\n\r\nOption.Base = class {\r\n\tconstructor(name,_1,_2,_3,fullName,isVisible,updateCallback) {\r\n\t\tthis.name=name;\r\n\t\tthis.isVisible=isVisible;\r\n\t\tthis.updateCallback=updateCallback;\r\n\t\tthis.fullName=fullName;\r\n\t\tthis._$=null;\r\n\t}\r\n\tget $() {\r\n\t\treturn this._$;\r\n\t}\r\n\tset $($) {\r\n\t\tthis._$=$;\r\n\t\tthis.updateVisibility();\r\n\t}\r\n\tupdateVisibility() {\r\n\t\tif (this.$) this.$.toggle(this.isVisible());\r\n\t}\r\n\tshortenExport(data) { // used by parent\r\n\t\tconst dataKeys=Object.keys(data);\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\treturn data.value;\r\n\t\t} else {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t}\r\n\tshortenExportAssign(data,parentData,name) {\r\n\t\tconst dataKeys=Object.keys(data);\r\n\t\tif (dataKeys.length==1 && dataKeys[0]=='value') {\r\n\t\t\tparentData[name]=data.value;\r\n\t\t} else if (dataKeys.length>0) {\r\n\t\t\tparentData[name]=data;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nOption.Input = class extends Option.Base {\r\n\tconstructor(name,availableValues,defaultValue,data,fullName,isVisible,updateCallback) {\r\n\t\tsuper(...arguments);\r\n\t\tif (defaultValue!==undefined) {\r\n\t\t\tthis.defaultValue=defaultValue;\r\n\t\t} else {\r\n\t\t\tthis.defaultValue=availableValues[0];\r\n\t\t}\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdata=data.value;\r\n\t\t}\r\n\t\tif (data!==undefined) {\r\n\t\t\tthis._value=data;\r\n\t\t} else {\r\n\t\t\tthis._value=this.defaultValue;\r\n\t\t}\r\n\t}\r\n\tget value() {\r\n\t\treturn this._value;\r\n\t}\r\n\tset value(value) {\r\n\t\tthis._value=value;\r\n\t\tthis.updateCallback();\r\n\t}\r\n\texport() {\r\n\t\tconst data={};\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value;\r\n\t\treturn data;\r\n\t}\r\n};\r\n\r\nOption.BooleanInput = class extends Option.Input {\r\n\tfix() {\r\n\t\treturn this.value;\r\n\t}\r\n};\r\n\r\nOption.NonBooleanInput = class extends Option.Input {\r\n\tfix() {\r\n\t\tconst value=this.value;\r\n\t\treturn { // can't use fixed value in boolean context\r\n\t\t\tname: this.name,\r\n\t\t\tvalue,\r\n\t\t\tvalueOf() { return value; },\r\n\t\t\ttoString() { return String(value); },\r\n\t\t};\r\n\t}\r\n};\r\n\r\nOption.FactorInput = class extends Option.NonBooleanInput {\r\n\tconstructor(name,availableValues,defaultValue,data,fullName,isVisible,updateCallback) {\r\n\t\tsuper(...arguments);\r\n\t\tthis.availableValues=availableValues;\r\n\t}\r\n};\r\n\r\nOption.RangeInput = class extends Option.NonBooleanInput {\r\n\tconstructor(name,availableRange,defaultValue,data,fullName,isVisible,updateCallback) {\r\n\t\tsuper(...arguments);\r\n\t\tthis.availableMin=availableRange[0];\r\n\t\tthis.availableMax=availableRange[1];\r\n\t}\r\n};\r\n\r\nOption.Collection = class extends Option.Base {\r\n\tconstructor(name,entries,_1,_2,fullName,isVisible,updateCallback) {\r\n\t\tsuper(...arguments);\r\n\t\tthis.entries=entries;\r\n\t}\r\n\texport() {\r\n\t\tconst data={};\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tentry.shortenExportAssign(entry.export(),data,entry.name);\r\n\t\t});\r\n\t\treturn data;\r\n\t}\r\n\tfix() {\r\n\t\tconst fixedEntries=[];\r\n\t\tconst fixed={\r\n\t\t\tname: this.name,\r\n\t\t\tentries: fixedEntries,\r\n\t\t};\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tfixedEntries.push(fixed[entry.name]=entry.fix());\r\n\t\t});\r\n\t\treturn fixed;\r\n\t}\r\n};\r\n\r\n// concrete classes\r\n\r\nOption.Void = class extends Option.Base { // useful as array entry w/o settings\r\n\texport() {\r\n\t\treturn {};\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t};\r\n\t}\r\n}\r\n\r\nOption.Checkbox = class extends Option.BooleanInput {\r\n\tconstructor(name,_,defaultValue,data,fullName,isVisible,updateCallback) {\r\n\t\tsuper(name,undefined,!!defaultValue,data,fullName,isVisible,updateCallback);\r\n\t}\r\n};\r\n\r\nOption.Select = class extends Option.FactorInput {};\r\n\r\nOption.Text = class extends Option.FactorInput {};\r\n\r\nOption.Int = class extends Option.RangeInput {};\r\n\r\nOption.Root = class extends Option.Collection {};\r\n\r\nOption.Group = class extends Option.Collection {};\r\n\r\nOption.Array = class extends Option.Base {\r\n\tconstructor(name,availableConstructors,typePropertyName,data,fullName,isVisible,updateCallback) {\r\n\t\tsuper(name,undefined,undefined,undefined,fullName,isVisible,updateCallback);\r\n\t\tthis.availableConstructors=availableConstructors; // Map {type:constructor}\r\n\t\tif (typePropertyName===undefined) typePropertyName='type';\r\n\t\tthis.typePropertyName=typePropertyName;\r\n\t\tthis._entries=[];\r\n\t\tlet subDatas=[];\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tsubDatas=data;\r\n\t\t} else if (typeof data == 'object') {\r\n\t\t\tsubDatas=data.value;\r\n\t\t}\r\n\t\tlet defaultType=this.availableTypes[0];\r\n\t\tfor (let i=0;i<subDatas.length;i++) {\r\n\t\t\tconst subData=subDatas[i];\r\n\t\t\tlet subType=defaultType;\r\n\t\t\tif (typeof subData == 'object' && subData[typePropertyName]!==undefined) {\r\n\t\t\t\tsubType=subData[typePropertyName];\r\n\t\t\t}\r\n\t\t\tlet subCtor=this.availableConstructors.get(subType);\r\n\t\t\tif (subCtor) {\r\n\t\t\t\tthis._entries.push(subCtor(subData));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget availableTypes() {\r\n\t\tconst types=[];\r\n\t\tthis.availableConstructors.forEach((_,type)=>{\r\n\t\t\ttypes.push(type);\r\n\t\t});\r\n\t\treturn types;\r\n\t}\r\n\tget entries() {\r\n\t\treturn this._entries;\r\n\t}\r\n\tset entries(entries) {\r\n\t\tthis._entries=entries;\r\n\t\tthis.updateCallback();\r\n\t}\r\n\taddEntry(type) {\r\n\t\tconst entry=this.availableConstructors.get(type)();\r\n\t\tthis._entries.push(entry);\r\n\t\tthis.updateCallback();\r\n\t\treturn entry;\r\n\t}\r\n\texport() {\r\n\t\tlet defaultType=this.availableTypes[0];\r\n\t\treturn {\r\n\t\t\tvalue: this._entries.map(entry=>{\r\n\t\t\t\tconst subData=entry.export();\r\n\t\t\t\tconst subType=entry.name;\r\n\t\t\t\tif (subType!=defaultType) subData[this.typePropertyName]=subType;\r\n\t\t\t\treturn entry.shortenExport(subData);\r\n\t\t\t}),\r\n\t\t};\r\n\t}\r\n\tfix() {\r\n\t\treturn {\r\n\t\t\tname: this.name,\r\n\t\t\tentries: this._entries.map(entry=>{\r\n\t\t\t\tconst subFixed=entry.fix();\r\n\t\t\t\tif (typeof subFixed == 'object') subFixed[this.typePropertyName]=entry.name;\r\n\t\t\t\treturn subFixed;\r\n\t\t\t}),\r\n\t\t};\r\n\t}\r\n};\r\n\r\nmodule.exports=Option;\r\n","'use strict';\r\n\r\nconst Option=require('./option-classes.js');\r\n\r\nclass OptionsOutput {\r\n\tconstructor(options,generateId,i18n) {\r\n\t\tconst optionClassWriters=new Map;\r\n\t\tthis.setOptionClassWriters(optionClassWriters);\r\n\t\tfunction write(option) {\r\n\t\t\tlet optionProto=option;\r\n\t\t\twhile (optionProto=Object.getPrototypeOf(optionProto)) {\r\n\t\t\t\tconst optionClassWriter=optionClassWriters.get(optionProto.constructor);\r\n\t\t\t\tif (optionClassWriter) {\r\n\t\t\t\t\treturn optionClassWriter(option,write,i18n,generateId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// public prop:\r\n\t\tthis.$output=write(options.root);\r\n\t}\r\n\t// override this fn for custom writers\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\toptionClassWriters.set(Option.Root,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='options-output'>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t);\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Group,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\").append(\r\n\t\t\t\toption.entries.map(writeOption)\r\n\t\t\t);\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Void,(option,writeOption,i18n,generateId)=>{\r\n\t\t\treturn option.$=$(\"<div class='option void'>\")\r\n\t\t\t\t.html(i18n('options.'+option.fullName))\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Checkbox,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId();\r\n\t\t\treturn option.$=$(\"<div class='option'>\")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<input type='checkbox' id='\"+id+\"'>\")\r\n\t\t\t\t\t\t.prop('checked',option.value)\r\n\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\toption.value=$(this).prop('checked');\r\n\t\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t\t.append(\" <label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\"</label>\");\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Select,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId();\r\n\t\t\treturn option.$=$(\"<div>\")\r\n\t\t\t\t.append(\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\")\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\t\toption.availableValues.map(function(availableValue){\r\n\t\t\t\t\t\t\treturn $(\"<option>\").val(availableValue).html(i18n('options.'+option.fullName+'.'+availableValue))\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\t\toption.value=this.value;\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Text,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId();\r\n\t\t\tconst listId=generateId();\r\n\t\t\treturn option.$=$(\"<div class='option'>\")\r\n\t\t\t\t.append(\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\")\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<input type='text' id='\"+id+\"' list='\"+listId+\"' />\")\r\n\t\t\t\t\t\t.val(option.value)\r\n\t\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\t\toption.value=this.value;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<datalist id='\"+listId+\"'>\")\r\n\t\t\t\t\t\t.append(\r\n\t\t\t\t\t\t\toption.availableValues.map(availableValue=>$(\"<option>\").text(availableValue))\r\n\t\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Int,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId();\r\n\t\t\treturn option.$=$(\"<div class='option'>\")\r\n\t\t\t\t.append(\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\")\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<input type='number' id='\"+id+\"' required />\")\r\n\t\t\t\t\t\t.val(option.value)\r\n\t\t\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t\t\t.attr('step',option.step)\r\n\t\t\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\t\t\toption.value=this.value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.Array,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tlet $dragged=null;\r\n\t\t\tlet $entries;\r\n\t\t\tconst updateArrayEntries=()=>{\r\n\t\t\t\toption.entries=$entries.children().map(function(){\r\n\t\t\t\t\treturn $(this).data('option');\r\n\t\t\t\t}).get();\r\n\t\t\t};\r\n\t\t\tconst writeDraggableOption=option=>{\r\n\t\t\t\t// have to make drag handler 'draggable', not the whole item\r\n\t\t\t\t// because inputs and labels don't like to be inside 'draggable'\r\n\t\t\t\t// http://stackoverflow.com/questions/13017177/selection-disabled-while-using-html5-drag-and-drop\r\n\t\t\t\treturn $(\"<div class='draggable-with-handle'>\")\r\n\t\t\t\t\t.data('option',option)\r\n\t\t\t\t\t.append(\r\n\t\t\t\t\t\t$(\"<div draggable='true' tabindex='0' title='\"+i18n('options-output.drag')+\"'>\")\r\n\t\t\t\t\t\t\t.on('dragstart',function(ev){\r\n\t\t\t\t\t\t\t\t$dragged=$(this).parent();\r\n\t\t\t\t\t\t\t\tev.originalEvent.dataTransfer.effectAllowed='move';\r\n\t\t\t\t\t\t\t\tev.originalEvent.dataTransfer.setData('Text',name);\r\n\t\t\t\t\t\t\t\tif (ev.originalEvent.dataTransfer.setDragImage) { // doesn't work in IE\r\n\t\t\t\t\t\t\t\t\tev.originalEvent.dataTransfer.setDragImage($dragged[0],0,0);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\t\t$dragged.addClass('ghost');\r\n\t\t\t\t\t\t\t\t},0);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.keydown(function(ev){\r\n\t\t\t\t\t\t\t\tconst $handle=$(this);\r\n\t\t\t\t\t\t\t\tconst $sorted=$handle.parent();\r\n\t\t\t\t\t\t\t\tif (ev.keyCode==38) {\r\n\t\t\t\t\t\t\t\t\t$sorted.prev().before($sorted);\r\n\t\t\t\t\t\t\t\t\t$handle.focus();\r\n\t\t\t\t\t\t\t\t\tupdateArrayEntries();\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t} else if (ev.keyCode==40) {\r\n\t\t\t\t\t\t\t\t\t$sorted.next().after($sorted);\r\n\t\t\t\t\t\t\t\t\t$handle.focus();\r\n\t\t\t\t\t\t\t\t\tupdateArrayEntries();\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.append(writeOption(option))\r\n\t\t\t\t\t.append(\r\n\t\t\t\t\t\t//$(\"<div tabindex='0' class='delete' title='\"+i18n('options-output.delete')+\"'></div>\")\r\n\t\t\t\t\t\t$(\"<div tabindex='0' class='delete' title='\"+i18n('options-output.delete')+\"'>\")\r\n\t\t\t\t\t\t\t.click(function(){\r\n\t\t\t\t\t\t\t\t$(this).parent().remove();\r\n\t\t\t\t\t\t\t\tupdateArrayEntries();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.keydown(function(ev){\r\n\t\t\t\t\t\t\t\tif (ev.keyCode==13 || ev.keyCode==32) {\r\n\t\t\t\t\t\t\t\t\t$(this).parent().remove();\r\n\t\t\t\t\t\t\t\t\tupdateArrayEntries();\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.on('dragover',function(ev){\r\n\t\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\t\tev.originalEvent.dataTransfer.dropEffect='move';\r\n\t\t\t\t\t\tconst $target=$(this);\r\n\t\t\t\t\t\tif ($dragged) {\r\n\t\t\t\t\t\t\tif ($target.nextAll().is($dragged)) {\r\n\t\t\t\t\t\t\t\t$target.before($dragged);\r\n\t\t\t\t\t\t\t\tupdateArrayEntries();\r\n\t\t\t\t\t\t\t} else if ($target.prevAll().is($dragged)) {\r\n\t\t\t\t\t\t\t\t$target.after($dragged);\r\n\t\t\t\t\t\t\t\tupdateArrayEntries();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('drop',function(ev){\r\n\t\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('dragend',function(ev){\r\n\t\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\t\tif ($dragged) {\r\n\t\t\t\t\t\t\t$dragged.removeClass('ghost');\r\n\t\t\t\t\t\t\t$dragged=null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\t\t\toption.$=$(\"<fieldset>\").append(\"<legend>\"+i18n('options.'+option.fullName)+\"</legend>\")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$entries=$(\"<div>\")\r\n\t\t\t\t\t\t.append(option.entries.map(writeDraggableOption))\r\n\t\t\t\t);\r\n\t\t\tconst $buttons=$(\"<div>\");\r\n\t\t\toption.availableTypes.forEach((type,i)=>{\r\n\t\t\t\tif (i) $buttons.append(\" \");\r\n\t\t\t\t$buttons.append(\r\n\t\t\t\t\t$(\"<button type='button'>\")\r\n\t\t\t\t\t\t.html(i18n('options.'+option.fullName+'.'+type+'.add'))\r\n\t\t\t\t\t\t.click(function(){\r\n\t\t\t\t\t\t\tconst entry=option.addEntry(type);\r\n\t\t\t\t\t\t\t$entries.append(writeDraggableOption(entry));\r\n\t\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t\toption.$.append($buttons);\r\n\t\t\treturn option.$;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput;\r\n","'use strict';\r\n\r\nclass Options {\r\n\tconstructor(data) { // data = imported values, import is done in ctor to avoid calling updateCallback later\r\n\t\tthis.updateCallback=undefined; // general update callback for stuff like regenerating the code\r\n\t\tconst simpleUpdateCallback=()=>{\r\n\t\t\tif (this.updateCallback) this.updateCallback();\r\n\t\t};\r\n\t\tconst Option=this.optionClasses;\r\n\t\tconst optionByFullName={};\r\n\t\tconst optionsWithVisibilityAffectedByFullName={};\r\n\t\tconst makeEntry=(description,fullNamePath,data,isInsideArray)=>{\r\n\t\t\tconst className=description[0];\r\n\t\t\tif (Option[className]===undefined) {\r\n\t\t\t\tthrow new Error(`invalid option type '${className}'`);\r\n\t\t\t}\r\n\t\t\tconst name=description[1];\r\n\t\t\tconst fullName=fullNamePath+name;\r\n\t\t\tconst ctorArgsDescription=description.slice(2);\r\n\t\t\tlet contents=[];\r\n\t\t\tlet defaultValue;\r\n\t\t\tlet visibilityData={};\r\n\t\t\tlet nScalars=0;\r\n\t\t\tlet nArrays=0;\r\n\t\t\tlet nObjects=0;\r\n\t\t\tfor (let i=0;i<ctorArgsDescription.length;i++) {\r\n\t\t\t\tlet arg=ctorArgsDescription[i];\r\n\t\t\t\tif (typeof arg == 'string' || typeof arg == 'number' || typeof arg == 'boolean') {\r\n\t\t\t\t\tif (nScalars==0) {\r\n\t\t\t\t\t\tdefaultValue=arg;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"too many scalar arguments\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnScalars++;\r\n\t\t\t\t} else if (Array.isArray(arg)) {\r\n\t\t\t\t\tif (nArrays==0) {\r\n\t\t\t\t\t\tif (!isInsideArray && className=='Array') { // TODO test array inside array\r\n\t\t\t\t\t\t\tcontents=new Map;\r\n\t\t\t\t\t\t\targ.forEach(x=>{\r\n\t\t\t\t\t\t\t\tconst type=x[1];\r\n\t\t\t\t\t\t\t\tconst ctor=subData=>makeEntry(x,fullName+'.',subData,true);\r\n\t\t\t\t\t\t\t\tcontents.set(type,ctor);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcontents=arg.map(x=>{\r\n\t\t\t\t\t\t\t\tif (Array.isArray(x)) {\r\n\t\t\t\t\t\t\t\t\tconst subName=x[1];\r\n\t\t\t\t\t\t\t\t\tlet subData;\r\n\t\t\t\t\t\t\t\t\tif (typeof data == 'object') subData=data[subName];\r\n\t\t\t\t\t\t\t\t\treturn makeEntry(x,fullName+'.',subData,isInsideArray); // nested option\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\treturn x; // available value / value range boundary\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"too many array arguments\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnArrays++;\r\n\t\t\t\t} else if (!isInsideArray && (arg instanceof Object)) {\r\n\t\t\t\t\tif (nObjects==0) {\r\n\t\t\t\t\t\tvisibilityData=arg;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"too many array arguments\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnObjects++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(\"unknown argument type\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet isVisible,updateCallback;\r\n\t\t\tif (isInsideArray) {\r\n\t\t\t\tupdateCallback=simpleUpdateCallback;\r\n\t\t\t\tisVisible=()=>true;\r\n\t\t\t} else {\r\n\t\t\t\tisVisible=()=>{\r\n\t\t\t\t\tfor (let testName in visibilityData) {\r\n\t\t\t\t\t\tconst value=optionByFullName[testName].value;\r\n\t\t\t\t\t\tif (visibilityData[testName].indexOf(value)<0) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tupdateCallback=()=>{\r\n\t\t\t\t\tif (optionsWithVisibilityAffectedByFullName[fullName]!==undefined) {\r\n\t\t\t\t\t\toptionsWithVisibilityAffectedByFullName[fullName].forEach(option=>{\r\n\t\t\t\t\t\t\toption.updateVisibility();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.updateCallback) this.updateCallback();\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tconst option=new Option[className](name,contents,defaultValue,data,fullName,isVisible,updateCallback);\r\n\t\t\tif (!isInsideArray) {\r\n\t\t\t\toptionByFullName[fullName]=option;\r\n\t\t\t\tfor (let testName in visibilityData) {\r\n\t\t\t\t\tif (optionsWithVisibilityAffectedByFullName[testName]===undefined) {\r\n\t\t\t\t\t\toptionsWithVisibilityAffectedByFullName[testName]=[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptionsWithVisibilityAffectedByFullName[testName].push(option);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn option;\r\n\t\t};\r\n\t\tthis.root=new Option.Root(\r\n\t\t\tnull,this.entriesDescription.map(description=>{\r\n\t\t\t\tconst subName=description[1];\r\n\t\t\t\tlet subData;\r\n\t\t\t\tif (typeof data == 'object') subData=data[subName];\r\n\t\t\t\treturn makeEntry(description,'',subData,false);\r\n\t\t\t}),undefined,data,null,()=>true,simpleUpdateCallback\r\n\t\t);\r\n\t}\r\n\t// methods to be redefined by subclasses\r\n\t// TODO make them static?\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes.js');\r\n\t}\r\n\tget entriesDescription() {\r\n\t\treturn [];\r\n\t}\r\n\t// public methods\r\n\texport() {\r\n\t\treturn this.root.shortenExport(this.root.export());\r\n\t}\r\n\tfix() {\r\n\t\treturn this.root.fix();\r\n\t}\r\n}\r\n\r\nmodule.exports=Options;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst UnescapedLines=require('crnx-base/lines');\r\nconst Feature=require('./feature.js');\r\n\r\nclass AudioContext extends Feature {\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst lines=super.getJsInitLines(...arguments);\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\tlines.a(\r\n\t\t\t\tnew UnescapedLines(\"// \"+i18n('comment.context')),\r\n\t\t\t\t\"var ctx=new (AudioContext || webkitAudioContext);\"\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n}\r\n\r\nmodule.exports=AudioContext;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst Feature=require('./feature.js');\r\n\r\nclass Canvas extends Feature {\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tconst lines=super.getHtmlLines(...arguments);\r\n\t\tif (featureContext.canvas) {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"<div>\",\r\n\t\t\t\t\"\t<canvas id='my.canvas' width='300' height='100'></canvas>\",\r\n\t\t\t\t\"</div>\"\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst lines=super.getJsInitLines(...arguments);\r\n\t\tif (featureContext.canvas) {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"var canvas=document.getElementById('my.canvas');\",\r\n\t\t\t\t\"var canvasContext=canvas.getContext('2d');\"\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n}\r\n\r\nmodule.exports=Canvas;\r\n","'use strict';\r\n\r\nclass CodeOutput {\r\n\tconstructor(generateCodeFn) {\r\n\t\tlet $code;\r\n\t\tconst getHtmlDataUri=(html)=>'data:text/html;charset=utf-8,'+encodeURIComponent(html);\r\n\t\tconst writeControls=()=>{\r\n\t\t\treturn $(\"<div>\").append(\r\n\t\t\t\t$(\"<a download='source.html'><button type='button'>Save source code</button></a>\").click(function(){\r\n\t\t\t\t\t// yes I want a button, but download attr is only available for links\r\n\t\t\t\t\t$(this).attr('href',getHtmlDataUri($code.text()));\r\n\t\t\t\t})\r\n\t\t\t).append(\r\n\t\t\t\t\" \"\r\n\t\t\t).append(\r\n\t\t\t\t$(\"<button type='button'>Run in new window</button>\").click(function(){\r\n\t\t\t\t\twindow.open(getHtmlDataUri($code.text()),\"generatedCode\");\r\n\t\t\t\t})\r\n\t\t\t).append(\r\n\t\t\t\t\" these buttons don't work in Internet Explorer, copy-paste the code manually\"\r\n\t\t\t)\r\n\t\t};\r\n\t\tconst $output=$(\"<div class='code-output'>\").append(writeControls()).append(\r\n\t\t\t$(\"<pre>\").append($code=$(\"<code>\").html(generateCodeFn()))\r\n\t\t);\r\n\t\tif (window.hljs) {\r\n\t\t\thljs.highlightBlock($code[0]);\r\n\t\t} else {\r\n\t\t\t//$output.append(\"<p>\"+i18n('message.hljs')+\"</p>\"); // TODO i18n\r\n\t\t}\r\n\t\t$output.append(writeControls());\r\n\r\n\t\tconst delay=200;\r\n\t\tlet timeoutId=null;\r\n\t\tconst update=()=>{\r\n\t\t\tclearTimeout(timeoutId);\r\n\t\t\ttimeoutId=setTimeout(()=>{\r\n\t\t\t\t$code.html(generateCodeFn());\r\n\t\t\t\tif (window.hljs) hljs.highlightBlock($code[0]);\r\n\t\t\t},delay);\r\n\t\t};\r\n\r\n\t\t// public props:\r\n\t\tthis.$output=$output;\r\n\t\tthis.update=update;\r\n\t}\r\n}\r\n\r\nmodule.exports=CodeOutput;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst AudioContext=require('./audio-context.js');\r\nconst SourceSet=require('./source-set.js');\r\nconst FilterSequence=require('./filter-sequence.js');\r\nconst Destination=require('./destination.js');\r\nconst Canvas=require('./canvas.js');\r\n\r\nmodule.exports=function(options,i18n){\r\n\tconst featureContext={};\r\n\tconst features=[\r\n\t\tnew AudioContext,\r\n\t\tnew SourceSet(options.sources),\r\n\t\tnew FilterSequence(options.filters),\r\n\t\tnew Destination(options.destination),\r\n\t\tnew Canvas,\r\n\t];\r\n\tfeatures.forEach(feature=>{\r\n\t\tfeature.requestFeatureContext(featureContext);\r\n\t});\r\n\tconst lines=new Lines(\r\n\t\t\"<!DOCTYPE html>\",\r\n\t\t\"<html lang='en'>\",\r\n\t\t\"<head>\",\r\n\t\t\"<meta charset='utf-8' />\",\r\n\t\t\"<title>WebAudio example - Generated code</title>\",\r\n\t\t(()=>{\r\n\t\t\tconst lines=new Lines;\r\n\t\t\tif (featureContext.alignedInputs) {\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\t\".aligned label {\",\r\n\t\t\t\t\t\"\tdisplay: inline-block;\",\r\n\t\t\t\t\t\"\twidth: 10em;\",\r\n\t\t\t\t\t\"\ttext-align: right;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (featureContext.canvas) {\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\t\"canvas {\",\r\n\t\t\t\t\t\"\tborder: 1px solid;\",\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\treturn lines.wrapIfNotEmpty(\r\n\t\t\t\t\"<style>\",\r\n\t\t\t\t\"</style>\"\r\n\t\t\t);\r\n\t\t})(),\r\n\t\t\"</head>\",\r\n\t\t\"<body>\",\r\n\t\t(()=>{\r\n\t\t\tconst lines=new Lines;\r\n\t\t\tlines.a(...features.map(feature=>feature.getHtmlLines(featureContext,i18n)));\r\n\t\t\treturn lines;\r\n\t\t})(),\r\n\t\t(()=>{\r\n\t\t\tlet prevNodeJsNames;\r\n\t\t\tconst jsTopLineSets=features.map(feature=>{\r\n\t\t\t\tconst lines=feature.getJsInitLines(featureContext,i18n,prevNodeJsNames);\r\n\t\t\t\tprevNodeJsNames=feature.getNodeJsNames(featureContext,prevNodeJsNames);\r\n\t\t\t\treturn lines;\r\n\t\t\t});\r\n\t\t\tjsTopLineSets.push((()=>{\r\n\t\t\t\t//const lines=new Lines;\r\n\t\t\t\t//lines.interleave(...features.map(feature=>feature.getJsLoopLines(featureContext,i18n)));\r\n\t\t\t\tconst lines=new Lines(...features.map(feature=>feature.getJsLoopLines(featureContext,i18n)));\r\n\t\t\t\t//\r\n\t\t\t\tif (lines.isEmpty()) {\r\n\t\t\t\t\treturn lines;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn new Lines(\r\n\t\t\t\t\t\t\"function visualize() {\",\r\n\t\t\t\t\t\tlines.indent(),\r\n\t\t\t\t\t\t//\"\t\",\r\n\t\t\t\t\t\t\"\trequestAnimationFrame(visualize);\",\r\n\t\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\t\"requestAnimationFrame(visualize);\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t})());\r\n\t\t\tconst lines=new Lines;\r\n\t\t\tlines.interleave(...jsTopLineSets);\r\n\t\t\treturn lines.wrapIfNotEmpty(\"<script>\",\"</script>\");\r\n\t\t})(),\r\n\t\t\"</body>\",\r\n\t\t\"</html>\"\r\n\t);\r\n\treturn lines.join('\\t');\r\n};\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst Feature=require('./feature.js');\r\n\r\nclass CollectionFeature extends Feature {\r\n\tconstructor(entryOptions) {\r\n\t\tsuper();\r\n\t\tconst entryCounts=new Map;\r\n\t\tentryOptions.entries.forEach(entryOption=>{\r\n\t\t\tconst entryClass=this.getEntryClass(entryOption);\r\n\t\t\tentryCounts.set(entryClass,entryCounts.get(entryClass)+1||1);\r\n\t\t});\r\n\t\tconst entryCounts2=new Map;\r\n\t\tthis.entries=entryOptions.entries.map(entryOption=>{\r\n\t\t\tconst entryClass=this.getEntryClass(entryOption);\r\n\t\t\tif (entryCounts.get(entryClass)>1) {\r\n\t\t\t\tconst n=entryCounts2.get(entryClass)||0;\r\n\t\t\t\tentryCounts2.set(entryClass,n+1);\r\n\t\t\t\treturn new entryClass(entryOption,n);\r\n\t\t\t} else {\r\n\t\t\t\treturn new entryClass(entryOption);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn new Lines(...this.entries.map(entry=>entry.getHtmlLines(featureContext,i18n)));\r\n\t}\r\n\t// abstract:\r\n\t// getEntryClass(entryOption) {}\r\n}\r\n\r\nmodule.exports=CollectionFeature;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst UnescapedLines=require('crnx-base/lines');\r\nconst Feature=require('./feature.js');\r\n\r\nclass Destination extends Feature {\r\n\tconstructor(options) {\r\n\t\tsuper();\r\n\t\tthis.options=options;\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tif (!featureContext.audioProcessing) return;\r\n\t\tif (this.options.compressor || this.options.waveform) {\r\n\t\t\tfeatureContext.audioContext=true;\r\n\t\t}\r\n\t\tif (this.options.waveform) {\r\n\t\t\tfeatureContext.canvas=true;\r\n\t\t}\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tif (!featureContext.audioProcessing) return new Lines;\r\n\t\tconst lines=new Lines;\r\n\t\tif (this.options.compressor) {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"<input id='my.compressor' type='checkbox' checked />\",\r\n\t\t\t\t\"<label for='my.compressor'>\"+i18n('options.destination.compressor.enable')+\"</label>\"\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines.wrapIfNotEmpty(\"<div>\",\"</div>\");\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return new Lines;\r\n\t\tconst lines=super.getJsInitLines(...arguments);\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\tif (this.options.compressor) {\r\n\t\t\t\tlet nextNodeJsName=(this.options.waveform ? 'analyserNode' : 'ctx.destination');\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\tnew UnescapedLines(\"// \"+i18n('comment.destination.compressor')),\r\n\t\t\t\t\t\"var compressorNode=ctx.createDynamicsCompressor();\",\r\n\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>prevNodeJsName+\".connect(compressorNode);\")\r\n\t\t\t\t);\r\n\t\t\t\tif (prevNodeJsNames.length>0) {\r\n\t\t\t\t\tlines.a(\r\n\t\t\t\t\t\t\"document.getElementById('my.compressor').onchange=function(){\",\r\n\t\t\t\t\t\t\"\tif (this.checked) {\",\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".disconnect(\"+nextNodeJsName+\");\"),\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".connect(compressorNode);\"),\r\n\t\t\t\t\t\t\"\t} else {\",\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".disconnect(compressorNode);\"),\r\n\t\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>\"\\t\\t\"+prevNodeJsName+\".connect(\"+nextNodeJsName+\");\"),\r\n\t\t\t\t\t\t\"\t}\",\r\n\t\t\t\t\t\t\"};\",\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tprevNodeJsNames=['compressorNode'];\r\n\t\t\t}\r\n\t\t\tif (this.options.waveform) {\r\n\t\t\t\t// TODO need to connect to analyser instead of ctx.destination in event listener above\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\tnew UnescapedLines(\"// \"+i18n('comment.destination.waveform')),\r\n\t\t\t\t\t\"var analyserNode=ctx.createAnalyser();\",\r\n\t\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>prevNodeJsName+\".connect(analyserNode);\"),\r\n\t\t\t\t\t\"analyserNode.fftSize=1024;\",\r\n\t\t\t\t\t\"var analyserData=new Uint8Array(analyserNode.frequencyBinCount);\",\r\n\t\t\t\t\t\"\"\r\n\t\t\t\t);\r\n\t\t\t\tprevNodeJsNames=['analyserNode'];\r\n\t\t\t}\r\n\t\t\tlines.a(\r\n\t\t\t\tnew UnescapedLines(\"// \"+i18n('comment.destination')),\r\n\t\t\t\t...prevNodeJsNames.map(prevNodeJsName=>prevNodeJsName+\".connect(ctx.destination);\")\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n\tgetJsLoopLines(featureContext,i18n) {\r\n\t\tif (!featureContext.audioProcessing) return new Lines;\r\n\t\tconst lines=super.getJsLoopLines(...arguments);\r\n\t\tif (this.options.waveform) {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"analyserNode.getByteTimeDomainData(analyserData);\",\r\n\t\t\t\t\"canvasContext.clearRect(0,0,canvas.width,canvas.height);\",\r\n\t\t\t\t\"canvasContext.beginPath();\",\r\n\t\t\t\t\"for (var i=0;i<analyserData.length;i++) {\",\r\n\t\t\t\t\"\tvar x=i*canvas.width/analyserData.length;\",\r\n\t\t\t\t\"\tvar y=analyserData[i]*canvas.height/255;\",\r\n\t\t\t\t\"\tif (i==0) {\",\r\n\t\t\t\t\"\t\tcanvasContext.moveTo(x,y);\",\r\n\t\t\t\t\"\t} else {\",\r\n\t\t\t\t\"\t\tcanvasContext.lineTo(x,y);\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"canvasContext.stroke();\"\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return prevNodeJsNames;\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\treturn [\"ctx.destination\"];\r\n\t\t} else {\r\n\t\t\treturn prevNodeJsNames;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=Destination;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\n\r\nclass Feature {\r\n\trequestFeatureContext(featureContext) {\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn new Lines;\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\treturn new Lines;\r\n\t}\r\n\tgetJsLoopLines(featureContext,i18n) {\r\n\t\treturn new Lines;\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\treturn prevNodeJsNames;\r\n\t}\r\n}\r\n\r\nmodule.exports=Feature;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst UnescapedLines=require('crnx-base/lines');\r\nconst CollectionFeature=require('./collection-feature.js');\r\n\r\nfunction capitalize(s) {\r\n\treturn s.charAt(0).toUpperCase()+s.slice(1);\r\n}\r\nfunction toCamelCase(s) {\r\n\treturn s.split('.').map((w,i)=>i>0?capitalize(w):w).join('');\r\n}\r\n\r\nclass Filter {\r\n\tconstructor(options,n) {\r\n\t\tthis.options=options;\r\n\t\tthis.n=n;\r\n\t}\r\n\tget nSuffix() {\r\n\t\tif (this.n!==undefined) {\r\n\t\t\treturn '.'+this.n;\r\n\t\t} else {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\tgetPropertyOptionName(property) {\r\n\t\treturn 'options.filters.'+this.type+'.'+property.name;\r\n\t}\r\n\tget nodeJsName() {\r\n\t\treturn toCamelCase(this.type+this.nSuffix+'.node');\r\n\t}\r\n\tgetPropertyInputHtmlName(propertyName) {\r\n\t\treturn 'my.'+this.type+this.nSuffix+'.'+propertyName;\r\n\t}\r\n\tgetPropertyInputJsName(propertyName) {\r\n\t\treturn toCamelCase(this.type+this.nSuffix+'.'+propertyName+'.input');\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t}\r\n\tgetHtmlPropertyLines(i18n,property) {\r\n\t\tconst lines=new Lines;\r\n\t\tconst option=this.options[property.name];\r\n\t\tconst inputHtmlName=this.getPropertyInputHtmlName(property.name);\r\n\t\tif (property.type=='range' && option.input) {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"<label for='\"+inputHtmlName+\"'>\"+i18n(this.getPropertyOptionName(property))+\"</label>\",\r\n\t\t\t\t\"<input id='\"+inputHtmlName+\"' type='range' value='\"+option+\"' min='\"+option.min+\"' max='\"+option.max+\"'\"+(option.step!=1?\" step='\"+option.step+\"'\":\"\")+\" />\"\r\n\t\t\t);\r\n\t\t} else if (property.type=='select' && option.input) {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"<label for='\"+inputHtmlName+\"'>\"+i18n(this.getPropertyOptionName(property))+\"</label>\",\r\n\t\t\t\t(\r\n\t\t\t\t\tnew Lines(...option.availableValues.map(value=>\"<option\"+(option.value==value?\" selected\":\"\")+\">\"+value+\"</option>\"))\r\n\t\t\t\t).wrap(\r\n\t\t\t\t\t\"<select id='\"+inputHtmlName+\"'>\",\"</select>\"\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t} else if (property.type=='xhr') {\r\n\t\t\tlines.a(\r\n\t\t\t\t\"<span id='\"+inputHtmlName+\"'>\"+i18n(this.getPropertyOptionName(property)+'.loading')+\"</span>\"\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n\tget skipNode() {\r\n\t\treturn false;\r\n\t}\r\n\t// { not called if skipNode is set\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tconst lines=new Lines(\r\n\t\t\t...this.nodeProperties.map(property=>this.getHtmlPropertyLines(i18n,property))\r\n\t\t);\r\n\t\treturn lines.wrapIfNotEmpty(\"<div>\",\"</div>\");\r\n\t}\r\n\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\treturn new Lines(\r\n\t\t\tnew UnescapedLines(\"// \"+i18n('comment.filters.'+this.type)),\r\n\t\t\t\"var \"+this.nodeJsName+\"=ctx.\"+this.ctxCreateMethodName+\"();\",\r\n\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+this.nodeJsName+\");\"\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\tget nodeJsNames() {\r\n\t\treturn [this.nodeJsName];\r\n\t}\r\n\t// }\r\n\t// abstract:\r\n\t// get type()\r\n\t// get ctxCreateMethodName()\r\n\t// get nodeProperties()\r\n}\r\n\r\nclass SinglePathFilter extends Filter {\r\n\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\tconst lines=super.getJsInitLines(i18n,prevNodeJsNames);\r\n\t\tthis.nodeProperties.forEach(property=>{\r\n\t\t\tconst option=this.options[property.name];\r\n\t\t\tconst nodePropertyJsName=this.nodeJsName+\".\"+property.name+(property.type=='range'?\".value\":\"\");\r\n\t\t\tif (option.input) {\r\n\t\t\t\tconst inputJsName=this.getPropertyInputJsName(property.name);\r\n\t\t\t\tconst inputHtmlName=this.getPropertyInputHtmlName(property.name);\r\n\t\t\t\tlet value=inputJsName+\".value\";\r\n\t\t\t\tif (property.fn) {\r\n\t\t\t\t\tvalue=property.fn(value);\r\n\t\t\t\t}\r\n\t\t\t\tconst eventProp=(property.type=='range'?'oninput':'onchange');\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\t\"var \"+inputJsName+\"=document.getElementById('\"+inputHtmlName+\"');\",\r\n\t\t\t\t\t// was for IE11 compat (but IE11 has no Web Audio): (property.type=='range'?inputJsName+\".oninput=\":\"\")+inputJsName+\".onchange=function(){\",\r\n\t\t\t\t\t\"(\"+inputJsName+\".\"+eventProp+\"=function(){\",\r\n\t\t\t\t\t\"\t\"+nodePropertyJsName+\"=\"+value+\";\",\r\n\t\t\t\t\t\"})();\"\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tlet value=option.value;\r\n\t\t\t\tif (property.type=='select') {\r\n\t\t\t\t\tvalue=\"'\"+value+\"'\";\r\n\t\t\t\t}\r\n\t\t\t\tif (property.fn) {\r\n\t\t\t\t\tvalue=property.fn(value);\r\n\t\t\t\t}\r\n\t\t\t\tif (option.value!=option.defaultValue) {\r\n\t\t\t\t\tlines.a(\r\n\t\t\t\t\t\tnodePropertyJsName+\"=\"+value+\";\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn lines;\r\n\t}\r\n}\r\n\r\nclass PassiveByDefaultSinglePathFilter extends SinglePathFilter {\r\n\tget skipNode() {\r\n\t\treturn this.nodeProperties.every(property=>{\r\n\t\t\tconst option=this.options[property.name];\r\n\t\t\treturn option.value==option.defaultValue && !option.input;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nconst filterClasses={\r\n\tgain: class extends PassiveByDefaultSinglePathFilter {\r\n\t\tget type()                { return 'gain'; }\r\n\t\tget ctxCreateMethodName() { return 'createGain'; }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'gain',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t},\r\n\tpanner: class extends PassiveByDefaultSinglePathFilter {\r\n\t\tget type()                { return 'panner'; }\r\n\t\tget ctxCreateMethodName() { return 'createStereoPanner'; }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'pan',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t},\r\n\tbiquad: class extends SinglePathFilter {\r\n\t\tget type()                { return 'biquad'; }\r\n\t\tget ctxCreateMethodName() { return 'createBiquadFilter'; }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'type',\r\n\t\t\t\t\ttype:'select',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'frequency',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'Q',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t\tfn:x=>`Math.pow(10,${x})`,\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'gain',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'detune',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t\tget skipNode() {\r\n\t\t\t// lowshelf, highshelf and peaking are passive when gain==0\r\n\t\t\treturn (\r\n\t\t\t\t!this.options.type.input && ['lowshelf','highshelf','peaking'].indexOf(this.options.type.value)>=0 &&\r\n\t\t\t\t!this.options.gain.input && this.options.gain==0\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\tconvolver: class extends Filter {\r\n\t\tget type()                { return 'convolver'; }\r\n\t\tget ctxCreateMethodName() { return 'createConvolver'; }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tname:'reverb',\r\n\t\t\t\t\ttype:'range',\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:'buffer',\r\n\t\t\t\t\ttype:'xhr',\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t\tget dryGainNodeJsName() {\r\n\t\t\treturn toCamelCase(this.type+this.nSuffix+'.dry.gain.node');\r\n\t\t}\r\n\t\tget wetGainNodeJsName() {\r\n\t\t\treturn toCamelCase(this.type+this.nSuffix+'.wet.gain.node');\r\n\t\t}\r\n\t\tget skipNode() {\r\n\t\t\treturn this.options.reverb==0 && !this.options.reverb.input;\r\n\t\t}\r\n\t\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\t\tconst messageHtmlName=this.getPropertyInputHtmlName('buffer');\r\n\t\t\tconst lines=new Lines;\r\n\t\t\tif (this.options.reverb.input || this.options.reverb!=1) {\r\n\t\t\t\tlines.a(new UnescapedLines(\"// \"+i18n('comment.filters.'+this.type)));\r\n\t\t\t} else {\r\n\t\t\t\tlines.a(new UnescapedLines(\"// \"+i18n('comment.filters.'+this.type+'.single')));\r\n\t\t\t}\r\n\t\t\tlines.a(\r\n\t\t\t\t\"var \"+this.nodeJsName+\"=ctx.\"+this.ctxCreateMethodName+\"();\",\r\n\t\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+this.nodeJsName+\");\"\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\tif (this.options.reverb.input || this.options.reverb!=1) {\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\t\"var \"+this.wetGainNodeJsName+\"=ctx.createGain();\",\r\n\t\t\t\t\tthis.nodeJsName+\".connect(\"+this.wetGainNodeJsName+\");\",\r\n\t\t\t\t\t\"var \"+this.dryGainNodeJsName+\"=ctx.createGain();\",\r\n\t\t\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+this.dryGainNodeJsName+\");\"\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\tif (this.options.reverb.input) {\r\n\t\t\t\t\tconst inputHtmlName=this.getPropertyInputHtmlName('reverb');\r\n\t\t\t\t\tconst inputJsName=this.getPropertyInputJsName('reverb');\r\n\t\t\t\t\tlines.a(\r\n\t\t\t\t\t\t\"var \"+inputJsName+\"=document.getElementById('\"+inputHtmlName+\"');\",\r\n\t\t\t\t\t\t\"(\"+inputJsName+\".oninput=function(){\",\r\n\t\t\t\t\t\t\"\t\"+this.wetGainNodeJsName+\".gain.value=\"+inputJsName+\".value;\",\r\n\t\t\t\t\t\t\"\t\"+this.dryGainNodeJsName+\".gain.value=1-\"+inputJsName+\".value;\",\r\n\t\t\t\t\t\t\"})();\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlines.a(\r\n\t\t\t\t\"var xhr=new XMLHttpRequest();\",\r\n\t\t\t\t\"xhr.open('GET','\"+this.options.url+\"');\", // TODO html escape\r\n\t\t\t\t\"xhr.responseType='arraybuffer';\",\r\n\t\t\t\t\"xhr.onload=function(){\",\r\n\t\t\t\t\"\tif (this.status==200) {\", // TODO we are checking status here, but what if <audio>'s status is an error?\r\n\t\t\t\t\"\t\tctx.decodeAudioData(this.response,function(buffer){\",\r\n\t\t\t\t\"\t\t\t\"+this.nodeJsName+\".buffer=buffer;\",\r\n\t\t\t\t\"\t\t\tdocument.getElementById('\"+messageHtmlName+\"').textContent='';\",\r\n\t\t\t\t\"\t\t});\",\r\n\t\t\t\t\"\t} else {\",\r\n\t\t\t\t\"\t\tthis.onerror();\",\r\n\t\t\t\t\"\t}\",\r\n\t\t\t\t\"};\",\r\n\t\t\t\t\"xhr.onerror=function(){\",\r\n\t\t\t\t\"\tdocument.getElementById('\"+messageHtmlName+\"').textContent='\"+i18n('options.filters.convolver.buffer.error')+\"';\",\r\n\t\t\t\t\"};\",\r\n\t\t\t\t\"xhr.send();\"\r\n\t\t\t);\r\n\t\t\treturn lines;\r\n\t\t}\r\n\t\tget nodeJsNames() {\r\n\t\t\tif (this.options.reverb.input || this.options.reverb!=1) {\r\n\t\t\t\treturn [this.wetGainNodeJsName,this.dryGainNodeJsName];\r\n\t\t\t} else {\r\n\t\t\t\treturn [this.nodeJsName];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tequalizer: class extends Filter {\r\n\t\tget type()                { return 'equalizer'; }\r\n\t\tget ctxCreateMethodName() { return 'createBiquadFilter'; }\r\n\t\tget frequencies()         { return [60,170,350,1000,3500,10000]; }\r\n\t\tget nodeProperties() {\r\n\t\t\treturn this.frequencies.map(freq=>({\r\n\t\t\t\tname:'gain'+freq,\r\n\t\t\t\ttype:'range',\r\n\t\t\t}));\r\n\t\t}\r\n\t\tgetFrequencyOption(i) {\r\n\t\t\treturn this.options[this.nodeProperties[i].name];\r\n\t\t}\r\n\t\tget affectedFreqsAndOptions() {\r\n\t\t\treturn this.frequencies.map((freq,i)=>{\r\n\t\t\t\tconst option=this.getFrequencyOption(i);\r\n\t\t\t\treturn {freq,option};\r\n\t\t\t}).filter(fo=>(fo.option.input!=false || fo.option.value!=0));\r\n\t\t}\r\n\t\trequestFeatureContext(featureContext) {\r\n\t\t\tif (!this.allGainsConstant) {\r\n\t\t\t\tfeatureContext.alignedInputs=true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgetHtmlPropertyLines(i18n,property) {\r\n\t\t\tconst lines=super.getHtmlPropertyLines(i18n,property);\r\n\t\t\treturn lines.wrapIfNotEmpty(\"<div class='aligned'>\",\"</div>\");\r\n\t\t}\r\n\t\tget skipNode() {\r\n\t\t\treturn this.affectedFreqsAndOptions.length==0;\r\n\t\t}\r\n\t\tgetJsInitLines(i18n,prevNodeJsNames) {\r\n\t\t\tconst singleFreq=this.affectedFreqsAndOptions.length==1;\r\n\t\t\tconst allGainsConstant=this.affectedFreqsAndOptions.every(fo=>fo.option.input==false);\r\n\t\t\tconst noGainsConstant=this.affectedFreqsAndOptions.every(fo=>fo.option.input==true);\r\n\t\t\tconst getJsData=()=>{\r\n\t\t\t\treturn this.affectedFreqsAndOptions.map(fo=>{\r\n\t\t\t\t\tif (noGainsConstant) {\r\n\t\t\t\t\t\treturn fo.freq;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn \"[\"+fo.freq+\",\"+(fo.option.input ? 'null' : fo.option.value)+\"]\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}).join();\r\n\t\t\t};\r\n\t\t\tconst getJsDataItem=()=>{\r\n\t\t\t\tif (noGainsConstant) {\r\n\t\t\t\t\treturn \"freq\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"freqData\";\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tconst getJsLoopLines=()=>{\r\n\t\t\t\tconst nodeJsName=((allGainsConstant || singleFreq) ? this.nodeJsName : 'node');\r\n\t\t\t\tconst freq=(singleFreq ? this.affectedFreqsAndOptions[0].freq : 'freq');\r\n\t\t\t\tconst gain=(singleFreq ? this.affectedFreqsAndOptions[0].option.value : 'gain');\r\n\t\t\t\tconst lines=new Lines;\r\n\t\t\t\tif (!(noGainsConstant || singleFreq)) {\r\n\t\t\t\t\tlines.a(\"var freq=freqData[0], gain=freqData[1];\");\r\n\t\t\t\t}\r\n\t\t\t\tif (allGainsConstant && !singleFreq) {\r\n\t\t\t\t\tlines.a(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlines.a(\"var \");\r\n\t\t\t\t}\r\n\t\t\t\tlines.t(nodeJsName+\"=ctx.\"+this.ctxCreateMethodName+\"();\");\r\n\t\t\t\tif (singleFreq) {\r\n\t\t\t\t\tlines.a(\r\n\t\t\t\t\t\t...prevNodeJsNames.map(\r\n\t\t\t\t\t\t\tprevNodeJsName=>prevNodeJsName+\".connect(\"+nodeJsName+\");\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (prevNodeJsNames.length==1) {\r\n\t\t\t\t\t\tlines.a(\"prevNode.connect(\"+nodeJsName+\");\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlines.a(\r\n\t\t\t\t\t\t\t\"prevNodes.forEach(function(prevNode){\",\r\n\t\t\t\t\t\t\t\"\tprevNode.connect(\"+nodeJsName+\");\",\r\n\t\t\t\t\t\t\t\"});\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\tnodeJsName+\".type='peaking';\",\r\n\t\t\t\t\tnodeJsName+\".frequency.value=\"+freq+\";\"\r\n\t\t\t\t);\r\n\t\t\t\tif (!noGainsConstant) {\r\n\t\t\t\t\tlet gainLines=new Lines(nodeJsName+\".gain.value=\"+gain+\";\");\r\n\t\t\t\t\tif (!allGainsConstant) {\r\n\t\t\t\t\t\tgainLines.wrap(\"if (gain!==null) {\",\"}\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlines.a(gainLines);\r\n\t\t\t\t}\r\n\t\t\t\tif (!allGainsConstant) {\r\n\t\t\t\t\tconst inputJsName=(singleFreq\r\n\t\t\t\t\t\t? this.getPropertyInputJsName('gain'+freq)\r\n\t\t\t\t\t\t: 'input'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst inputHtmlNameExpr=(singleFreq\r\n\t\t\t\t\t\t? \"'\"+this.getPropertyInputHtmlName('gain'+freq)+\"'\"\r\n\t\t\t\t\t\t: \"'\"+this.getPropertyInputHtmlName('gain')+\"'+freq\"\r\n\t\t\t\t\t);\r\n\t\t\t\t\tlet listenerLines=new Lines(\r\n\t\t\t\t\t\t\"var \"+inputJsName+\"=document.getElementById(\"+inputHtmlNameExpr+\");\",\r\n\t\t\t\t\t\t\"(\"+inputJsName+\".oninput=function(){\",\r\n\t\t\t\t\t\t\"\t\"+nodeJsName+\".gain.value=\"+inputJsName+\".value;\",\r\n\t\t\t\t\t\t\"})();\"\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (!noGainsConstant) {\r\n\t\t\t\t\t\tlines.t(\r\n\t\t\t\t\t\t\t// continues \"if (gain!==null) {...}\"\r\n\t\t\t\t\t\t\tlistenerLines.wrap(\" else {\",\"}\")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlines.a(listenerLines);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!singleFreq) {\r\n\t\t\t\t\tconst outerNodeJsName=(allGainsConstant ? nodeJsName : this.nodeJsName+\"=\"+nodeJsName);\r\n\t\t\t\t\tif (prevNodeJsNames.length==1) {\r\n\t\t\t\t\t\tlines.a(\"prevNode=\"+outerNodeJsName+\";\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlines.a(\"prevNodes=[\"+outerNodeJsName+\"];\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn lines;\r\n\t\t\t};\r\n\t\t\tif (singleFreq) {\r\n\t\t\t\treturn new Lines(\r\n\t\t\t\t\tnew UnescapedLines(\"// \"+i18n('comment.filters.'+this.type+'.single')),\r\n\t\t\t\t\tgetJsLoopLines()\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tconst lines=new Lines(\r\n\t\t\t\t\tnew UnescapedLines(\"// \"+i18n('comment.filters.'+this.type))\r\n\t\t\t\t);\r\n\t\t\t\tif (prevNodeJsNames.length==1) {\r\n\t\t\t\t\tlines.a(\"var prevNode=\"+prevNodeJsNames[0]+\";\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlines.a(\"var prevNodes=[\"+prevNodeJsNames.join()+\"];\");\r\n\t\t\t\t}\r\n\t\t\t\tlines.a(\r\n\t\t\t\t\t\"var \"+this.nodeJsName+\";\",\r\n\t\t\t\t\t\"[\"+getJsData()+\"].forEach(function(\"+getJsDataItem()+\"){\",\r\n\t\t\t\t\tgetJsLoopLines().indent(),\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t);\r\n\t\t\t\treturn lines;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n};\r\n\r\nclass FilterSequence extends CollectionFeature {\r\n\tgetEntryClass(entryOption) {\r\n\t\treturn filterClasses[entryOption.filter];\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tif (!featureContext.audioProcessing) return;\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tif (!entry.skipNode) {\r\n\t\t\t\tfeatureContext.audioContext=true;\r\n\t\t\t\tentry.requestFeatureContext(featureContext);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\tif (!featureContext.audioProcessing) return new Lines;\r\n\t\treturn new Lines(...this.entries.filter(entry=>!entry.skipNode).map(entry=>entry.getHtmlLines(featureContext,i18n)));\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return new Lines;\r\n\t\tconst lines=super.getJsInitLines(...arguments);\r\n\t\tlines.interleave(...this.entries.filter(entry=>!entry.skipNode).map(entry=>{\r\n\t\t\tconst lines=entry.getJsInitLines(i18n,prevNodeJsNames);\r\n\t\t\tprevNodeJsNames=entry.nodeJsNames;\r\n\t\t\treturn lines;\r\n\t\t}));\r\n\t\treturn lines;\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\tif (!featureContext.audioProcessing) return prevNodeJsNames;\r\n\t\tthis.entries.forEach(entry=>{\r\n\t\t\tif (!entry.skipNode) {\r\n\t\t\t\tprevNodeJsNames=entry.nodeJsNames;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn prevNodeJsNames;\r\n\t}\r\n}\r\n\r\nmodule.exports=FilterSequence;\r\n","'use strict';\r\n\r\nconst Lines=require('crnx-base/lines');\r\n\r\nclass HtmlLines extends Lines {\r\n\tpreprocessString(str) { // http://stackoverflow.com/questions/5499078/fastest-method-to-escape-html-tags-as-html-entities\r\n\t\treturn str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');\r\n\t}\r\n}\r\n\r\nmodule.exports=HtmlLines;\r\n","'use strict';\r\n\r\nlet strings={\r\n\t'options.sources': \"Sources\",\r\n\t'options.sources.audio': \"Audio element\",\r\n\t'options.sources.audio.add': \"Add audio element\",\r\n\t'options.sources.audio.url': \"Source URL\",\r\n\t'options.sources.video': \"Video element\",\r\n\t'options.sources.video.add': \"Add video element\",\r\n\t'options.sources.video.url': \"Source URL\",\r\n\t'options.sources.video.width': \"Player width\",\r\n\t'options.sources.video.height': \"Player height\",\r\n\r\n\t'options.filters': \"Filters\",\r\n\t'options.filters.gain': \"Gain\",\r\n\t'options.filters.gain.add': \"Add gain\",\r\n\t'options.filters.gain.gain': \"Gain\",\r\n\t'options.filters.panner': \"Stereo panner\",\r\n\t'options.filters.panner.add': \"Add stereo panner\",\r\n\t'options.filters.panner.pan': \"Pan\",\r\n\t'options.filters.biquad': \"Biquad filter\",\r\n\t'options.filters.biquad.add': \"Add biquad filter\",\r\n\t'options.filters.biquad.type': \"Filter type\",\r\n\t'options.filters.biquad.type.lowpass': \"lowpass\",\r\n\t'options.filters.biquad.type.highpass': \"highpass\",\r\n\t'options.filters.biquad.type.bandpass': \"bandpass\",\r\n\t'options.filters.biquad.type.lowshelf': \"lowshelf\",\r\n\t'options.filters.biquad.type.highshelf': \"highshelf\",\r\n\t'options.filters.biquad.type.peaking': \"peaking\",\r\n\t'options.filters.biquad.type.notch': \"notch\",\r\n\t'options.filters.biquad.type.allpass': \"allpass\",\r\n\t'options.filters.biquad.frequency': \"Frequency\",\r\n\t'options.filters.biquad.Q': \"Log(Q)\",\r\n\t'options.filters.biquad.detune': \"Detune\",\r\n\t'options.filters.biquad.gain': \"Gain [dB]\",\r\n\t'options.filters.convolver': \"Convolver\",\r\n\t'options.filters.convolver.add': \"Add convolver\",\r\n\t'options.filters.convolver.url': \"Impulse responce URL\",\r\n\t'options.filters.convolver.reverb': \"Reverb (dry/wet)\",\r\n\t'options.filters.convolver.buffer.loading': \"Loading and decoding the impulse response\",\r\n\t'options.filters.convolver.buffer.error': \"Error while loading the impulse response\",\r\n\t'options.filters.equalizer': \"Equalizer\",\r\n\t'options.filters.equalizer.add': \"Add equalizer\",\r\n\t'options.filters.equalizer.gain60': \"60 Hz gain\", // TODO {,} expansion\r\n\t'options.filters.equalizer.gain170': \"170 Hz gain\",\r\n\t'options.filters.equalizer.gain350': \"350 Hz gain\",\r\n\t'options.filters.equalizer.gain1000': \"1000 Hz gain\",\r\n\t'options.filters.equalizer.gain3500': \"3500 Hz gain\",\r\n\t'options.filters.equalizer.gain10000': \"10000 Hz gain\",\r\n\r\n\t'options.destination': \"Destination\",\r\n\t'options.destination.compressor': \"Add dynamics compressor before the destination\",\r\n\t'options.destination.compressor.enable': \"Enable dynamics compressor\",\r\n\t'options.destination.waveform': \"Add waveform visualization\",\r\n\r\n\t'options-output.drag': \"Drag or press up/down while in focus to reorder\",\r\n\t'options-output.delete': \"Delete\",\r\n\t'options-output.input': \"Editable\",\r\n\t'options-output.range': \"with range\",\r\n\t'options-output.reset': \"Reset\",\r\n\r\n\t'comment.context': \"create [https://www.w3.org/TR/webaudio/#AudioContext audio context]\",\r\n\t'comment.sources.audio': \"create [https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode audio source node]\",\r\n\t'comment.sources.video': \"create [https://www.w3.org/TR/webaudio/#MediaElementAudioSourceNode video source node]\",\r\n\t'comment.filters.gain': \"create [https://www.w3.org/TR/webaudio/#GainNode gain node]\",\r\n\t'comment.filters.panner': \"create [https://www.w3.org/TR/webaudio/#the-stereopannernode-interface stereo panner node]\",\r\n\t'comment.filters.biquad': \"create [https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface biquad filter node]\",\r\n\t'comment.filters.convolver': \"create dry and wet routes with [https://www.w3.org/TR/webaudio/#ConvolverNode convolver node]\",\r\n\t'comment.filters.convolver.single': \"create [https://www.w3.org/TR/webaudio/#ConvolverNode convolver node]\",\r\n\t'comment.filters.equalizer': \"create equalizer as a sequence of [https://www.w3.org/TR/webaudio/#idl-def-BiquadFilterType.peaking peaking] [https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface biquad filter nodes]\",\r\n\t'comment.filters.equalizer.single': \"create equalizer as a [https://www.w3.org/TR/webaudio/#idl-def-BiquadFilterType.peaking peaking] [https://www.w3.org/TR/webaudio/#the-biquadfilternode-interface biquad filter node]\",\r\n\t'comment.destination': \"connect last node to [https://www.w3.org/TR/webaudio/#AudioDestinationNode destination]\",\r\n\t'comment.destination.compressor': \"create [https://www.w3.org/TR/webaudio/#the-dynamicscompressornode-interface dynamics compressor node]\",\r\n\t'comment.destination.waveform': \"create [https://www.w3.org/TR/webaudio/#the-analysernode-interface analyser node] for waveform visualization\",\r\n};\r\n\r\nfunction i18nLinkFilter(inStrings) {\r\n\tconst linkRegexp=/\\[(\\S+)\\s+([^\\]]+)]/g;\r\n\tconst outStrings={};\r\n\tfor (let id in inStrings) {\r\n\t\toutStrings[id]=inStrings[id].replace(linkRegexp,(match,url,text)=>\"<a href='\"+url+\"'>\"+text+\"</a>\");\r\n\t}\r\n\treturn outStrings;\r\n}\r\n\r\nstrings=i18nLinkFilter(strings);\r\n\r\nmodule.exports=function(lang){\r\n\t// TODO use lang to pick strings\r\n\tconst i18n=function(id){\r\n\t\treturn strings[id];\r\n\t};\r\n\ti18n.lang=lang;\r\n\treturn i18n;\r\n};\r\n","'use strict';\r\n\r\nlet idCounter=0;\r\nfunction generateId() {\r\n\treturn 'webaudio-starter-id-'+(idCounter++);\r\n}\r\n\r\nconst i18n=require('./i18n.js')('en');\r\nconst Options=require('./options.js');\r\nconst generateCode=require('./code.js');\r\nconst CodeOutput=require('./code-output');\r\nconst OptionsOutput=require('./options-output');\r\n\r\n$(function(){\r\n\t$('.webaudio-starter').each(function(){\r\n\t\tconst $container=$(this);\r\n\t\tconst options=new Options();\r\n\t\tconst codeOutput=new CodeOutput(()=>generateCode(options.fix(),i18n));\r\n\t\toptions.updateCallback=codeOutput.update;\r\n\t\tconst optionsOutput=new OptionsOutput(options,generateId,i18n);\r\n\t\t$container.empty()\r\n\t\t\t.append(optionsOutput.$output)\r\n\t\t\t.append(codeOutput.$output);\r\n\t})\r\n});\r\n","'use strict';\r\n\r\nconst Option=Object.create(require('crnx-base/option-classes'));\r\n\r\n// differs from webgl-starter:\r\n//\thas defaultValue - although it's potentially confusing: user input default vs Web Audio Node property default - they are currently the same\r\n//\tno setToDefault, which is needed only if speed is present\r\n//\tname is set, b/c it wasn't needed only for speed\r\nclass FixedLiveNumber {\r\n\tconstructor(src) {\r\n\t\tthis.value=src.value;\r\n\t\tthis.min=src.min;\r\n\t\tthis.max=src.max;\r\n\t\tthis.input=src.input;\r\n\t\tthis.defaultValue=src.defaultValue;\r\n\t\tthis.availableMin=src.availableMin;\r\n\t\tthis.availableMax=src.availableMax;\r\n\t\tthis.step=src.step;\r\n\t\tthis.name=src.name;\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this.value;\r\n\t}\r\n\ttoString() {\r\n\t\treturn String(this.value);\r\n\t}\r\n}\r\n\r\n// differs from webgl-starter:\r\n//\tinput is a boolean\r\n// \tfloat subclasses have a fixed step of 0.01\r\n//\tno speed\r\n//\thas range specified as [availableMin,availableMax,defaultMin,defaultMax]\r\nOption.LiveNumber = class extends Option.RangeInput {\r\n\tconstructor(name,availableRange,defaultValue,data,fullName,isVisible,updateCallback) {\r\n\t\tlet dataValue,dataMin,dataMax,dataInput;\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value;\r\n\t\t\tdataMin  =data.min;\r\n\t\t\tdataMax  =data.max;\r\n\t\t\tdataInput=data.input;\r\n\t\t} else {\r\n\t\t\tdataValue=data;\r\n\t\t}\r\n\t\tsuper(name,availableRange,defaultValue,dataValue,fullName,isVisible,updateCallback);\r\n\t\tthis.defaultMin=(availableRange[2]!==undefined?availableRange[2]:this.availableMin);\r\n\t\tthis.defaultMax=(availableRange[3]!==undefined?availableRange[3]:this.availableMax);\r\n\t\tthis._min=(dataMin!==undefined)?dataMin:this.defaultMin;\r\n\t\tthis._max=(dataMax!==undefined)?dataMax:this.defaultMax;\r\n\t\tthis._input=!!dataInput;\r\n\t\tthis._$range=null;\r\n\t}\r\n\tupdateInternalVisibility() {\r\n\t\tif (this._$range) this._$range.toggle(this._input);\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input;\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input;\r\n\t\tthis.updateInternalVisibility();\r\n\t\tthis.updateCallback();\r\n\t}\r\n\tget min() {\r\n\t\treturn this._min;\r\n\t}\r\n\tset min(min) {\r\n\t\tthis._min=min;\r\n\t\tthis.updateCallback();\r\n\t}\r\n\tget max() {\r\n\t\treturn this._max;\r\n\t}\r\n\tset max(max) {\r\n\t\tthis._max=max;\r\n\t\tthis.updateCallback();\r\n\t}\r\n\tget $range() {\r\n\t\treturn this._$range;\r\n\t}\r\n\tset $range($range) {\r\n\t\tthis._$range=$range;\r\n\t\tthis.updateInternalVisibility();\r\n\t}\r\n\texportHelper(src) {\r\n\t\tconst data={};\r\n\t\tif (src.value!=src.defaultValue) data.value=src.value;\r\n\t\tif (src.min!=src.availableMin) data.min=src.min;\r\n\t\tif (src.max!=src.availableMax) data.max=src.max;\r\n\t\tif (src.input) data.input=src.input;\r\n\t\treturn data;\r\n\t}\r\n\texport() {\r\n\t\treturn this.exportHelper(this);\r\n\t}\r\n\tfix() {\r\n\t\treturn new FixedLiveNumber(this);\r\n\t}\r\n};\r\n\r\nOption.LiveInt = class extends Option.LiveNumber {\r\n\tget step() {\r\n\t\treturn 1;\r\n\t}\r\n};\r\n\r\nOption.LiveFloat = class extends Option.LiveNumber {\r\n\tget step() {\r\n\t\treturn 0.01;\r\n\t}\r\n};\r\n\r\nclass FixedLiveSelect {\r\n\tconstructor(src) {\r\n\t\tthis.value=src.value;\r\n\t\tthis.input=src.input;\r\n\t\tthis.defaultValue=src.defaultValue;\r\n\t\tthis.availableValues=src.availableValues;\r\n\t\tthis.name=src.name;\r\n\t}\r\n\tvalueOf() {\r\n\t\treturn this.value;\r\n\t}\r\n\ttoString() {\r\n\t\treturn this.value;\r\n\t}\r\n}\r\n\r\nOption.LiveSelect = class extends Option.Select {\r\n\tconstructor(name,availableValues,defaultValue,data,fullName,isVisible,updateCallback) {\r\n\t\tlet dataValue,dataInput;\r\n\t\tif (typeof data == 'object') {\r\n\t\t\tdataValue=data.value;\r\n\t\t\tdataInput=data.input;\r\n\t\t} else {\r\n\t\t\tdataValue=data;\r\n\t\t}\r\n\t\tsuper(name,availableValues,defaultValue,dataValue,fullName,isVisible,updateCallback);\r\n\t\tthis._input=!!dataInput;\r\n\t}\r\n\tget input() {\r\n\t\treturn this._input;\r\n\t}\r\n\tset input(input) {\r\n\t\tthis._input=input;\r\n\t\tthis.updateCallback();\r\n\t}\r\n\texport() {\r\n\t\tconst data={};\r\n\t\tif (this.value!=this.defaultValue) data.value=this.value;\r\n\t\tif (this.input) data.input=this.input;\r\n\t\treturn data;\r\n\t}\r\n\tfix() {\r\n\t\treturn new FixedLiveSelect(this);\r\n\t}\r\n};\r\n\r\nmodule.exports=Option;\r\n","'use strict';\r\n\r\nconst Option=require('./option-classes.js');\r\nconst BaseOptionsOutput=require('crnx-base/options-output');\r\n\r\nclass OptionsOutput extends BaseOptionsOutput {\r\n\tsetOptionClassWriters(optionClassWriters) {\r\n\t\tsuper.setOptionClassWriters(optionClassWriters);\r\n\t\toptionClassWriters.set(Option.LiveNumber,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst setInputAttrs=$input=>$input\r\n\t\t\t\t.attr('min',option.availableMin)\r\n\t\t\t\t.attr('max',option.availableMax)\r\n\t\t\t\t.attr('step',option.step);\r\n\t\t\tconst setInputAttrsAndListeners=($input,getOtherInput)=>setInputAttrs($input)\r\n\t\t\t\t.val(option.value)\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\tconst $that=getOtherInput();\r\n\t\t\t\t\t\t$that.val(this.value);\r\n\t\t\t\t\t\toption.value=parseFloat(this.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\tconst writeMinMaxInput=minOrMax=>setInputAttrs($(\"<input type='number' required>\"))\r\n\t\t\t\t.val(option[minOrMax])\r\n\t\t\t\t.on('input change',function(){\r\n\t\t\t\t\tif (this.checkValidity()) {\r\n\t\t\t\t\t\toption[minOrMax]=parseFloat(this.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\tconst id=generateId();\r\n\t\t\tconst inputCheckboxId=generateId();\r\n\t\t\tlet $sliderInput,$numberInput,$inputCheckbox;\r\n\t\t\tlet $rangeMinInput,$rangeMaxInput;\r\n\t\t\treturn option.$=$(\"<div class='option'>\")\r\n\t\t\t\t.append(\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\")\r\n\t\t\t\t.append(\" <span class='min'>\"+option.availableMin+\"</span> \")\r\n\t\t\t\t.append($sliderInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='range' id='\"+id+\"'>\"),\r\n\t\t\t\t\t()=>$numberInput\r\n\t\t\t\t))\r\n\t\t\t\t.append(\" <span class='max'>\"+option.availableMax+\"</span> \")\r\n\t\t\t\t.append($numberInput=setInputAttrsAndListeners(\r\n\t\t\t\t\t$(\"<input type='number' required>\"),\r\n\t\t\t\t\t()=>$sliderInput\r\n\t\t\t\t))\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$inputCheckbox=$(\"<input type='checkbox' id='\"+inputCheckboxId+\"'>\")\r\n\t\t\t\t\t\t.prop('checked',option.input)\r\n\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\toption.input=$(this).prop('checked');\r\n\t\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t\t.append(\" <label for='\"+inputCheckboxId+\"'>\"+i18n('options-output.input')+\"</label> \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\toption.$range=$(\"<span class='range'>\")\r\n\t\t\t\t\t\t.append(i18n('options-output.range')+\" \")\r\n\t\t\t\t\t\t.append($rangeMinInput=writeMinMaxInput('min'))\r\n\t\t\t\t\t\t.append(\" .. \")\r\n\t\t\t\t\t\t.append($rangeMaxInput=writeMinMaxInput('max'))\r\n\t\t\t\t)\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t\t$sliderInput.val(option.defaultValue).change();\r\n\t\t\t\t\t\t$inputCheckbox.prop('checked',false).change();\r\n\t\t\t\t\t\t$rangeMinInput.val(option.defaultMin).change();\r\n\t\t\t\t\t\t$rangeMaxInput.val(option.defaultMax).change();\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t});\r\n\t\toptionClassWriters.set(Option.LiveSelect,(option,writeOption,i18n,generateId)=>{\r\n\t\t\tconst id=generateId();\r\n\t\t\tconst inputCheckboxId=generateId();\r\n\t\t\tlet $select,$inputCheckbox;\r\n\t\t\treturn option.$=$(\"<div class='option'>\")\r\n\t\t\t\t.append(\"<label for='\"+id+\"'>\"+i18n('options.'+option.fullName)+\":</label>\")\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$select=$(\"<select id='\"+id+\"'>\").append(\r\n\t\t\t\t\t\toption.availableValues.map(function(availableValue){\r\n\t\t\t\t\t\t\treturn $(\"<option>\").val(availableValue).html(i18n('options.'+option.fullName+'.'+availableValue))\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t).val(option.value).change(function(){\r\n\t\t\t\t\t\toption.value=this.value;\r\n\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t\t.append(\" \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$inputCheckbox=$(\"<input type='checkbox' id='\"+inputCheckboxId+\"'>\")\r\n\t\t\t\t\t\t.prop('checked',option.input)\r\n\t\t\t\t\t\t.change(function(){\r\n\t\t\t\t\t\t\toption.input=$(this).prop('checked');\r\n\t\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t\t.append(\" <label for='\"+inputCheckboxId+\"'>\"+i18n('options-output.input')+\"</label> \")\r\n\t\t\t\t.append(\r\n\t\t\t\t\t$(\"<button type='button'>\"+i18n('options-output.reset')+\"</button>\").click(function(){\r\n\t\t\t\t\t\t$select.val(option.defaultValue).change();\r\n\t\t\t\t\t\t$inputCheckbox.prop('checked',false).change();\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports=OptionsOutput;\r\n","'use strict';\r\n\r\nconst BaseOptions=require('crnx-base/options');\r\n\r\nclass Options extends BaseOptions {\r\n\tget entriesDescription() {\r\n\t\treturn [\r\n\t\t\t['Array','sources',[ // urls are from w3c mooc\r\n\t\t\t\t['Group','audio',[\r\n\t\t\t\t\t['Text','url',[\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/guitarRiff1.mp3',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/drums.mp3',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/LaSueur.mp3',\r\n\t\t\t\t\t]],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','video',[\r\n\t\t\t\t\t['Text','url',[\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.webm',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/elephants-dream-medium.mp4',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/sintel.webm',\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/sintel.mp4',\r\n\t\t\t\t\t]],\r\n\t\t\t\t\t['Int','width',[1,1920],320],\r\n\t\t\t\t\t['Int','height',[1,1080],240],\r\n\t\t\t\t]],\r\n\t\t\t],'source'],\r\n\t\t\t['Array','filters',[\r\n\t\t\t\t['Group','gain',[\r\n\t\t\t\t\t['LiveFloat','gain',[0,10,0,1],1],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','panner',[\r\n\t\t\t\t\t['LiveFloat','pan',[-1,1],0],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','biquad',[\r\n\t\t\t\t\t['LiveSelect','type',[\r\n\t\t\t\t\t\t'lowpass','highpass','bandpass','lowshelf','highshelf','peaking','notch','allpass'\r\n\t\t\t\t\t]],\r\n\t\t\t\t\t['LiveInt','frequency',[0,22050],350],\r\n\t\t\t\t\t['LiveFloat','Q',[-4,4],0], // log Q\r\n\t\t\t\t\t['LiveInt','gain',[-30,30],0],\r\n\t\t\t\t\t['LiveInt','detune',[0,100]],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','convolver',[\r\n\t\t\t\t\t['LiveFloat','reverb',[0,1]],\r\n\t\t\t\t\t['Text','url',[\r\n\t\t\t\t\t\t'http://mainline.i3s.unice.fr/mooc/Scala-Milan-Opera-Hall.wav',\r\n\t\t\t\t\t]],\r\n\t\t\t\t]],\r\n\t\t\t\t['Group','equalizer',[60,170,350,1000,3500,10000].map(freq=>['LiveInt','gain'+freq,[-30,30],0])],\r\n\t\t\t],'filter'],\r\n\t\t\t['Group','destination',[\r\n\t\t\t\t['Checkbox','compressor'], // Firefox compresses automatically?\r\n\t\t\t\t['Checkbox','waveform'],\r\n\t\t\t]],\r\n\t\t];\r\n\t}\r\n\tget optionClasses() {\r\n\t\treturn require('./option-classes.js');\r\n\t}\r\n}\r\n\r\nmodule.exports=Options;\r\n","'use strict';\r\n\r\nconst Lines=require('./html-lines.js');\r\nconst UnescapedLines=require('crnx-base/lines');\r\nconst CollectionFeature=require('./collection-feature.js');\r\n\r\nfunction capitalize(s) {\r\n\treturn s.charAt(0).toUpperCase()+s.slice(1);\r\n}\r\nfunction toCamelCase(s) {\r\n\treturn s.split('.').map((w,i)=>i>0?capitalize(w):w).join('');\r\n}\r\n\r\nclass Source {\r\n\tconstructor(options,n) {\r\n\t\tthis.options=options;\r\n\t\tthis.n=n;\r\n\t}\r\n\tget nSuffix() {\r\n\t\tif (this.n!==undefined) {\r\n\t\t\treturn '.'+this.n;\r\n\t\t} else {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\tget elementHtmlName() {\r\n\t\treturn 'my.'+this.type+this.nSuffix;\r\n\t}\r\n\tget nodeJsName() {\r\n\t\treturn toCamelCase(this.type+this.nSuffix+'.node');\r\n\t}\r\n\tgetHtmlLines(featureContext,i18n) {\r\n\t\treturn this.getElementHtmlLines(featureContext,i18n).wrap(\"<div>\",\"</div>\");\r\n\t}\r\n\tgetJsInitLines(i18n) {\r\n\t\treturn new Lines(\r\n\t\t\tnew UnescapedLines(\"// \"+i18n('comment.sources.'+this.type)),\r\n\t\t\t\"var \"+this.nodeJsName+\"=ctx.createMediaElementSource(document.getElementById('\"+this.elementHtmlName+\"'));\"\r\n\t\t);\r\n\t}\r\n\t// abstract:\r\n\t// get type()\r\n\t// getElementHtmlLines(featureContext,i18n) // TODO html escape\r\n}\r\n\r\nconst sourceClasses={\r\n\taudio: class extends Source {\r\n\t\tget type() { return 'audio'; }\r\n\t\tgetElementHtmlLines(featureContext,i18n) {\r\n\t\t\treturn new Lines(\r\n\t\t\t\t\"<audio src='\"+this.options.url+\"' id='\"+this.elementHtmlName+\"' controls loop\"+(featureContext.audioContext?\" crossorigin='anonymous'\":\"\")+\"></audio>\"\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\tvideo: class extends Source {\r\n\t\tget type() { return 'video'; }\r\n\t\tgetElementHtmlLines(featureContext,i18n) {\r\n\t\t\treturn new Lines(\r\n\t\t\t\t\"<video src='\"+this.options.url+\"' id='\"+this.elementHtmlName+\"' width='\"+this.options.width+\"' height='\"+this.options.height+\"' controls loop\"+(featureContext.audioContext?\" crossorigin='anonymous'\":\"\")+\"></video>\"\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n};\r\n\r\nclass SourceSet extends CollectionFeature {\r\n\tgetEntryClass(entryOption) {\r\n\t\treturn sourceClasses[entryOption.source];\r\n\t}\r\n\trequestFeatureContext(featureContext) {\r\n\t\tif (this.entries.length>0) {\r\n\t\t\tfeatureContext.audioProcessing=true;\r\n\t\t}\r\n\t}\r\n\tgetJsInitLines(featureContext,i18n,prevNodeJsNames) {\r\n\t\tconst lines=super.getJsInitLines(...arguments);\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\tlines.interleave(...this.entries.map(entry=>entry.getJsInitLines(i18n)));\r\n\t\t}\r\n\t\treturn lines;\r\n\t}\r\n\tgetNodeJsNames(featureContext,prevNodeJsNames) {\r\n\t\tif (featureContext.audioContext) {\r\n\t\t\treturn this.entries.map(entry=>entry.nodeJsName);\r\n\t\t} else {\r\n\t\t\treturn prevNodeJsNames;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports=SourceSet;\r\n"],"sourceRoot":"."}